<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "bcefbd5d0107691ef3e6e33ba694d6f4",
  "translation_date": "2025-11-21T10:43:18+00:00",
  "source_file": "docs/pre-deployment/coordination-patterns.md",
  "language_code": "el"
}
-->
# Πρότυπα Συντονισμού Πολλαπλών Πρακτόρων

⏱️ **Εκτιμώμενος Χρόνος**: 60-75 λεπτά | 💰 **Εκτιμώμενο Κόστος**: ~$100-300/μήνα | ⭐ **Πολυπλοκότητα**: Προχωρημένο

**📚 Διαδρομή Μάθησης:**
- ← Προηγούμενο: [Σχεδιασμός Ικανότητας](capacity-planning.md) - Στρατηγικές μεγέθους και κλιμάκωσης πόρων
- 🎯 **Είστε Εδώ**: Πρότυπα Συντονισμού Πολλαπλών Πρακτόρων (Ορχήστρωση, επικοινωνία, διαχείριση κατάστασης)
- → Επόμενο: [Επιλογή SKU](sku-selection.md) - Επιλογή των κατάλληλων υπηρεσιών Azure
- 🏠 [Αρχική Σελίδα Μαθήματος](../../README.md)

---

## Τι Θα Μάθετε

Με την ολοκλήρωση αυτού του μαθήματος, θα:
- Κατανοήσετε τα πρότυπα αρχιτεκτονικής **πολλαπλών πρακτόρων** και πότε να τα χρησιμοποιείτε
- Υλοποιήσετε **πρότυπα ορχήστρωσης** (κεντρική, αποκεντρωμένη, ιεραρχική)
- Σχεδιάσετε στρατηγικές **επικοινωνίας πρακτόρων** (σύγχρονη, ασύγχρονη, βασισμένη σε γεγονότα)
- Διαχειριστείτε την **κοινή κατάσταση** μεταξύ διανεμημένων πρακτόρων
- Αναπτύξετε **συστήματα πολλαπλών πρακτόρων** στο Azure με AZD
- Εφαρμόσετε **πρότυπα συντονισμού** για σενάρια AI στον πραγματικό κόσμο
- Παρακολουθήσετε και αποσφαλματώσετε διανεμημένα συστήματα πρακτόρων

## Γιατί Είναι Σημαντικός ο Συντονισμός Πολλαπλών Πρακτόρων

### Η Εξέλιξη: Από Μοναδικό Πράκτορα σε Πολλαπλούς Πράκτορες

**Μοναδικός Πράκτορας (Απλός):**
```
User → Agent → Response
```
- ✅ Εύκολος στην κατανόηση και υλοποίηση
- ✅ Γρήγορος για απλές εργασίες
- ❌ Περιορισμένος από τις δυνατότητες ενός μοντέλου
- ❌ Δεν μπορεί να παραλληλίσει σύνθετες εργασίες
- ❌ Χωρίς εξειδίκευση

**Σύστημα Πολλαπλών Πρακτόρων (Προχωρημένο):**
```
           ┌─────────────┐
           │ Orchestrator│
           └──────┬──────┘
        ┌─────────┼─────────┐
        │         │         │
    ┌───▼──┐  ┌──▼───┐  ┌──▼────┐
    │Agent1│  │Agent2│  │Agent3 │
    │(Plan)│  │(Code)│  │(Review)│
    └──────┘  └──────┘  └───────┘
```
- ✅ Εξειδικευμένοι πράκτορες για συγκεκριμένες εργασίες
- ✅ Παράλληλη εκτέλεση για ταχύτητα
- ✅ Μοναδιαίο και συντηρήσιμο
- ✅ Καλύτερο σε σύνθετες ροές εργασίας
- ⚠️ Απαιτεί λογική συντονισμού

**Αναλογία**: Ο μοναδικός πράκτορας είναι σαν ένα άτομο που κάνει όλες τις εργασίες. Το σύστημα πολλαπλών πρακτόρων είναι σαν μια ομάδα όπου κάθε μέλος έχει εξειδικευμένες δεξιότητες (ερευνητής, προγραμματιστής, αναθεωρητής, συγγραφέας) και συνεργάζονται.

---

## Βασικά Πρότυπα Συντονισμού

### Πρότυπο 1: Διαδοχικός Συντονισμός (Αλυσίδα Ευθύνης)

**Πότε να το χρησιμοποιήσετε**: Οι εργασίες πρέπει να ολοκληρωθούν με συγκεκριμένη σειρά, κάθε πράκτορας βασίζεται στην έξοδο του προηγούμενου.

```mermaid
sequenceDiagram
    participant User
    participant Orchestrator
    participant Agent1 as Ερευνητικός Πράκτορας
    participant Agent2 as Πράκτορας Συγγραφέας
    participant Agent3 as Πράκτορας Συντάκτης
    
    User->>Orchestrator: "Γράψε άρθρο για την Τεχνητή Νοημοσύνη"
    Orchestrator->>Agent1: Έρευνα θέματος
    Agent1-->>Orchestrator: Αποτελέσματα έρευνας
    Orchestrator->>Agent2: Γράψε προσχέδιο (χρησιμοποιώντας την έρευνα)
    Agent2-->>Orchestrator: Προσχέδιο άρθρου
    Orchestrator->>Agent3: Επεξεργασία και βελτίωση
    Agent3-->>Orchestrator: Τελικό άρθρο
    Orchestrator-->>User: Βελτιωμένο άρθρο
    
    Note over User,Agent3: Διαδοχικό: Κάθε βήμα περιμένει το προηγούμενο
```
**Οφέλη:**
- ✅ Σαφής ροή δεδομένων
- ✅ Εύκολο στην αποσφαλμάτωση
- ✅ Προβλέψιμη σειρά εκτέλεσης

**Περιορισμοί:**
- ❌ Πιο αργό (χωρίς παραλληλισμό)
- ❌ Μια αποτυχία μπλοκάρει ολόκληρη την αλυσίδα
- ❌ Δεν μπορεί να χειριστεί αλληλεξαρτώμενες εργασίες

**Παραδείγματα Χρήσης:**
- Ροή δημιουργίας περιεχομένου (έρευνα → συγγραφή → επεξεργασία → δημοσίευση)
- Δημιουργία κώδικα (σχεδιασμός → υλοποίηση → δοκιμή → ανάπτυξη)
- Δημιουργία αναφορών (συλλογή δεδομένων → ανάλυση → οπτικοποίηση → σύνοψη)

---

### Πρότυπο 2: Παράλληλος Συντονισμός (Fan-Out/Fan-In)

**Πότε να το χρησιμοποιήσετε**: Ανεξάρτητες εργασίες μπορούν να εκτελεστούν ταυτόχρονα, τα αποτελέσματα συνδυάζονται στο τέλος.

```mermaid
graph TB
    User[Αίτημα Χρήστη]
    Orchestrator[Ορχηστρωτής]
    Agent1[Πράκτορας Ανάλυσης]
    Agent2[Πράκτορας Έρευνας]
    Agent3[Πράκτορας Δεδομένων]
    Aggregator[Συγκεντρωτής Αποτελεσμάτων]
    Response[Συνδυασμένη Απόκριση]
    
    User --> Orchestrator
    Orchestrator --> Agent1
    Orchestrator --> Agent2
    Orchestrator --> Agent3
    Agent1 --> Aggregator
    Agent2 --> Aggregator
    Agent3 --> Aggregator
    Aggregator --> Response
    
    style Orchestrator fill:#2196F3,stroke:#1976D2,stroke-width:3px,color:#fff
    style Aggregator fill:#4CAF50,stroke:#388E3C,stroke-width:3px,color:#fff
```
**Οφέλη:**
- ✅ Γρήγορο (παράλληλη εκτέλεση)
- ✅ Ανθεκτικό σε σφάλματα (αποδεκτά μερικά αποτελέσματα)
- ✅ Κλιμακώνεται οριζόντια

**Περιορισμοί:**
- ⚠️ Τα αποτελέσματα μπορεί να φτάσουν εκτός σειράς
- ⚠️ Απαιτείται λογική συγκέντρωσης
- ⚠️ Πολύπλοκη διαχείριση κατάστασης

**Παραδείγματα Χρήσης:**
- Συλλογή δεδομένων από πολλές πηγές (APIs + βάσεις δεδομένων + web scraping)
- Ανταγωνιστική ανάλυση (πολλαπλά μοντέλα δημιουργούν λύσεις, επιλέγεται η καλύτερη)
- Υπηρεσίες μετάφρασης (μετάφραση σε πολλές γλώσσες ταυτόχρονα)

---

### Πρότυπο 3: Ιεραρχικός Συντονισμός (Διαχειριστής-Εργαζόμενος)

**Πότε να το χρησιμοποιήσετε**: Σύνθετες ροές εργασίας με υπο-εργασίες, απαιτείται ανάθεση.

```mermaid
graph TB
    Master[Κύριος Ορχηστρωτής]
    Manager1[Διευθυντής Έρευνας]
    Manager2[Διευθυντής Περιεχομένου]
    W1[Εργαλείο Συλλογής Δεδομένων Ιστού]
    W2[Αναλυτής Εγγράφων]
    W3[Συγγραφέας]
    W4[Επιμελητής]
    
    Master --> Manager1
    Master --> Manager2
    Manager1 --> W1
    Manager1 --> W2
    Manager2 --> W3
    Manager2 --> W4
    
    style Master fill:#FF9800,stroke:#F57C00,stroke-width:3px,color:#fff
    style Manager1 fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:#fff
    style Manager2 fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:#fff
```
**Οφέλη:**
- ✅ Χειρίζεται σύνθετες ροές εργασίας
- ✅ Μοναδιαίο και συντηρήσιμο
- ✅ Σαφή όρια ευθύνης

**Περιορισμοί:**
- ⚠️ Πιο πολύπλοκη αρχιτεκτονική
- ⚠️ Υψηλότερη καθυστέρηση (πολλαπλά επίπεδα συντονισμού)
- ⚠️ Απαιτεί εξελιγμένη ορχήστρωση

**Παραδείγματα Χρήσης:**
- Επεξεργασία εγγράφων σε επιχειρήσεις (ταξινόμηση → δρομολόγηση → επεξεργασία → αρχειοθέτηση)
- Πολυσταδιακές ροές δεδομένων (εισαγωγή → καθαρισμός → μετασχηματισμός → ανάλυση → αναφορά)
- Σύνθετες αυτοματοποιημένες ροές εργασίας (σχεδιασμός → κατανομή πόρων → εκτέλεση → παρακολούθηση)

---

### Πρότυπο 4: Συντονισμός Βασισμένος σε Γεγονότα (Δημοσίευση-Συνδρομή)

**Πότε να το χρησιμοποιήσετε**: Οι πράκτορες πρέπει να αντιδρούν σε γεγονότα, επιθυμητή η χαλαρή σύζευξη.

```mermaid
sequenceDiagram
    participant Agent1 as Συλλέκτης Δεδομένων
    participant EventBus as Azure Service Bus
    participant Agent2 as Αναλυτής
    participant Agent3 as Ειδοποιητής
    participant Agent4 as Αρχειοθέτης
    
    Agent1->>EventBus: Δημοσίευση συμβάντος "ΛήψηΔεδομένων"
    EventBus->>Agent2: Εγγραφή: Ανάλυση δεδομένων
    EventBus->>Agent3: Εγγραφή: Αποστολή ειδοποίησης
    EventBus->>Agent4: Εγγραφή: Αρχειοθέτηση δεδομένων
    
    Note over Agent1,Agent4: Όλοι οι συνδρομητές επεξεργάζονται ανεξάρτητα
    
    Agent2->>EventBus: Δημοσίευση συμβάντος "ΟλοκλήρωσηΑνάλυσης"
    EventBus->>Agent3: Εγγραφή: Αποστολή αναφοράς ανάλυσης
```
**Οφέλη:**
- ✅ Χαλαρή σύζευξη μεταξύ πρακτόρων
- ✅ Εύκολη προσθήκη νέων πρακτόρων (απλά εγγραφείτε)
- ✅ Ασύγχρονη επεξεργασία
- ✅ Ανθεκτικό (επιμονή μηνυμάτων)

**Περιορισμοί:**
- ⚠️ Τελικά συνεπές
- ⚠️ Πολύπλοκη αποσφαλμάτωση
- ⚠️ Προκλήσεις στην ακολουθία μηνυμάτων

**Παραδείγματα Χρήσης:**
- Συστήματα παρακολούθησης σε πραγματικό χρόνο (ειδοποιήσεις, πίνακες ελέγχου, καταγραφές)
- Ειδοποιήσεις πολλαπλών καναλιών (email, SMS, push, Slack)
- Ροές επεξεργασίας δεδομένων (πολλαπλοί καταναλωτές των ίδιων δεδομένων)

---

### Πρότυπο 5: Συντονισμός Βασισμένος σε Συναίνεση (Ψηφοφορία/Πλειοψηφία)

**Πότε να το χρησιμοποιήσετε**: Απαιτείται συμφωνία από πολλούς πράκτορες πριν προχωρήσετε.

```mermaid
graph TB
    Input[Εισαγωγή Εργασίας]
    Agent1[Πράκτορας 1: GPT-4]
    Agent2[Πράκτορας 2: Claude]
    Agent3[Πράκτορας 3: Gemini]
    Voter[Ψηφοφόρος Συναίνεσης]
    Output[Συμφωνημένο Αποτέλεσμα]
    
    Input --> Agent1
    Input --> Agent2
    Input --> Agent3
    Agent1 --> Voter
    Agent2 --> Voter
    Agent3 --> Voter
    Voter --> Output
    
    style Voter fill:#9C27B0,stroke:#7B1FA2,stroke-width:3px,color:#fff
```
**Οφέλη:**
- ✅ Υψηλότερη ακρίβεια (πολλαπλές απόψεις)
- ✅ Ανθεκτικό σε σφάλματα (αποδεκτές αποτυχίες μειοψηφίας)
- ✅ Ενσωματωμένη διασφάλιση ποιότητας

**Περιορισμοί:**
- ❌ Ακριβό (πολλαπλές κλήσεις μοντέλων)
- ❌ Πιο αργό (αναμονή για όλους τους πράκτορες)
- ⚠️ Απαιτείται επίλυση συγκρούσεων

**Παραδείγματα Χρήσης:**
- Εποπτεία περιεχομένου (πολλαπλά μοντέλα εξετάζουν περιεχόμενο)
- Αναθεώρηση κώδικα (πολλαπλοί αναλυτές/ελεγκτές)
- Ιατρική διάγνωση (πολλαπλά μοντέλα AI, επικύρωση από ειδικούς)

---

## Επισκόπηση Αρχιτεκτονικής

### Πλήρες Σύστημα Πολλαπλών Πρακτόρων στο Azure

```mermaid
graph TB
    User[Χρήστης/Πελάτης API]
    APIM[Διαχείριση API Azure]
    Orchestrator[Υπηρεσία Ορχηστρωτή<br/>Εφαρμογή Container]
    ServiceBus[Service Bus Azure<br/>Event Hub]
    
    Agent1[Πράκτορας Έρευνας<br/>Εφαρμογή Container]
    Agent2[Πράκτορας Συγγραφής<br/>Εφαρμογή Container]
    Agent3[Πράκτορας Αναλυτής<br/>Εφαρμογή Container]
    Agent4[Πράκτορας Αξιολογητής<br/>Εφαρμογή Container]
    
    CosmosDB[(Cosmos DB<br/>Κοινή Κατάσταση)]
    Storage[Αποθήκευση Azure<br/>Αρχεία]
    AppInsights[Application Insights<br/>Παρακολούθηση]
    
    User --> APIM
    APIM --> Orchestrator
    
    Orchestrator --> ServiceBus
    ServiceBus --> Agent1
    ServiceBus --> Agent2
    ServiceBus --> Agent3
    ServiceBus --> Agent4
    
    Agent1 --> CosmosDB
    Agent2 --> CosmosDB
    Agent3 --> CosmosDB
    Agent4 --> CosmosDB
    
    Agent1 --> Storage
    Agent2 --> Storage
    Agent3 --> Storage
    Agent4 --> Storage
    
    Orchestrator -.-> AppInsights
    Agent1 -.-> AppInsights
    Agent2 -.-> AppInsights
    Agent3 -.-> AppInsights
    Agent4 -.-> AppInsights
    
    style Orchestrator fill:#FF9800,stroke:#F57C00,stroke-width:3px,color:#fff
    style ServiceBus fill:#9C27B0,stroke:#7B1FA2,stroke-width:3px,color:#fff
    style CosmosDB fill:#4CAF50,stroke:#388E3C,stroke-width:3px,color:#fff
```
**Κύρια Συστατικά:**

| Συστατικό | Σκοπός | Υπηρεσία Azure |
|-----------|---------|---------------|
| **API Gateway** | Σημείο εισόδου, περιορισμός ρυθμού, έλεγχος ταυτότητας | API Management |
| **Ορχηστρωτής** | Συντονίζει τις ροές εργασίας πρακτόρων | Container Apps |
| **Ουρά Μηνυμάτων** | Ασύγχρονη επικοινωνία | Service Bus / Event Hubs |
| **Πράκτορες** | Εξειδικευμένοι AI εργαζόμενοι | Container Apps / Functions |
| **Αποθήκη Κατάστασης** | Κοινή κατάσταση, παρακολούθηση εργασιών | Cosmos DB |
| **Αποθήκευση Αρχείων** | Έγγραφα, αποτελέσματα, καταγραφές | Blob Storage |
| **Παρακολούθηση** | Διανεμημένη ιχνηλάτηση, καταγραφές | Application Insights |

---
## Οδηγός Αντιμετώπισης Προβλημάτων

### Πρόβλημα: Μηνύματα κολλημένα στην ουρά

**Συμπτώματα:**
- Τα μηνύματα συσσωρεύονται στην ουρά
- Οι πράκτορες δεν επεξεργάζονται
- Η κατάσταση της εργασίας παραμένει "εκκρεμής"

**Διάγνωση:**
```bash
# Ελέγξτε το βάθος της ουράς
az servicebus queue show \
  --namespace-name mybus \
  --name research-tasks \
  --query "countDetails"

# Ελέγξτε την κατάσταση του πράκτορα
azd logs research-agent --tail 50
```

**Λύσεις:**

1. **Αύξηση των αντιγράφων πρακτόρων:**
   ```bash
   az containerapp update \
     --name research-agent \
     --min-replicas 3 \
     --max-replicas 10
   ```

2. **Έλεγχος της ουράς dead letter:**
   ```bash
   az servicebus queue show \
     --namespace-name mybus \
     --name research-tasks \
     --query "countDetails.deadLetterMessageCount"
   ```

---

### Πρόβλημα: Χρονικό όριο εργασίας/δεν ολοκληρώνεται ποτέ

**Συμπτώματα:**
- Η κατάσταση της εργασίας παραμένει "σε εξέλιξη"
- Κάποιοι πράκτορες ολοκληρώνουν, άλλοι όχι
- Δεν υπάρχουν μηνύματα σφάλματος

**Διάγνωση:**
```bash
# Ελέγξτε την κατάσταση της εργασίας
curl $ORCHESTRATOR_URL/task/$TASK_ID

# Ελέγξτε το Application Insights
# Εκτελέστε ερώτημα: traces | where customDimensions.task_id == "..."
```

**Λύσεις:**

1. **Εφαρμογή χρονικού ορίου στον aggregator (Άσκηση 1)**

2. **Έλεγχος για αποτυχίες πρακτόρων:**
   ```bash
   azd logs --follow | grep "ERROR\|FAIL"
   ```

3. **Επιβεβαίωση ότι όλοι οι πράκτορες λειτουργούν:**
   ```bash
   az containerapp list \
     --resource-group rg-agents \
     --query "[].{name:name, status:properties.runningStatus}"
   ```

---

## Μάθετε Περισσότερα

### Επίσημη Τεκμηρίωση
- [Azure Service Bus](https://learn.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview)
- [Cosmos DB](https://learn.microsoft.com/azure/cosmos-db/introduction)
- [Container Apps DAPR](https://learn.microsoft.com/azure/container-apps/dapr-overview)
- [Multi-Agent Design Patterns](https://learn.microsoft.com/azure/architecture/guide/ai/multi-agent-systems)

### Επόμενα Βήματα σε Αυτό το Μάθημα
- ← Προηγούμενο: [Σχεδιασμός Χωρητικότητας](capacity-planning.md)
- → Επόμενο: [Επιλογή SKU](sku-selection.md)
- 🏠 [Αρχική Σελίδα Μαθήματος](../../README.md)

### Σχετικά Παραδείγματα
- [Παράδειγμα Microservices](../../../../examples/microservices) - Μοτίβα επικοινωνίας υπηρεσιών
- [Παράδειγμα Azure OpenAI](../../../../examples/azure-openai-chat) - Ενσωμάτωση AI

---

## Περίληψη

**Μάθατε:**
- ✅ Πέντε μοτίβα συντονισμού (διαδοχικό, παράλληλο, ιεραρχικό, βασισμένο σε γεγονότα, συναίνεση)
- ✅ Αρχιτεκτονική πολλαπλών πρακτόρων στο Azure (Service Bus, Cosmos DB, Container Apps)
- ✅ Διαχείριση κατάστασης σε κατανεμημένους πράκτορες
- ✅ Χειρισμός χρονικών ορίων, επαναλήψεων και κυκλωμάτων διακοπής
- ✅ Παρακολούθηση και αποσφαλμάτωση κατανεμημένων συστημάτων
- ✅ Στρατηγικές βελτιστοποίησης κόστους

**Βασικά Σημεία:**
1. **Επιλέξτε το σωστό μοτίβο** - Διαδοχικό για διατεταγμένες ροές εργασίας, παράλληλο για ταχύτητα, βασισμένο σε γεγονότα για ευελιξία
2. **Διαχειριστείτε την κατάσταση προσεκτικά** - Χρησιμοποιήστε Cosmos DB ή παρόμοιο για κοινή κατάσταση
3. **Χειριστείτε τις αποτυχίες με χάρη** - Χρονικά όρια, επαναλήψεις, κυκλώματα διακοπής, ουρές dead letter
4. **Παρακολουθήστε τα πάντα** - Η κατανεμημένη ιχνηλάτηση είναι απαραίτητη για αποσφαλμάτωση
5. **Βελτιστοποιήστε το κόστος** - Κλιμάκωση στο μηδέν, χρήση serverless, εφαρμογή caching

**Επόμενα Βήματα:**
1. Ολοκληρώστε τις πρακτικές ασκήσεις
2. Δημιουργήστε ένα σύστημα πολλαπλών πρακτόρων για τη δική σας περίπτωση χρήσης
3. Μελετήστε [Επιλογή SKU](sku-selection.md) για βελτιστοποίηση απόδοσης και κόστους

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Αποποίηση ευθύνης**:  
Αυτό το έγγραφο έχει μεταφραστεί χρησιμοποιώντας την υπηρεσία αυτόματης μετάφρασης [Co-op Translator](https://github.com/Azure/co-op-translator). Παρόλο που καταβάλλουμε προσπάθειες για ακρίβεια, παρακαλούμε να έχετε υπόψη ότι οι αυτόματες μεταφράσεις ενδέχεται να περιέχουν λάθη ή ανακρίβειες. Το πρωτότυπο έγγραφο στη μητρική του γλώσσα θα πρέπει να θεωρείται η αυθεντική πηγή. Για κρίσιμες πληροφορίες, συνιστάται επαγγελματική ανθρώπινη μετάφραση. Δεν φέρουμε ευθύνη για τυχόν παρεξηγήσεις ή εσφαλμένες ερμηνείες που προκύπτουν από τη χρήση αυτής της μετάφρασης.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->