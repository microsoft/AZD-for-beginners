# –®–∞–±–ª–æ–Ω–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç

‚è±Ô∏è **–ü—Ä–æ—Ü–µ—ö–µ–Ω–æ –≤—Ä–µ–º–µ**: 45-60 –º–∏–Ω—É—Ç–∞ | üí∞ **–£—Ç–∏—Ü–∞—ò –Ω–∞ —Ç—Ä–æ—à–∫–æ–≤–µ**: –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–±–µ–∑ –¥–æ–¥–∞—Ç–Ω–∏—Ö —Ç—Ä–æ—à–∫–æ–≤–∞) | ‚≠ê **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ—Å—Ç**: –°—Ä–µ–¥—ö–∏ –Ω–∏–≤–æ

**üìö –ü—É—Ç —É—á–µ—ö–∞:**
- ‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: [–£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–æ–º](configuration.md) - –£–ø—Ä–∞–≤—ô–∞—ö–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–∞ –∏ —Ç–∞—ò–Ω–∞–º–∞
- üéØ **–û–≤–¥–µ —Å—Ç–µ**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –∏ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç (—É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç, Key Vault, —Å–∏–≥—É—Ä–Ω–∏ —à–∞–±–ª–æ–Ω–∏)
- ‚Üí –°–ª–µ–¥–µ—õ–µ: [–ü—Ä–≤–∏ –ø—Ä–æ—ò–µ–∫–∞—Ç](first-project.md) - –ù–∞–ø—Ä–∞–≤–∏—Ç–µ —Å–≤–æ—ò—É –ø—Ä–≤—É AZD –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É
- üè† [–ü–æ—á–µ—Ç–Ω–∞ —Å—Ç—Ä–∞–Ω–∞ –∫—É—Ä—Å–∞](../../README.md)

---

## –®—Ç–∞ —õ–µ—Ç–µ –Ω–∞—É—á–∏—Ç–∏

–ó–∞–≤—Ä—à–µ—Ç–∫–æ–º –æ–≤–µ –ª–µ–∫—Ü–∏—ò–µ, –Ω–∞—É—á–∏—õ–µ—Ç–µ:
- –†–∞–∑—É–º–µ–≤–∞—ö–µ Azure —à–∞–±–ª–æ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ (–∫—ô—É—á–µ–≤–∏, –∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏ –Ω–∏–∑–æ–≤–∏, —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç)
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò—É **—É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞** –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –±–µ–∑ –ª–æ–∑–∏–Ω–∫–∏
- –û–±–µ–∑–±–µ—í–∏–≤–∞—ö–µ —Ç–∞—ò–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–æ–º —Å–∞ **Azure Key Vault**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Å–∞—ö–µ **–∫–æ–Ω—Ç—Ä–æ–ª–µ –ø—Ä–∏—Å—Ç—É–ø–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω–µ –Ω–∞ —É–ª–æ–≥–∞–º–∞ (RBAC)** –∑–∞ AZD –¥–µ–ø–ª–æ—ò–µ
- –ü—Ä–∏–º–µ–Ω–∞ –Ω–∞—ò–±–æ—ô–∏—Ö –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏—Ö –ø—Ä–∞–∫—Å–∏ —É Container Apps –∏ Azure —Å–µ—Ä–≤–∏—Å–∏–º–∞
- –ú–∏–≥—Ä–∞—Ü–∏—ò–∞ —Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∑–∞—Å–Ω–æ–≤–∞–Ω–µ –Ω–∞ –∫—ô—É—á–µ–≤–∏–º–∞ –Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∑–∞—Å–Ω–æ–≤–∞–Ω—É –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç—É

## –ó–∞—à—Ç–æ —ò–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –≤–∞–∂–∞–Ω

### –ü—Ä–æ–±–ª–µ–º: –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–∞–ª–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞

**–ü—Ä–µ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞:**
```javascript
// ‚ùå –ë–ï–ó–ë–ï–î–ù–û–°–ù–ò –†–ò–ó–ò–ö: –•–∞—Ä–¥–∫–æ–¥–æ–≤–∞–Ω–µ —Ç–∞—ò–Ω–µ —É –∫–æ–¥—É
const connectionString = "Server=mydb.database.windows.net;User=admin;Password=P@ssw0rd123";
const storageKey = "xK7mN9pQ2wR5tY8uI0oP3aS6dF1gH4jK...";
const cosmosKey = "C2x7B9n4M1p8Q5w3E6r0T2y5U8i1O4p7...";
```

**–ü—Ä–æ–±–ª–µ–º–∏:**
- üî¥ **–ò–∑–ª–æ–∂–µ–Ω–µ —Ç–∞—ò–Ω–µ** —É –∫–æ–¥—É, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–∏–º —Ñ–∞—ò–ª–æ–≤–∏–º–∞, –ø—Ä–æ–º–µ–Ω—ô–∏–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–∞
- üî¥ **–†–æ—Ç–∞—Ü–∏—ò–∞ –∞–∫—Ä–µ–¥–∏—Ç–∏–≤–∞** –∑–∞—Ö—Ç–µ–≤–∞ –∏–∑–º–µ–Ω–µ –∫–æ–¥–∞ –∏ –ø–æ–Ω–æ–≤–Ω–æ –ø–æ—Å—Ç–∞–≤—ô–∞—ö–µ
- üî¥ **–ö–æ—à–º–∞—Ä —É —Ä–µ–≤–∏–∑–∏—ò–∏** - –∫–æ —ò–µ –ø—Ä–∏—Å—Ç—É–ø–∏–æ —á–µ–º—É –∏ –∫–∞–¥–∞?
- üî¥ **–†–∞—Å–∏–ø–∞—ö–µ** - —Ç–∞—ò–Ω–µ —Ä–∞–∑–±–∞—Ü–∞–Ω–µ –ø–æ –≤–∏—à–µ —Å–∏—Å—Ç–µ–º–∞
- üî¥ **–†–∏–∑–∏—Ü–∏ —É—Å–∫–ª–∞—í–µ–Ω–æ—Å—Ç–∏** - –Ω–µ –ø—Ä–æ–ª–∞–∑–∏ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ —Ä–µ–≤–∏–∑–∏—ò–µ

### –†–µ—à–µ—ö–µ: –£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç

**–ü–æ—Å–ª–µ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞:**
```javascript
// ‚úÖ –ë–ï–ó–ë–ï–î–ù–û: –ù–µ–º–∞ —Ç–∞—ò–Ω–∏ —É –∫–æ–¥—É
const credential = new DefaultAzureCredential();
const client = new BlobServiceClient(
  "https://mystorageaccount.blob.core.windows.net",
  credential  // Azure –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –æ–±—Ä–∞—í—É—ò–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É
);
```

**–ü—Ä–µ–¥–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–ë–µ–∑ —Ç–∞—ò–Ω–∏** —É –∫–æ–¥—É –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∏
- ‚úÖ **–ê—É—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–æ—Ç–∞—Ü–∏—ò–∞** - Azure —Ç–æ –æ–±–∞–≤—ô–∞
- ‚úÖ **–ü–æ—Ç–ø—É–Ω–∏ —Ç—Ä–∞–≥ —Ä–µ–≤–∏–∑–∏—ò–µ** —É Azure AD –ª–æ–≥–æ–≤–∏–º–∞
- ‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç** - —É–ø—Ä–∞–≤—ô–∞—ö–µ —É Azure –ø–æ—Ä—Ç–∞–ª—É
- ‚úÖ **–°–ø—Ä–µ–º–Ω–æ –∑–∞ —É—Å–∫–ª–∞—í–µ–Ω–æ—Å—Ç** - –∏—Å–ø—É—ö–∞–≤–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä–¥–µ

**–ê–Ω–∞–ª–æ–≥–∏—ò–∞**: –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–∞–ª–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ —ò–µ –∫–∞–æ –Ω–æ—à–µ—ö–µ –≤–∏—à–µ —Ñ–∏–∑–∏—á–∫–∏—Ö –∫—ô—É—á–µ–≤–∞ –∑–∞ —Ä–∞–∑–ª–∏—á–∏—Ç–∞ –≤—Ä–∞—Ç–∞. –£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —ò–µ –∫–∞–æ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∞ –ø—Ä–æ–ø—É—Å–Ω–∏—Ü–∞ –∫–æ—ò–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –æ–º–æ–≥—É—õ–∞–≤–∞ –ø—Ä–∏—Å—Ç—É–ø –Ω–∞ –æ—Å–Ω–æ–≤—É –≤–∞—à–µ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞‚Äî–±–µ–∑ –∫—ô—É—á–µ–≤–∞ –∫–æ—ò–µ –º–æ–∂–µ—Ç–µ –∏–∑–≥—É–±–∏—Ç–∏, –∫–æ–ø–∏—Ä–∞—Ç–∏ –∏–ª–∏ —Ä–æ—Ç–∏—Ä–∞—Ç–∏.

---

## –ü—Ä–µ–≥–ª–µ–¥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### –¢–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ —Å–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–∏–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º

```mermaid
sequenceDiagram
    participant App as –í–∞—à–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞<br/>(–ö–æ–Ω—Ç–µ—ò–Ω–µ—Ä –ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞)
    participant MI as –£–ø—Ä–∞–≤—ô–∞–Ω–∏ –ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç<br/>(Azure AD)
    participant KV as –¢—Ä–µ–∑–æ—Ä –ö—ô—É—á–µ–≤–∞
    participant Storage as Azure –°–∫–ª–∞–¥–∏—à—Ç–µ
    participant DB as Azure SQL
    
    App->>MI: –ó–∞—Ö—Ç–µ–≤ –∑–∞ –ø—Ä–∏—Å—Ç—É–ø–Ω–∏ —Ç–æ–∫–µ–Ω<br/>(–∞—É—Ç–æ–º–∞—Ç—Å–∫–∏)
    MI->>MI: –ü—Ä–æ–≤–µ—Ä–∞ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞<br/>(–±–µ–∑ –ø–æ—Ç—Ä–µ–±–µ –∑–∞ –ª–æ–∑–∏–Ω–∫–æ–º)
    MI-->>App: –ü–æ–≤—Ä–∞—Ç–∞–∫ —Ç–æ–∫–µ–Ω–∞<br/>(–≤–∞–∂–∏ 1 —Å–∞—Ç)
    
    App->>KV: –ü—Ä–µ—É–∑–∏–º–∞—ö–µ —Ç–∞—ò–Ω–µ<br/>(–∫–æ—Ä–∏—Å—Ç–µ—õ–∏ —Ç–æ–∫–µ–Ω)
    KV->>KV: –ü—Ä–æ–≤–µ—Ä–∞ RBAC –¥–æ–∑–≤–æ–ª–∞
    KV-->>App: –ü–æ–≤—Ä–∞—Ç–∞–∫ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Ç–∞—ò–Ω–µ
    
    App->>Storage: –û—Ç–ø—Ä–µ–º–∞—ö–µ –±–ª–æ–±–∞<br/>(–∫–æ—Ä–∏—Å—Ç–µ—õ–∏ —Ç–æ–∫–µ–Ω)
    Storage->>Storage: –ü—Ä–æ–≤–µ—Ä–∞ RBAC –¥–æ–∑–≤–æ–ª–∞
    Storage-->>App: –£—Å–ø–µ—Ö
    
    App->>DB: –£–ø–∏—Ç –∑–∞ –ø–æ–¥–∞—Ç–∫–µ<br/>(–∫–æ—Ä–∏—Å—Ç–µ—õ–∏ —Ç–æ–∫–µ–Ω)
    DB->>DB: –ü—Ä–æ–≤–µ—Ä–∞ SQL –¥–æ–∑–≤–æ–ª–∞
    DB-->>App: –ü–æ–≤—Ä–∞—Ç–∞–∫ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞
    
    Note over App,DB: –°–≤–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –±–µ–∑ –ª–æ–∑–∏–Ω–∫–µ!
```
### –¢–∏–ø–æ–≤–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏—Ö –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞

```mermaid
graph TB
    MI[–£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç]
    SystemAssigned[–ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç –¥–æ–¥–µ—ô–µ–Ω —Å–∏—Å—Ç–µ–º—É]
    UserAssigned[–ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç –¥–æ–¥–µ—ô–µ–Ω –∫–æ—Ä–∏—Å–Ω–∏–∫—É]
    
    MI --> SystemAssigned
    MI --> UserAssigned
    
    SystemAssigned --> SA1[–ñ–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å –≤–µ–∑–∞–Ω –∑–∞ —Ä–µ—Å—É—Ä—Å]
    SystemAssigned --> SA2[–ê—É—Ç–æ–º–∞—Ç—Å–∫–æ –∫—Ä–µ–∏—Ä–∞—ö–µ/–±—Ä–∏—Å–∞—ö–µ]
    SystemAssigned --> SA3[–ù–∞—ò–±–æ—ô–µ –∑–∞ —ò–µ–¥–∞–Ω —Ä–µ—Å—É—Ä—Å]
    
    UserAssigned --> UA1[–ù–µ–∑–∞–≤–∏—Å–∞–Ω –∂–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å]
    UserAssigned --> UA2[–†—É—á–Ω–æ –∫—Ä–µ–∏—Ä–∞—ö–µ/–±—Ä–∏—Å–∞—ö–µ]
    UserAssigned --> UA3[–î–µ—ô–µ–Ω–æ –∏–∑–º–µ—í—É —Ä–µ—Å—É—Ä—Å–∞]
    
    style SystemAssigned fill:#2196F3,stroke:#1976D2,stroke-width:2px,color:#fff
    style UserAssigned fill:#4CAF50,stroke:#388E3C,stroke-width:2px,color:#fff
```
| –ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°–∏—Å—Ç–µ–º—Å–∫–∏ –¥–æ–¥–µ—ô–µ–Ω | –ö–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω |
|----------------|-------------------|--------------------|
| **–ñ–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å** | –í–µ–∑–∞–Ω –∑–∞ —Ä–µ—Å—É—Ä—Å | –ù–µ–∑–∞–≤–∏—Å–∞–Ω |
| **–ö—Ä–µ–∏—Ä–∞—ö–µ** | –ê—É—Ç–æ–º–∞—Ç—Å–∫–∏ —Å–∞ —Ä–µ—Å—É—Ä—Å–æ–º | –†—É—á–Ω–æ –∫—Ä–µ–∏—Ä–∞—ö–µ |
| **–ë—Ä–∏—Å–∞—ö–µ** | –ë—Ä–∏—à–µ —Å–µ —Å–∞ —Ä–µ—Å—É—Ä—Å–æ–º | –û–ø—Å—Ç–∞—ò–µ –Ω–∞–∫–æ–Ω –±—Ä–∏—Å–∞—ö–∞ —Ä–µ—Å—É—Ä—Å–∞ |
| **–î–µ—ô–µ—ö–µ** | –°–∞–º–æ —ò–µ–¥–∞–Ω —Ä–µ—Å—É—Ä—Å | –í–∏—à–µ —Ä–µ—Å—É—Ä—Å–∞ |
| **–°–ª—É—á–∞—ò —É–ø–æ—Ç—Ä–µ–±–µ** | –à–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏ | –ö–æ–º–ø–ª–µ–∫—Å–Ω–∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏ —Å–∞ –≤–∏—à–µ —Ä–µ—Å—É—Ä—Å–∞ |
| **AZD –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–æ** | ‚úÖ –ü—Ä–µ–ø–æ—Ä—É—á–µ–Ω–æ | –û–ø—Ü–∏–æ–Ω–æ |

---

## –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏

### –ü–æ—Ç—Ä–µ–±–Ω–∏ –∞–ª–∞—Ç–∏

–¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ —Å—Ç–µ –∏—Ö –≤–µ—õ –∏–Ω—Å—Ç–∞–ª–∏—Ä–∞–ª–∏ –∏–∑ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏—Ö –ª–µ–∫—Ü–∏—ò–∞:

```bash
# –ü–æ—Ç–≤—Ä–¥–∏—Ç–µ Azure Developer CLI
azd version
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: azd –≤–µ—Ä–∑–∏—ò–∞ 1.0.0 –∏–ª–∏ –Ω–æ–≤–∏—ò–∞

# –ü–æ—Ç–≤—Ä–¥–∏—Ç–µ Azure CLI
az --version
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: azure-cli 2.50.0 –∏–ª–∏ –Ω–æ–≤–∏—ò–∞
```

### Azure –∑–∞—Ö—Ç–µ–≤–∏

- –ê–∫—Ç–∏–≤–Ω–∞ Azure –ø—Ä–µ—Ç–ø–ª–∞—Ç–∞
- –î–æ–∑–≤–æ–ª–µ –∑–∞:
  - –ö—Ä–µ–∏—Ä–∞—ö–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏—Ö –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞
  - –î–æ–¥–µ—ô–∏–≤–∞—ö–µ RBAC —É–ª–æ–≥–∞
  - –ö—Ä–µ–∏—Ä–∞—ö–µ Key Vault —Ä–µ—Å—É—Ä—Å–∞
  - –ü–æ—Å—Ç–∞–≤—ô–∞—ö–µ Container Apps

### –ü—Ä–µ–¥–∑–Ω–∞—ö–µ

–¢—Ä–µ–±–∞–ª–æ –±–∏ –¥–∞ —Å—Ç–µ –∑–∞–≤—Ä—à–∏–ª–∏:
- [–í–æ–¥–∏—á –∑–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—ò—É](installation.md) - AZD –ø–æ–¥–µ—à–∞–≤–∞—ö–µ
- [–û—Å–Ω–æ–≤–µ AZD](azd-basics.md) - –û—Å–Ω–æ–≤–Ω–∏ –∫–æ–Ω—Ü–µ–ø—Ç–∏
- [–£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–æ–º](configuration.md) - –ü—Ä–æ–º–µ–Ω—ô–∏–≤–µ –æ–∫—Ä—É–∂–µ—ö–∞

---

## –õ–µ–∫—Ü–∏—ò–∞ 1: –†–∞–∑—É–º–µ–≤–∞—ö–µ —à–∞–±–ª–æ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ

### –®–∞–±–ª–æ–Ω 1: –ö–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏ –Ω–∏–∑–æ–≤–∏ (–∑–∞—Å—Ç–∞—Ä–µ–ª–æ - –∏–∑–±–µ–≥–∞–≤–∞—Ç–∏)

**–ö–∞–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ:**
```bash
# –°—Ç—Ä–∏–Ω–≥ –∑–∞ –ø–æ–≤–µ–∑–∏–≤–∞—ö–µ —Å–∞–¥—Ä–∂–∏ –∞–∫—Ä–µ–¥–∏—Ç–∏–≤–µ
STORAGE_CONNECTION_STRING="DefaultEndpointsProtocol=https;AccountName=myaccount;AccountKey=xK7mN9pQ2wR5..."
COSMOS_CONNECTION_STRING="AccountEndpoint=https://myaccount.documents.azure.com:443/;AccountKey=C2x7..."
SQL_CONNECTION_STRING="Server=myserver.database.windows.net;User=admin;Password=P@ssw0rd..."
```

**–ü—Ä–æ–±–ª–µ–º–∏:**
- ‚ùå –¢–∞—ò–Ω–µ –≤–∏–¥—ô–∏–≤–µ —É –ø—Ä–æ–º–µ–Ω—ô–∏–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–∞
- ‚ùå –õ–æ–≥–æ–≤–∞–Ω–µ —É —Å–∏—Å—Ç–µ–º–∏–º–∞ –∑–∞ –ø–æ—Å—Ç–∞–≤—ô–∞—ö–µ
- ‚ùå –¢–µ—à–∫–æ —Ä–æ—Ç–∏—Ä–∞—ö–µ
- ‚ùå –ù–µ–º–∞ —Ç—Ä–∞–≥–∞ —Ä–µ–≤–∏–∑–∏—ò–µ –ø—Ä–∏—Å—Ç—É–ø–∞

**–ö–∞–¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏:** –°–∞–º–æ –∑–∞ –ª–æ–∫–∞–ª–Ω–∏ —Ä–∞–∑–≤–æ—ò, –Ω–∏–∫–∞–¥–∞ —É –ø—Ä–æ–¥—É–∫—Ü–∏—ò–∏.

---

### –®–∞–±–ª–æ–Ω 2: –†–µ—Ñ–µ—Ä–µ–Ω—Ü–µ Key Vault-–∞ (–±–æ—ô–µ)

**–ö–∞–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ:**
```bicep
// Store secret in Key Vault
resource keyVault 'Microsoft.KeyVault/vaults@2023-02-01' = {
  name: 'mykv'
  properties: {
    enableRbacAuthorization: true
  }
}

// Reference in Container App
env: [
  {
    name: 'STORAGE_KEY'
    secretRef: 'storage-key'  // References Key Vault
  }
]
```

**–ü—Ä–µ–¥–Ω–æ—Å—Ç–∏:**
- ‚úÖ –¢–∞—ò–Ω–µ —Å–µ –±–µ–∑–±–µ–¥–Ω–æ —á—É–≤–∞—ò—É —É Key Vault-—É
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–∞–≤—ô–∞—ö–µ —Ç–∞—ò–Ω–∞–º–∞
- ‚úÖ –†–æ—Ç–∞—Ü–∏—ò–∞ –±–µ–∑ –∏–∑–º–µ–Ω–∞ –∫–æ–¥–∞

**–û–≥—Ä–∞–Ω–∏—á–µ—ö–∞:**
- ‚ö†Ô∏è –ò –¥–∞—ô–µ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∫—ô—É—á–µ–≤–∏/–ª–æ–∑–∏–Ω–∫–µ
- ‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±–Ω–æ —ò–µ —É–ø—Ä–∞–≤—ô–∞—Ç–∏ –ø—Ä–∏—Å—Ç—É–ø–æ–º Key Vault-—É

**–ö–∞–¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏:** –ü—Ä–µ–ª–∞–∑–Ω–∏ –∫–æ—Ä–∞–∫ –æ–¥ –∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏—Ö –Ω–∏–∑–æ–≤–∞ –∫–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç—É.

---

### –®–∞–±–ª–æ–Ω 3: –£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç (–Ω–∞—ò–±–æ—ô–∞ –ø—Ä–∞–∫—Å–∞)

**–ö–∞–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à–µ:**
```bicep
// Enable managed identity
resource containerApp 'Microsoft.App/containerApps@2023-05-01' = {
  name: 'myapp'
  identity: {
    type: 'SystemAssigned'  // Automatically creates identity
  }
}

// Grant permissions
resource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  scope: storageAccount
  properties: {
    roleDefinitionId: storageBlobDataContributorRole
    principalId: containerApp.identity.principalId
  }
}
```

**–ö–æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ:**
```javascript
// –ù–µ–º–∞ –ø–æ—Ç—Ä–µ–±–µ –∑–∞ —Ç–∞—ò–Ω–∞–º–∞!
const { DefaultAzureCredential } = require('@azure/identity');
const { BlobServiceClient } = require('@azure/storage-blob');

const credential = new DefaultAzureCredential();
const blobServiceClient = new BlobServiceClient(
  'https://mystorageaccount.blob.core.windows.net',
  credential
);
```

**–ü—Ä–µ–¥–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ë–µ–∑ —Ç–∞—ò–Ω–∏ —É –∫–æ–¥—É/–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∏
- ‚úÖ –ê—É—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–æ—Ç–∞—Ü–∏—ò–∞ –∞–∫—Ä–µ–¥–∏—Ç–∏–≤–∞
- ‚úÖ –ü–æ—Ç–ø—É–Ω–∏ —Ç—Ä–∞–≥ —Ä–µ–≤–∏–∑–∏—ò–µ
- ‚úÖ –î–æ–∑–≤–æ–ª–µ –∑–∞—Å–Ω–æ–≤–∞–Ω–µ –Ω–∞ RBAC-—É
- ‚úÖ –°–ø—Ä–µ–º–Ω–æ –∑–∞ —É—Å–∫–ª–∞—í–µ–Ω–æ—Å—Ç

**–ö–∞–¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏:** –£–≤–µ–∫, –∑–∞ –ø—Ä–æ–¥—É–∫—Ü–∏—ò—Å–∫–µ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ.

---

## –õ–µ–∫—Ü–∏—ò–∞ 2: –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞ —Å–∞ AZD

### –ö–æ—Ä–∞–∫-–ø–æ-–∫–æ—Ä–∞–∫ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞

–ù–∞–ø—Ä–∞–≤–∏–º–æ –±–µ–∑–±–µ–¥–Ω—É Container App –∫–æ—ò–∞ –∫–æ—Ä–∏—Å—Ç–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∑–∞ –ø—Ä–∏—Å—Ç—É–ø Azure Storage-—É –∏ Key Vault-—É.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—ò–µ–∫—Ç–∞

```
secure-app/
‚îú‚îÄ‚îÄ azure.yaml                 # AZD configuration
‚îú‚îÄ‚îÄ infra/
‚îÇ   ‚îú‚îÄ‚îÄ main.bicep            # Main infrastructure
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ identity.bicep    # Managed identity setup
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyvault.bicep    # Key Vault configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage.bicep     # Storage with RBAC
‚îÇ   ‚îî‚îÄ‚îÄ app/
‚îÇ       ‚îî‚îÄ‚îÄ container-app.bicep
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ app.js                # Application code
    ‚îú‚îÄ‚îÄ package.json
    ‚îî‚îÄ‚îÄ Dockerfile
```

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—à–∏—Ç–µ AZD (azure.yaml)

```yaml
name: secure-app
metadata:
  template: secure-app@1.0.0

services:
  api:
    project: ./src
    language: js
    host: containerapp

# Enable managed identity (AZD handles this automatically)
```

### 2. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –û–º–æ–≥—É—õ–∏—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç

**–§–∞—ò–ª: `infra/main.bicep`**

```bicep
targetScope = 'subscription'

param environmentName string
param location string = 'eastus'

var tags = { 'azd-env-name': environmentName }

// Resource group
resource rg 'Microsoft.Resources/resourceGroups@2021-04-01' = {
  name: 'rg-${environmentName}'
  location: location
  tags: tags
}

// Storage Account
module storage './core/storage.bicep' = {
  name: 'storage'
  scope: rg
  params: {
    name: 'st${uniqueString(rg.id)}'
    location: location
    tags: tags
  }
}

// Key Vault
module keyVault './core/keyvault.bicep' = {
  name: 'keyvault'
  scope: rg
  params: {
    name: 'kv-${uniqueString(rg.id)}'
    location: location
    tags: tags
  }
}

// Container App with Managed Identity
module containerApp './app/container-app.bicep' = {
  name: 'container-app'
  scope: rg
  params: {
    name: 'ca-${environmentName}'
    location: location
    tags: tags
    storageAccountName: storage.outputs.name
    keyVaultName: keyVault.outputs.name
  }
}

// Grant Container App access to Storage
module storageRoleAssignment './core/role-assignment.bicep' = {
  name: 'storage-role'
  scope: rg
  params: {
    principalId: containerApp.outputs.identityPrincipalId
    roleDefinitionId: 'ba92f5b4-2d11-453d-a403-e96b0029c9fe'  // Storage Blob Data Contributor
    targetResourceId: storage.outputs.id
  }
}

// Grant Container App access to Key Vault
module kvRoleAssignment './core/role-assignment.bicep' = {
  name: 'kv-role'
  scope: rg
  params: {
    principalId: containerApp.outputs.identityPrincipalId
    roleDefinitionId: '4633458b-17de-408a-b874-0445c86b69e6'  // Key Vault Secrets User
    targetResourceId: keyVault.outputs.id
  }
}

// Outputs
output AZURE_STORAGE_ACCOUNT_NAME string = storage.outputs.name
output AZURE_KEY_VAULT_NAME string = keyVault.outputs.name
output APP_URL string = containerApp.outputs.url
```

### 3. Container App —Å–∞ —Å–∏—Å—Ç–µ–º—Å–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–∏–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º

**–§–∞—ò–ª: `infra/app/container-app.bicep`**

```bicep
param name string
param location string
param tags object = {}
param storageAccountName string
param keyVaultName string

resource containerApp 'Microsoft.App/containerApps@2023-05-01' = {
  name: name
  location: location
  tags: tags
  identity: {
    type: 'SystemAssigned'  // üîë Enable managed identity
  }
  properties: {
    configuration: {
      ingress: {
        external: true
        targetPort: 3000
      }
    }
    template: {
      containers: [
        {
          name: 'api'
          image: 'myregistry.azurecr.io/api:latest'
          resources: {
            cpu: json('0.5')
            memory: '1Gi'
          }
          env: [
            {
              name: 'AZURE_STORAGE_ACCOUNT_NAME'
              value: storageAccountName
            }
            {
              name: 'AZURE_KEY_VAULT_NAME'
              value: keyVaultName
            }
            // üîë No secrets - managed identity handles authentication!
          ]
        }
      ]
    }
  }
}

// Output the identity for RBAC assignments
output identityPrincipalId string = containerApp.identity.principalId
output id string = containerApp.id
output url string = 'https://${containerApp.properties.configuration.ingress.fqdn}'
```

### 4. –ú–æ–¥—É–ª –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ RBAC —É–ª–æ–≥–∞

**–§–∞—ò–ª: `infra/core/role-assignment.bicep`**

```bicep
param principalId string
param roleDefinitionId string  // Azure built-in role ID
param targetResourceId string

resource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  name: guid(principalId, roleDefinitionId, targetResourceId)
  scope: resourceId('Microsoft.Resources/resourceGroups', resourceGroup().name)
  properties: {
    roleDefinitionId: subscriptionResourceId('Microsoft.Authorization/roleDefinitions', roleDefinitionId)
    principalId: principalId
    principalType: 'ServicePrincipal'
  }
}

output id string = roleAssignment.id
```

### 5. –ö–æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ —Å–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–∏–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º

**–§–∞—ò–ª: `src/app.js`**

```javascript
const express = require('express');
const { DefaultAzureCredential } = require('@azure/identity');
const { BlobServiceClient } = require('@azure/storage-blob');
const { SecretClient } = require('@azure/keyvault-secrets');

const app = express();
const PORT = process.env.PORT || 3000;

// üîë –ò–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò –∞–∫—Ä–µ–¥–∏—Ç–∏–≤ (–∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ —Ä–∞–¥–∏ —Å–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–∏–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º)
const credential = new DefaultAzureCredential();

// –ü–æ–¥–µ—à–∞–≤–∞—ö–µ Azure Storage
const storageAccountName = process.env.AZURE_STORAGE_ACCOUNT_NAME;
const blobServiceClient = new BlobServiceClient(
  `https://${storageAccountName}.blob.core.windows.net`,
  credential  // –ö—ô—É—á–µ–≤–∏ –Ω–∏—Å—É –ø–æ—Ç—Ä–µ–±–Ω–∏!
);

// –ü–æ–¥–µ—à–∞–≤–∞—ö–µ Key Vault
const keyVaultName = process.env.AZURE_KEY_VAULT_NAME;
const secretClient = new SecretClient(
  `https://${keyVaultName}.vault.azure.net`,
  credential  // –ö—ô—É—á–µ–≤–∏ –Ω–∏—Å—É –ø–æ—Ç—Ä–µ–±–Ω–∏!
);

// –ü—Ä–æ–≤–µ—Ä–∞ –∑–¥—Ä–∞–≤—ô–∞
app.get('/health', (req, res) => {
  res.json({ status: 'healthy', authentication: 'managed-identity' });
});

// –û—Ç–ø—Ä–µ–º–∏ –¥–∞—Ç–æ—Ç–µ–∫—É —É blob storage
app.post('/upload', async (req, res) => {
  try {
    const containerClient = blobServiceClient.getContainerClient('uploads');
    await containerClient.createIfNotExists();
    
    const blobName = `file-${Date.now()}.txt`;
    const blockBlobClient = containerClient.getBlockBlobClient(blobName);
    
    await blockBlobClient.upload('Hello from managed identity!', 30);
    
    res.json({
      success: true,
      blobName: blobName,
      message: 'File uploaded using managed identity!'
    });
  } catch (error) {
    console.error('Upload error:', error);
    res.status(500).json({ error: error.message });
  }
});

// –ü—Ä–µ—É–∑–º–∏ —Ç–∞—ò–Ω—É –∏–∑ Key Vault
app.get('/secret/:name', async (req, res) => {
  try {
    const secretName = req.params.name;
    const secret = await secretClient.getSecret(secretName);
    
    res.json({
      name: secretName,
      value: secret.value,
      message: 'Secret retrieved using managed identity!'
    });
  } catch (error) {
    console.error('Secret error:', error);
    res.status(500).json({ error: error.message });
  }
});

// –õ–∏—Å—Ç–∞—ò blob –∫–æ–Ω—Ç–µ—ò–Ω–µ—Ä–µ (–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–∞ –ø—Ä–∏—Å—Ç—É–ø –∑–∞ —á–∏—Ç–∞—ö–µ)
app.get('/containers', async (req, res) => {
  try {
    const containers = [];
    for await (const container of blobServiceClient.listContainers()) {
      containers.push(container.name);
    }
    
    res.json({
      containers: containers,
      count: containers.length,
      message: 'Containers listed using managed identity!'
    });
  } catch (error) {
    console.error('List error:', error);
    res.status(500).json({ error: error.message });
  }
});

app.listen(PORT, () => {
  console.log(`Secure API listening on port ${PORT}`);
  console.log('Authentication: Managed Identity (passwordless)');
});
```

**–§–∞—ò–ª: `src/package.json`**

```json
{
  "name": "secure-app",
  "version": "1.0.0",
  "dependencies": {
    "express": "^4.18.2",
    "@azure/identity": "^4.0.0",
    "@azure/storage-blob": "^12.17.0",
    "@azure/keyvault-secrets": "^4.7.0"
  },
  "scripts": {
    "start": "node app.js"
  }
}
```

### 6. –ü–æ—Å—Ç–∞–≤–∏—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ

```bash
# –ò–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò AZD –æ–∫—Ä—É–∂–µ—ö–µ
azd init

# –î–µ–ø–ª–æ—ò –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É
azd up

# –ü—Ä–µ—É–∑–º–∏ URL –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ
APP_URL=$(azd env get-values | grep APP_URL | cut -d '=' -f2 | tr -d '"')

# –¢–µ—Å—Ç–∏—Ä–∞—ò –ø—Ä–æ–≤–µ—Ä—É –∑–¥—Ä–∞–≤—ô–∞
curl $APP_URL/health
```

**‚úÖ –û—á–µ–∫–∏–≤–∞–Ω–∏ –∏–∑–ª–∞–∑:**
```json
{
  "status": "healthy",
  "authentication": "managed-identity"
}
```

**–¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ –æ—Ç–ø—Ä–µ–º–∞—ö–µ –±–ª–æ–±–∞:**
```bash
curl -X POST $APP_URL/upload
```

**‚úÖ –û—á–µ–∫–∏–≤–∞–Ω–∏ –∏–∑–ª–∞–∑:**
```json
{
  "success": true,
  "blobName": "file-1700404800000.txt",
  "message": "File uploaded using managed identity!"
}
```

**–¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ –ª–∏—Å—Ç—É –∫–æ–Ω—Ç–µ—ò–Ω–µ—Ä–∞:**
```bash
curl $APP_URL/containers
```

**‚úÖ –û—á–µ–∫–∏–≤–∞–Ω–∏ –∏–∑–ª–∞–∑:**
```json
{
  "containers": ["uploads"],
  "count": 1,
  "message": "Containers listed using managed identity!"
}
```

---

## –£–æ–±–∏—á–∞—ò–µ–Ω–µ Azure RBAC —É–ª–æ–≥–µ

### –£–≥—Ä–∞—í–µ–Ω–∏ ID-–æ–≤–∏ —É–ª–æ–≥–∞ –∑–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç

| –°–µ—Ä–≤–∏—Å | –ù–∞–∑–∏–≤ —É–ª–æ–≥–µ | ID —É–ª–æ–≥–µ | –î–æ–∑–≤–æ–ª–µ |
|--------|-------------|----------|---------|
| **Storage** | Storage Blob Data Reader | `2a2b9908-6b94-4a3d-8e5a-a7d8f8cc8a12` | –ß–∏—Ç–∞—ö–µ –±–ª–æ–±–æ–≤–∞ –∏ –∫–æ–Ω—Ç–µ—ò–Ω–µ—Ä–∞ |
| **Storage** | Storage Blob Data Contributor | `ba92f5b4-2d11-453d-a403-e96b0029c9fe` | –ß–∏—Ç–∞—ö–µ, –ø–∏—Å–∞—ö–µ, –±—Ä–∏—Å–∞—ö–µ –±–ª–æ–±–æ–≤–∞ |
| **Storage** | Storage Queue Data Contributor | `974c5e8b-45b9-4653-ba55-5f855dd0fb88` | –ß–∏—Ç–∞—ö–µ, –ø–∏—Å–∞—ö–µ, –±—Ä–∏—Å–∞—ö–µ –ø–æ—Ä—É–∫–∞ —É —Ä–µ–¥—É |
| **Key Vault** | Key Vault Secrets User | `4633458b-17de-408a-b874-0445c86b69e6` | –ß–∏—Ç–∞—ö–µ —Ç–∞—ò–Ω–∏ |
| **Key Vault** | Key Vault Secrets Officer | `b86a8fe4-44ce-4948-aee5-eccb2c155cd7` | –ß–∏—Ç–∞—ö–µ, –ø–∏—Å–∞—ö–µ, –±—Ä–∏—Å–∞—ö–µ —Ç–∞—ò–Ω–∏ |
| **Cosmos DB** | Cosmos DB Built-in Data Reader | `00000000-0000-0000-0000-000000000001` | –ß–∏—Ç–∞—ö–µ –ø–æ–¥–∞—Ç–∞–∫–∞ –∏–∑ Cosmos DB |
| **Cosmos DB** | Cosmos DB Built-in Data Contributor | `00000000-0000-0000-0000-000000000002` | –ß–∏—Ç–∞—ö–µ, –ø–∏—Å–∞—ö–µ –ø–æ–¥–∞—Ç–∞–∫–∞ —É Cosmos DB |
| **SQL Database** | SQL DB Contributor | `9b7fa17d-e63e-47b0-bb0a-15c516ac86ec` | –£–ø—Ä–∞–≤—ô–∞—ö–µ SQL –±–∞–∑–∞–º–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ |
| **Service Bus** | Azure Service Bus Data Owner | `090c5cfd-751d-490a-894a-3ce6f1109419` | –°–ª–∞—ö–µ, –ø—Ä–∏–º–∞—ö–µ, —É–ø—Ä–∞–≤—ô–∞—ö–µ –ø–æ—Ä—É–∫–∞–º–∞ |

### –ö–∞–∫–æ –ø—Ä–æ–Ω–∞—õ–∏ ID-–æ–≤–µ —É–ª–æ–≥–∞

```bash
# –ù–∞–≤–µ–¥–∏ —Å–≤–µ —É–≥—Ä–∞—í–µ–Ω–µ —É–ª–æ–≥–µ
az role definition list --query "[].{Name:roleName, ID:name}" --output table

# –ü—Ä–µ—Ç—Ä–∞–∂–∏ –æ–¥—Ä–µ—í–µ–Ω—É —É–ª–æ–≥—É
az role definition list --query "[?contains(roleName, 'Storage Blob')].{Name:roleName, ID:name}" --output table

# –ü—Ä–∏–∫–∞–∂–∏ –¥–µ—Ç–∞—ô–µ —É–ª–æ–≥–µ
az role definition list --name "Storage Blob Data Contributor"
```

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–µ–∂–±–µ

### –í–µ–∂–±–∞ 1: –û–º–æ–≥—É—õ–∏—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∑–∞ –ø–æ—Å—Ç–æ—ò–µ—õ—É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É ‚≠ê‚≠ê (–°—Ä–µ–¥—ö–∏ –Ω–∏–≤–æ)

**–¶–∏—ô**: –î–æ–¥–∞—ò—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –ø–æ—Å—Ç–æ—ò–µ—õ–µ–º Container App –¥–µ–ø–ª–æ—ò—É

**–°—Ü–µ–Ω–∞—Ä–∏–æ**: –ò–º–∞—Ç–µ Container App –∫–æ—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏ –∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–µ –Ω–∏–∑–æ–≤–µ. –ü—Ä–µ—Ç–≤–æ—Ä–∏—Ç–µ –≥–∞ —É —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç.

**–ü–æ–ª–∞–∑–Ω–∞ —Ç–∞—á–∫–∞**: Container App —Å–∞ –æ–≤–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–æ–º:

```bicep
// ‚ùå Current: Using connection string
env: [
  {
    name: 'STORAGE_CONNECTION_STRING'
    secretRef: 'storage-connection'
  }
]
```

**–ö–æ—Ä–∞—Ü–∏**:

1. **–û–º–æ–≥—É—õ–∏—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —É Bicep-—É:**

```bicep
resource containerApp 'Microsoft.App/containerApps@2023-05-01' = {
  name: 'myapp'
  identity: {
    type: 'SystemAssigned'  // Add this
  }
  // ... rest of configuration
}
```

2. **–î–æ–¥–µ–ª–∏—Ç–µ –ø—Ä–∏—Å—Ç—É–ø Storage-—É:**

```bicep
// Get storage account reference
resource storageAccount 'Microsoft.Storage/storageAccounts@2023-01-01' existing = {
  name: storageAccountName
}

// Assign role
resource roleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  name: guid(containerApp.id, 'ba92f5b4-2d11-453d-a403-e96b0029c9fe', storageAccount.id)
  scope: storageAccount
  properties: {
    roleDefinitionId: subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'ba92f5b4-2d11-453d-a403-e96b0029c9fe')
    principalId: containerApp.identity.principalId
    principalType: 'ServicePrincipal'
  }
}
```

3. **–ê–∂—É—Ä–∏—Ä–∞—ò—Ç–µ –∫–æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ:**

**–ü—Ä–µ (–∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏ –Ω–∏–∑):**
```javascript
const { BlobServiceClient } = require('@azure/storage-blob');

const blobServiceClient = BlobServiceClient.fromConnectionString(
  process.env.STORAGE_CONNECTION_STRING
);
```

**–ü–æ—Å–ª–µ (—É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç):**
```javascript
const { DefaultAzureCredential } = require('@azure/identity');
const { BlobServiceClient } = require('@azure/storage-blob');

const credential = new DefaultAzureCredential();
const blobServiceClient = new BlobServiceClient(
  `https://${process.env.STORAGE_ACCOUNT_NAME}.blob.core.windows.net`,
  credential
);
```

4. **–ê–∂—É—Ä–∏—Ä–∞—ò—Ç–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ –æ–∫—Ä—É–∂–µ—ö–∞:**

```bicep
env: [
  {
    name: 'STORAGE_ACCOUNT_NAME'
    value: storageAccountName  // Just the name, no secrets!
  }
  // Remove STORAGE_CONNECTION_STRING
]
```

5. **–ü–æ—Å—Ç–∞–≤–∏—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ:**

```bash
# –ü–æ–Ω–æ–≤–æ —Ä–∞—Å–ø–æ—Ä–µ–¥–∏—Ç–∏
azd up

# –¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ –¥–∞ –ª–∏ —ò–æ—à —É–≤–µ–∫ —Ä–∞–¥–∏
curl https://myapp.azurecontainerapps.io/upload
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏—ò—É–º–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞ —Å–µ –ø–æ—Å—Ç–∞–≤—ô–∞ –±–µ–∑ –≥—Ä–µ—à–∞–∫–∞
- ‚úÖ –û–ø–µ—Ä–∞—Ü–∏—ò–µ Storage-–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à—É (–æ—Ç–ø—Ä–µ–º–∞—ö–µ, –ª–∏—Å—Ç–∞, –ø—Ä–µ—É–∑–∏–º–∞—ö–µ)
- ‚úÖ –ù–µ–º–∞ –∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏—Ö –Ω–∏–∑–æ–≤–∞ —É –ø—Ä–æ–º–µ–Ω—ô–∏–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–∞
- ‚úÖ –ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç –≤–∏–¥—ô–∏–≤ —É Azure –ø–æ—Ä—Ç–∞–ª—É –ø–æ–¥ "Identity" —Å–µ–∫—Ü–∏—ò–æ–º

**–ü—Ä–æ–≤–µ—Ä–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ —ò–µ –æ–º–æ–≥—É—õ–µ–Ω —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç
az containerapp show \
  --name myapp \
  --resource-group rg-myapp \
  --query "identity.type"
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: "SystemAssigned"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–æ–¥–µ–ª—É —É–ª–æ–≥–µ
az role assignment list \
  --assignee $(az containerapp show --name myapp --resource-group rg-myapp --query "identity.principalId" -o tsv) \
  --scope /subscriptions/{sub-id}/resourceGroups/rg-myapp/providers/Microsoft.Storage/storageAccounts/mystorageaccount
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: –ü—Ä–∏–∫–∞–∑—É—ò–µ —É–ª–æ–≥—É "Storage Blob Data Contributor"
```

**–í—Ä–µ–º–µ**: 20-30 –º–∏–Ω—É—Ç–∞

---

### –í–µ–∂–±–∞ 2: –ü—Ä–∏—Å—Ç—É–ø –≤–∏—à–µ —Å–µ—Ä–≤–∏—Å–∞ —Å–∞ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–∏–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–æ–º ‚≠ê‚≠ê‚≠ê (–ù–∞–ø—Ä–µ–¥–Ω–∏ –Ω–∏–≤–æ)

**–¶–∏—ô**: –ù–∞–ø—Ä–∞–≤–∏—Ç–µ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∫–æ—ò–∏ —Å–µ –¥–µ–ª–∏ –∏–∑–º–µ—í—É –≤–∏—à–µ Container Apps

**–°—Ü–µ–Ω–∞—Ä–∏–æ**: –ò–º–∞—Ç–µ 3 –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ –∫–æ—ò–∏ —Å–≤–∏ —Ç—Ä–µ–±–∞—ò—É –ø—Ä–∏—Å—Ç—É–ø –∏—Å—Ç–æ–º Storage –Ω–∞–ª–æ–≥—É –∏ Key Vault-—É.

**–ö–æ—Ä–∞—Ü–∏**:

1. **–ù–∞–ø—Ä–∞–≤–∏—Ç–µ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç:**

**–§–∞—ò–ª: `infra/core/identity.bicep`**

```bicep
param name string
param location string
param tags object = {}

resource userAssignedIdentity 'Microsoft.ManagedIdentity/userAssignedIdentities@2023-01-31' = {
  name: name
  location: location
  tags: tags
}

output id string = userAssignedIdentity.id
output principalId string = userAssignedIdentity.properties.principalId
output clientId string = userAssignedIdentity.properties.clientId
```

2. **–î–æ–¥–µ–ª–∏—Ç–µ —É–ª–æ–≥–µ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–æ–º –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç—É:**

```bicep
// In main.bicep
module userIdentity './core/identity.bicep' = {
  name: 'user-identity'
  scope: rg
  params: {
    name: 'id-${environmentName}'
    location: location
    tags: tags
  }
}

// Grant Storage access
resource storageRoleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  name: guid(userIdentity.outputs.principalId, 'storage-contributor')
  scope: storageAccount
  properties: {
    roleDefinitionId: subscriptionResourceId('Microsoft.Authorization/roleDefinitions', 'ba92f5b4-2d11-453d-a403-e96b0029c9fe')
    principalId: userIdentity.outputs.principalId
    principalType: 'ServicePrincipal'
  }
}

// Grant Key Vault access
resource kvRoleAssignment 'Microsoft.Authorization/roleAssignments@2022-04-01' = {
  name: guid(userIdentity.outputs.principalId, 'kv-secrets-user')
  scope: keyVault
  properties: {
    roleDefinitionId: subscriptionResourceId('Microsoft.Authorization/roleDefinitions', '4633458b-17de-408a-b874-0445c86b69e6')
    principalId: userIdentity.outputs.principalId
    principalType: 'ServicePrincipal'
  }
}
```

3. **–î–æ–¥–µ–ª–∏—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –≤–∏—à–µ Container Apps:**

```bicep
resource apiGateway 'Microsoft.App/containerApps@2023-05-01' = {
  name: 'api-gateway'
  identity: {
    type: 'UserAssigned'
    userAssignedIdentities: {
      '${userIdentity.outputs.id}': {}
    }
  }
  // ... rest of config
}

resource productService 'Microsoft.App/containerApps@2023-05-01' = {
  name: 'product-service'
  identity: {
    type: 'UserAssigned'
    userAssignedIdentities: {
      '${userIdentity.outputs.id}': {}
    }
  }
  // ... rest of config
}

resource orderService 'Microsoft.App/containerApps@2023-05-01' = {
  name: 'order-service'
  identity: {
    type: 'UserAssigned'
    userAssignedIdentities: {
      '${userIdentity.outputs.id}': {}
    }
  }
  // ... rest of config
}
```

4. **–ö–æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ (—Å–≤–∏ —Å–µ—Ä–≤–∏—Å–∏ –∫–æ—Ä–∏—Å—Ç–µ –∏—Å—Ç–∏ —à–∞–±–ª–æ–Ω):**

```javascript
const { DefaultAzureCredential, ManagedIdentityCredential } = require('@azure/identity');

// –ó–∞ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç, –Ω–∞–≤–µ–¥–∏—Ç–µ ID –∫–ª–∏—ò–µ–Ω—Ç–∞
const credential = new ManagedIdentityCredential(
  process.env.AZURE_CLIENT_ID  // ID –∫–ª–∏—ò–µ–Ω—Ç–∞ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞
);

// –ò–ª–∏ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ DefaultAzureCredential (–∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –¥–µ—Ç–µ–∫—Ç—É—ò–µ)
const credential = new DefaultAzureCredential();

const blobServiceClient = new BlobServiceClient(
  `https://${process.env.STORAGE_ACCOUNT_NAME}.blob.core.windows.net`,
  credential
);
```

5. **–ü–æ—Å—Ç–∞–≤–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ:**

```bash
azd up

# –¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ –¥–∞ –ª–∏ —Å–≤–µ —É—Å–ª—É–≥–µ –º–æ–≥—É –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ —Å–∫–ª–∞–¥–∏—à—Ç—É
curl https://api-gateway.azurecontainerapps.io/upload
curl https://product-service.azurecontainerapps.io/upload
curl https://order-service.azurecontainerapps.io/upload
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏—ò—É–º–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –à–µ–¥–∞–Ω –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —Å–µ –¥–µ–ª–∏ –∏–∑–º–µ—í—É 3 —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –°–≤–∏ —Å–µ—Ä–≤–∏—Å–∏ –º–æ–≥—É –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ Storage-—É –∏ Key Vault-—É
- ‚úÖ –ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç –æ–ø—Å—Ç–∞—ò–µ –∞–∫–æ –∏–∑–±—Ä–∏—à–µ—Ç–µ —ò–µ–¥–∞–Ω —Å–µ—Ä–≤–∏—Å
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–∞–≤—ô–∞—ö–µ –¥–æ–∑–≤–æ–ª–∞–º–∞

**–ü—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞:**
- –à–µ–¥–∞–Ω –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∑–∞ —É–ø—Ä–∞–≤—ô–∞—ö–µ
- –ö–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–µ –¥–æ–∑–≤–æ–ª–µ –∏–∑–º–µ—í—É —Å–µ—Ä–≤–∏—Å–∞
- –û–ø—Å—Ç–∞—ò–µ –Ω–∞–∫–æ–Ω –±—Ä–∏—Å–∞—ö–∞ —Å–µ—Ä–≤–∏—Å–∞
- –ë–æ—ô–µ –∑–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

**–í—Ä–µ–º–µ**: 30-40 –º–∏–Ω—É—Ç–∞

---

### –í–µ–∂–±–∞ 3: –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ —Ä–æ—Ç–∞—Ü–∏—ò–µ —Ç–∞—ò–Ω–∏ —É Key Vault-—É ‚≠ê‚≠ê‚≠ê (–ù–∞–ø—Ä–µ–¥–Ω–∏ –Ω–∏–≤–æ)

**–¶–∏—ô**: –ß—É–≤–∞—ò—Ç–µ API –∫—ô—É—á–µ–≤–µ —Ç—Ä–µ—õ–∏—Ö —Å—Ç—Ä–∞–Ω–∞ —É Key Vault-—É –∏ –ø—Ä–∏—Å—Ç—É–ø–∞—ò—Ç–µ –∏–º –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç

**–°—Ü–µ–Ω–∞—Ä–∏–æ**: –í–∞—à–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ —Ç—Ä–µ–±–∞ –¥–∞ –ø–æ–∑–æ–≤–µ —Å–ø–æ—ô–Ω–∏ API (OpenAI, Stripe, SendGrid) –∫–æ—ò–∏ –∑–∞—Ö—Ç–µ–≤–∞ API –∫—ô—É—á–µ–≤–µ.

**–ö–æ—Ä–∞—Ü–∏**:

1. **–ù–∞–ø—Ä–∞–≤–∏—Ç–µ Key Vault —Å–∞ RBAC-–æ–º:**

**–§–∞—ò–ª: `infra/core/keyvault.bicep`**

```bicep
param name string
param location string
param tags object = {}

resource keyVault 'Microsoft.KeyVault/vaults@2023-02-01' = {
  name: name
  location: location
  tags: tags
  properties: {
    enableRbacAuthorization: true  // Use RBAC instead of access policies
    sku: {
      family: 'A'
      name: 'standard'
    }
    tenantId: subscription().tenantId
    enableSoftDelete: true
    softDeleteRetentionInDays: 90
  }
}

// Allow Container App to read secrets
output id string = keyVault.id
output name string = keyVault.name
output uri string = keyVault.properties.vaultUri
```

2. **–ß—É–≤–∞—ò—Ç–µ —Ç–∞—ò–Ω–µ —É Key Vault-—É:**

```bash
# –î–æ–±–∏—ò –∏–º–µ Key Vault-–∞
KV_NAME=$(azd env get-values | grep AZURE_KEY_VAULT_NAME | cut -d '=' -f2 | tr -d '"')

# –°–∞—á—É–≤–∞—ò API –∫—ô—É—á–µ–≤–µ —Ç—Ä–µ—õ–µ —Å—Ç—Ä–∞–Ω–µ
az keyvault secret set \
  --vault-name $KV_NAME \
  --name "OpenAI-ApiKey" \
  --value "sk-proj-xxxxxxxxxxxxx"

az keyvault secret set \
  --vault-name $KV_NAME \
  --name "Stripe-ApiKey" \
  --value "sk_live_xxxxxxxxxxxxx"

az keyvault secret set \
  --vault-name $KV_NAME \
  --name "SendGrid-ApiKey" \
  --value "SG.xxxxxxxxxxxxx"
```

3. **–ö–æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∑–∞ –ø—Ä–µ—É–∑–∏–º–∞—ö–µ —Ç–∞—ò–Ω–∏:**

**–§–∞—ò–ª: `src/config.js`**

```javascript
const { DefaultAzureCredential } = require('@azure/identity');
const { SecretClient } = require('@azure/keyvault-secrets');

class Config {
  constructor() {
    this.credential = new DefaultAzureCredential();
    this.secretClient = new SecretClient(
      `https://${process.env.AZURE_KEY_VAULT_NAME}.vault.azure.net`,
      this.credential
    );
    this.cache = {};
  }

  async getSecret(secretName) {
    // –ü—Ä–≤–æ –ø—Ä–æ–≤–µ—Ä–∏ –∫–µ—à
    if (this.cache[secretName]) {
      return this.cache[secretName];
    }

    try {
      const secret = await this.secretClient.getSecret(secretName);
      this.cache[secretName] = secret.value;
      console.log(`‚úÖ Retrieved secret: ${secretName}`);
      return secret.value;
    } catch (error) {
      console.error(`‚ùå Failed to get secret ${secretName}:`, error.message);
      throw error;
    }
  }

  async getOpenAIKey() {
    return this.getSecret('OpenAI-ApiKey');
  }

  async getStripeKey() {
    return this.getSecret('Stripe-ApiKey');
  }

  async getSendGridKey() {
    return this.getSecret('SendGrid-ApiKey');
  }
}

module.exports = new Config();
```

4. **–ö–æ—Ä–∏—Å—Ç–∏—Ç–µ —Ç–∞—ò–Ω–µ —É –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∏:**

**–§–∞—ò–ª: `src/app.js`**

```javascript
const express = require('express');
const config = require('./config');
const { OpenAI } = require('openai');

const app = express();

// –ò–Ω–∏—Ü–∏—ò–∞–ª–∏–∑—É—ò OpenAI —Å–∞ –∫—ô—É—á–µ–º –∏–∑ Key Vault-–∞
let openaiClient;

async function initializeServices() {
  const openaiKey = await config.getOpenAIKey();
  openaiClient = new OpenAI({ apiKey: openaiKey });
  console.log('‚úÖ Services initialized with secrets from Key Vault');
}

// –ü–æ–∑–æ–≤–∏ –ø—Ä–∏ –ø–æ–∫—Ä–µ—Ç–∞—ö—É
initializeServices().catch(console.error);

app.post('/chat', async (req, res) => {
  try {
    const completion = await openaiClient.chat.completions.create({
      model: 'gpt-4',
      messages: [{ role: 'user', content: 'Hello!' }]
    });
    
    res.json({
      response: completion.choices[0].message.content,
      authentication: 'Key from Key Vault via Managed Identity'
    });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000, () => {
  console.log('Secure API with Key Vault integration running');
});
```

5. **–ü–æ—Å—Ç–∞–≤–∏—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ:**

```bash
azd up

# –¢–µ—Å—Ç–∏—Ä–∞—ò –¥–∞ API –∫—ô—É—á–µ–≤–∏ —Ä–∞–¥–µ
curl -X POST https://myapp.azurecontainerapps.io/chat \
  -H "Content-Type: application/json" \
  -d '{"message":"Hello AI"}'
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏—ò—É–º–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ù–µ–º–∞ API –∫—ô—É—á–µ–≤–∞ —É –∫–æ–¥—É –∏–ª–∏ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–∏–º –æ–∫—Ä—É–∂–µ—ö–∞
- ‚úÖ –ê–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –ø—Ä–µ—É–∑–∏–º–∞ –∫—ô—É—á–µ–≤–µ –∏–∑ Key Vault-–∞
- ‚úÖ –°–ø–æ—ô–Ω–∏ API-—ò–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—à—É –∏—Å–ø—Ä–∞–≤–Ω–æ
- ‚úÖ –ú–æ–∂–µ—Ç–µ —Ä–æ—Ç–∏—Ä–∞—Ç–∏ –∫—ô—É—á–µ–≤–µ –±–µ–∑ –∏–∑–º–µ–Ω–∞ –∫–æ–¥–∞

**–†–æ—Ç–∏—Ä–∞—ò—Ç–µ —Ç–∞—ò–Ω—É:**

```bash
# –ê–∂—É—Ä–∏—Ä–∞—ò —Ç–∞—ò–Ω—É —É Key Vault
az keyvault secret set \
  --vault-name $KV_NAME \
  --name "OpenAI-ApiKey" \
  --value "sk-proj-NEW_KEY_HERE"

# –ü–æ–Ω–æ–≤–æ –ø–æ–∫—Ä–µ–Ω–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É –¥–∞ –ø—Ä–µ—É–∑–º–µ –Ω–æ–≤–∏ –∫—ô—É—á
az containerapp revision restart \
  --name myapp \
  --resource-group rg-myapp
```

**–í—Ä–µ–º–µ**: 25-35 –º–∏–Ω—É—Ç–∞

---

## –ü—Ä–æ–≤–µ—Ä–∞ –∑–Ω–∞—ö–∞

### 1. –®–∞–±–ª–æ–Ω–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ ‚úì

–¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ —Å–≤–æ—ò–µ —Ä–∞–∑—É–º–µ–≤–∞—ö–µ:

- [ ] **–ü1**: –ö–æ—ò–∞ —Å—É —Ç—Ä–∏ –≥–ª–∞–≤–Ω–∞ —à–∞–±–ª–æ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ? 
  - **–û**: –ö–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏ –Ω–∏–∑–æ–≤–∏ (–∑–∞—Å—Ç–∞—Ä–µ–ª–æ), —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–µ Key Vault-–∞ (–ø—Ä–µ–ª–∞–∑–Ω–æ), —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç (–Ω–∞—ò–±–æ—ô–µ)

- [ ] **–ü2**: –ó–∞—à—Ç–æ —ò–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –±–æ—ô–∏ –æ–¥ –∫–æ–Ω–µ–∫—Ü–∏—ò—Å–∫–∏—Ö –Ω–∏–∑–æ–≤–∞?
  - **–û**: –ù–µ–º–∞ —Ç–∞—ò–Ω–∏ —É –∫–æ–¥—É, –∞—É—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–æ—Ç–∞—Ü–∏—ò–∞, –ø–æ—Ç–ø—É–Ω–∏ —Ç—Ä–∞–≥ —Ä–µ–≤–∏–∑–∏—ò–µ, RBAC –¥–æ–∑–≤–æ–ª–µ

- [ ] **–ü3**: –ö–∞–¥–∞ –±–∏—Å—Ç–µ –∫–æ—Ä–∏—Å—Ç–∏–ª–∏ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏ –¥–æ–¥–µ—ô–µ–Ω –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —É–º–µ—Å—Ç–æ —Å–∏—Å—Ç–µ–º—Å–∫–∏ –¥–æ–¥–µ—ô–µ–Ω–æ–≥?
  - **–û**: –ö–∞–¥–∞ –¥–µ–ª–∏—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∏–∑–º–µ—í—É –≤–∏—à–µ —Ä–µ—Å—É—Ä—Å–∞ –∏–ª–∏ –∫–∞–¥–∞ —ò–µ –∂–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞ –Ω–µ–∑–∞–≤–∏—Å–∞–Ω –æ–¥ —Ä–µ—Å—É—Ä—Å–∞

**–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –∫–æ—ò–∏ —Ç–∏–ø –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞ –≤–∞—à–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –∫–æ—Ä–∏—Å—Ç–∏
az containerapp show \
  --name myapp \
  --resource-group rg-myapp \
  --query "identity.type"

# –ù–∞–≤–µ–¥–∏—Ç–µ —Å–≤–µ –¥–æ–¥–µ–ª–µ —É–ª–æ–≥–∞ –∑–∞ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç
az role assignment list \
  --assignee $(az containerapp show --name myapp --resource-group rg-myapp --query "identity.principalId" -o tsv)
```

---

### 2. RBAC –∏ –¥–æ–∑–≤–æ–ª–µ ‚úì

–¢–µ—Å—Ç–∏—Ä–∞—ò—Ç–µ —Å–≤–æ—ò–µ —Ä–∞–∑—É–º–µ–≤–∞—ö–µ:

- [ ] **–ü1**: –ö–æ—ò–∏ —ò–µ ID —É–ª–æ–≥–µ –∑–∞ "Storage Blob Data Contributor"?
  - **–û**: `ba92f5b4-2d11-453d-a403-e96b0029c9fe`

- [ ] **–ü2**: –ö–æ—ò–µ –¥–æ–∑–≤–æ–ª
- [ ] **Q1**: –ö–∞–∫–æ –æ–º–æ–≥—É—õ–∏—Ç–∏ RBAC –∑–∞ Key Vault —É–º–µ—Å—Ç–æ –ø—Ä–∏—Å—Ç—É–ø–Ω–∏—Ö –ø–æ–ª–∏—Ç–∏–∫–∞?
  - **A**: –ü–æ—Å—Ç–∞–≤–∏—Ç–µ `enableRbacAuthorization: true` —É Bicep

- [ ] **Q2**: –ö–æ—ò–∞ Azure SDK –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–±—Ä–∞—í—É—ò–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –ø—Ä–µ–∫–æ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞?
  - **A**: `@azure/identity` —Å–∞ `DefaultAzureCredential` –∫–ª–∞—Å–æ–º

- [ ] **Q3**: –ö–æ–ª–∏–∫–æ –¥—É–≥–æ —Ç–∞—ò–Ω–µ –∏–∑ Key Vault-–∞ –æ—Å—Ç–∞—ò—É —É –∫–µ—à—É?
  - **A**: –ó–∞–≤–∏—Å–∏ –æ–¥ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–µ; –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—ò—Ç–µ —Å–æ–ø—Å—Ç–≤–µ–Ω—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—ò—É –∫–µ—à–∏—Ä–∞—ö–∞

**–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∞:**
```bash
# –¢–µ—Å—Ç–∏—Ä–∞—ò –ø—Ä–∏—Å—Ç—É–ø Key Vault-—É
az keyvault secret show \
  --vault-name $KV_NAME \
  --name "OpenAI-ApiKey" \
  --query "value"

# –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞ –ª–∏ —ò–µ RBAC –æ–º–æ–≥—É—õ–µ–Ω
az keyvault show \
  --name $KV_NAME \
  --query "properties.enableRbacAuthorization"
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: —Ç–∞—á–Ω–æ
```

---

## –ù–∞—ò–±–æ—ô–µ –ø—Ä–∞–∫—Å–µ –∑–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç

### ‚úÖ –£–†–ê–î–ò–¢–ï:

1. **–£–≤–µ–∫ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —É –ø—Ä–æ–¥—É–∫—Ü–∏—ò–∏**
   ```bicep
   identity: {
     type: 'SystemAssigned'
   }
   ```

2. **–ö–æ—Ä–∏—Å—Ç–∏—Ç–µ RBAC —É–ª–æ–≥–µ —Å–∞ –Ω–∞—ò–º–∞—ö–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞**
   - –ö–æ—Ä–∏—Å—Ç–∏—Ç–µ —É–ª–æ–≥—É "Reader" –∫–∞–¥ –≥–æ–¥ —ò–µ –º–æ–≥—É—õ–µ
   - –ò–∑–±–µ–≥–∞–≤–∞—ò—Ç–µ —É–ª–æ–≥–µ "Owner" –∏–ª–∏ "Contributor" –æ—Å–∏–º –∞–∫–æ —ò–µ –Ω–µ–æ–ø—Ö–æ–¥–Ω–æ

3. **–ß—É–≤–∞—ò—Ç–µ –∫—ô—É—á–µ–≤–µ —Ç—Ä–µ—õ–∏—Ö —Å—Ç—Ä–∞–Ω–∞ —É Key Vault-—É**
   ```javascript
   const apiKey = await secretClient.getSecret('ThirdPartyApiKey');
   ```

4. **–û–º–æ–≥—É—õ–∏—Ç–µ –µ–≤–∏–¥–µ–Ω—Ü–∏—ò—É –ø—Ä–∏—Å—Ç—É–ø–∞**
   ```bicep
   diagnosticSettings: {
     logs: [{ category: 'AuditEvent', enabled: true }]
   }
   ```

5. **–ö–æ—Ä–∏—Å—Ç–∏—Ç–µ —Ä–∞–∑–ª–∏—á–∏—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–µ –∑–∞ —Ä–∞–∑–≤–æ—ò, —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ –∏ –ø—Ä–æ–¥—É–∫—Ü–∏—ò—É**
   ```bash
   azd env new dev
   azd env new staging
   azd env new prod
   ```

6. **–†–µ–¥–æ–≤–Ω–æ —Ä–æ—Ç–∏—Ä–∞—ò—Ç–µ —Ç–∞—ò–Ω–µ**
   - –ü–æ—Å—Ç–∞–≤–∏—Ç–µ –¥–∞—Ç—É–º–µ –∏—Å—Ç–µ–∫–∞ –∑–∞ —Ç–∞—ò–Ω–µ —É Key Vault-—É
   - –ê—É—Ç–æ–º–∞—Ç–∏–∑—É—ò—Ç–µ —Ä–æ—Ç–∞—Ü–∏—ò—É –ø–æ–º–æ—õ—É Azure Functions

### ‚ùå –ù–ï –£–†–ê–î–ò–¢–ï:

1. **–ù–∏–∫–∞–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ä–∞—ò—Ç–µ —Ç–∞—ò–Ω–µ**
   ```javascript
   // ‚ùå –õ–û–®–ï
   const apiKey = "sk-proj-xxxxxxxxxxxxx";
   ```

2. **–ù–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ connection strings —É –ø—Ä–æ–¥—É–∫—Ü–∏—ò–∏**
   ```javascript
   // ‚ùå –õ–û–®–ï
   BlobServiceClient.fromConnectionString(process.env.STORAGE_CONNECTION_STRING)
   ```

3. **–ù–µ –¥–∞—ò—Ç–µ –ø—Ä–µ–∫–æ–º–µ—Ä–Ω–µ –¥–æ–∑–≤–æ–ª–µ**
   ```bicep
   // ‚ùå BAD - too much access
   roleDefinitionId: 'Owner'
   
   // ‚úÖ GOOD - least privilege
   roleDefinitionId: 'Storage Blob Data Reader'
   ```

4. **–ù–µ –±–µ–ª–µ–∂–∏—Ç–µ —Ç–∞—ò–Ω–µ**
   ```javascript
   // ‚ùå –õ–û–®–ï
   console.log('API Key:', apiKey);
   
   // ‚úÖ –î–û–ë–†–û
   console.log('API Key retrieved successfully');
   ```

5. **–ù–µ –¥–µ–ª–∏—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–µ –ø—Ä–æ–¥—É–∫—Ü–∏—ò–µ –∏–∑–º–µ—í—É –æ–∫—Ä—É–∂–µ—ö–∞**
   ```bicep
   // ‚ùå BAD - same identity for dev and prod
   // ‚úÖ GOOD - separate identities per environment
   ```

---

## –í–æ–¥–∏—á –∑–∞ —Ä–µ—à–∞–≤–∞—ö–µ –ø—Ä–æ–±–ª–µ–º–∞

### –ü—Ä–æ–±–ª–µ–º: "Unauthorized" –ø—Ä–∏ –ø—Ä–∏—Å—Ç—É–ø—É Azure Storage-—É

**–°–∏–º–ø—Ç–æ–º–∏:**
```
Error: Unauthorized (403)
AuthorizationPermissionMismatch: This request is not authorized to perform this operation
```

**–î–∏—ò–∞–≥–Ω–æ–∑–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ —ò–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –æ–º–æ–≥—É—õ–µ–Ω
az containerapp show \
  --name myapp \
  --resource-group rg-myapp \
  --query "identity.type"
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: "SystemAssigned" –∏–ª–∏ "UserAssigned"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–æ–¥–µ–ª–µ —É–ª–æ–≥–∞
PRINCIPAL_ID=$(az containerapp show --name myapp --resource-group rg-myapp --query "identity.principalId" -o tsv)
az role assignment list --assignee $PRINCIPAL_ID

# –û—á–µ–∫—É—ò–µ —Å–µ: –¢—Ä–µ–±–∞ –¥–∞ –≤–∏–¥–∏—Ç–µ "Storage Blob Data Contributor" –∏–ª–∏ —Å–ª–∏—á–Ω—É —É–ª–æ–≥—É
```

**–†–µ—à–µ—ö–∞:**

1. **–î–æ–¥–µ–ª–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–Ω—É RBAC —É–ª–æ–≥—É:**
```bash
STORAGE_ID=$(az storage account show --name mystorageaccount --resource-group rg-myapp --query "id" -o tsv)
az role assignment create \
  --assignee $PRINCIPAL_ID \
  --role "Storage Blob Data Contributor" \
  --scope $STORAGE_ID
```

2. **–°–∞—á–µ–∫–∞—ò—Ç–µ –¥–∞ —Å–µ –ø—Ä–æ–º–µ–Ω–µ –ø—Ä–æ–ø–∞–≥–∏—Ä–∞—ò—É (–º–æ–∂–µ —Ç—Ä–∞—ò–∞—Ç–∏ 5-10 –º–∏–Ω—É—Ç–∞):**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –¥–æ–¥–µ–ª–µ —É–ª–æ–≥–µ
az role assignment list --assignee $PRINCIPAL_ID --scope $STORAGE_ID
```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –∞–ø–ª–∏–∫–∞—Ü–∏–æ–Ω–∏ –∫–æ–¥ –∫–æ—Ä–∏—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–Ω–µ –∫—Ä–µ–¥–µ–Ω—Ü–∏—ò–∞–ª–µ:**
```javascript
// –£–≤–µ—Ä–∏—Ç–µ —Å–µ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ DefaultAzureCredential
const credential = new DefaultAzureCredential();
```

---

### –ü—Ä–æ–±–ª–µ–º: –ü—Ä–∏—Å—Ç—É–ø Key Vault-—É —ò–µ –æ–¥–±–∏—ò–µ–Ω

**–°–∏–º–ø—Ç–æ–º–∏:**
```
Error: Forbidden (403)
The user, group or application does not have secrets get permission
```

**–î–∏—ò–∞–≥–Ω–æ–∑–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ —ò–µ –æ–º–æ–≥—É—õ–µ–Ω RBAC –∑–∞ Key Vault
az keyvault show \
  --name $KV_NAME \
  --query "properties.enableRbacAuthorization"
# ‚úÖ –û—á–µ–∫—É—ò–µ —Å–µ: —Ç–∞—á–Ω–æ

# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–æ–¥–µ–ª–µ —É–ª–æ–≥–∞
az role assignment list \
  --assignee $PRINCIPAL_ID \
  --scope /subscriptions/{sub-id}/resourceGroups/rg-myapp/providers/Microsoft.KeyVault/vaults/$KV_NAME
```

**–†–µ—à–µ—ö–∞:**

1. **–û–º–æ–≥—É—õ–∏—Ç–µ RBAC –Ω–∞ Key Vault-—É:**
```bash
az keyvault update \
  --name $KV_NAME \
  --enable-rbac-authorization true
```

2. **–î–æ–¥–µ–ª–∏—Ç–µ —É–ª–æ–≥—É Key Vault Secrets User:**
```bash
KV_ID=$(az keyvault show --name $KV_NAME --query "id" -o tsv)
az role assignment create \
  --assignee $PRINCIPAL_ID \
  --role "Key Vault Secrets User" \
  --scope $KV_ID
```

---

### –ü—Ä–æ–±–ª–µ–º: DefaultAzureCredential –Ω–µ —Ä–∞–¥–∏ –ª–æ–∫–∞–ª–Ω–æ

**–°–∏–º–ø—Ç–æ–º–∏:**
```
Error: DefaultAzureCredential failed to retrieve a token
CredentialUnavailableError: No credential available
```

**–î–∏—ò–∞–≥–Ω–æ–∑–∞:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –¥–∞ –ª–∏ —Å—Ç–µ –ø—Ä–∏—ò–∞–≤—ô–µ–Ω–∏
az account show

# –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É Azure CLI
az ad signed-in-user show
```

**–†–µ—à–µ—ö–∞:**

1. **–ü—Ä–∏—ò–∞–≤–∏—Ç–µ —Å–µ –Ω–∞ Azure CLI:**
```bash
az login
```

2. **–ü–æ—Å—Ç–∞–≤–∏—Ç–µ Azure –ø—Ä–µ—Ç–ø–ª–∞—Ç—É:**
```bash
az account set --subscription "Your Subscription Name"
```

3. **–ó–∞ –ª–æ–∫–∞–ª–Ω–∏ —Ä–∞–∑–≤–æ—ò –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ –æ–∫—Ä—É–∂–µ—ö–∞:**
```bash
export AZURE_TENANT_ID="your-tenant-id"
export AZURE_CLIENT_ID="your-client-id"
export AZURE_CLIENT_SECRET="your-client-secret"
```

4. **–ò–ª–∏ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ –¥—Ä—É–≥–∞—á–∏—ò–µ –∫—Ä–µ–¥–µ–Ω—Ü–∏—ò–∞–ª–µ –ª–æ–∫–∞–ª–Ω–æ:**
```javascript
const { DefaultAzureCredential, AzureCliCredential } = require('@azure/identity');

// –ö–æ—Ä–∏—Å—Ç–∏—Ç–µ AzureCliCredential –∑–∞ –ª–æ–∫–∞–ª–Ω–∏ —Ä–∞–∑–≤–æ—ò
const credential = process.env.NODE_ENV === 'production' 
  ? new DefaultAzureCredential()
  : new AzureCliCredential();
```

---

### –ü—Ä–æ–±–ª–µ–º: –î–æ–¥–µ–ª–∞ —É–ª–æ–≥–∞ —Ç—Ä–∞—ò–µ –ø—Ä–µ–¥—É–≥–æ –¥–∞ —Å–µ –ø—Ä–æ–ø–∞–≥–∏—Ä–∞

**–°–∏–º–ø—Ç–æ–º–∏:**
- –£–ª–æ–≥–∞ —ò–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–¥–µ—ô–µ–Ω–∞
- –ò –¥–∞—ô–µ –¥–æ–±–∏—ò–∞—Ç–µ 403 –≥—Ä–µ—à–∫–µ
- –ü–æ–≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏—Å—Ç—É–ø (–ø–æ–Ω–µ–∫–∞–¥ —Ä–∞–¥–∏, –ø–æ–Ω–µ–∫–∞–¥ –Ω–µ)

**–û–±—ò–∞—à—ö–µ—ö–µ:**
Azure RBAC –ø—Ä–æ–º–µ–Ω–µ –º–æ–≥—É —Ç—Ä–∞—ò–∞—Ç–∏ 5-10 –º–∏–Ω—É—Ç–∞ –¥–∞ —Å–µ –≥–ª–æ–±–∞–ª–Ω–æ –ø—Ä–æ–ø–∞–≥–∏—Ä–∞—ò—É.

**–†–µ—à–µ—ö–µ:**

```bash
# –°–∞—á–µ–∫–∞—ò –∏ –ø–æ–∫—É—à–∞—ò –ø–æ–Ω–æ–≤–æ
echo "Waiting for RBAC propagation..."
sleep 300  # –°–∞—á–µ–∫–∞—ò 5 –º–∏–Ω—É—Ç–∞

# –¢–µ—Å—Ç–∏—Ä–∞—ò –ø—Ä–∏—Å—Ç—É–ø
curl https://myapp.azurecontainerapps.io/upload

# –ê–∫–æ –∏ –¥–∞—ô–µ –Ω–µ —Ä–∞–¥–∏, –ø–æ–Ω–æ–≤–æ –ø–æ–∫—Ä–µ–Ω–∏ –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É
az containerapp revision restart \
  --name myapp \
  --resource-group rg-myapp
```

---

## –†–∞–∑–º–∞—Ç—Ä–∞—ö–∞ —Ç—Ä–æ—à–∫–æ–≤–∞

### –¢—Ä–æ—à–∫–æ–≤–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–æ–≥ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞

| –†–µ—Å—É—Ä—Å | –¢—Ä–æ—à–∞–∫ |
|--------|--------|
| **–£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç** | üÜì **–ë–ï–°–ü–õ–ê–¢–ù–û** - –ù–µ–º–∞ –Ω–∞–ø–ª–∞—Ç–µ |
| **RBAC –¥–æ–¥–µ–ª–∞ —É–ª–æ–≥–∞** | üÜì **–ë–ï–°–ü–õ–ê–¢–ù–û** - –ù–µ–º–∞ –Ω–∞–ø–ª–∞—Ç–µ |
| **Azure AD –∑–∞—Ö—Ç–µ–≤–∏ –∑–∞ —Ç–æ–∫–µ–Ω–µ** | üÜì **–ë–ï–°–ü–õ–ê–¢–ù–û** - –£–∫—ô—É—á–µ–Ω–æ |
| **–û–ø–µ—Ä–∞—Ü–∏—ò–µ Key Vault-–∞** | $0.03 –∑–∞ 10,000 –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ |
| **–°–∫–ª–∞–¥–∏—à—Ç–µ—ö–µ —É Key Vault-—É** | $0.024 –ø–æ —Ç–∞—ò–Ω–∏ –º–µ—Å–µ—á–Ω–æ |

**–£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —à—Ç–µ–¥–∏ –Ω–æ–≤–∞—Ü —Ç–∞–∫–æ —à—Ç–æ:**
- ‚úÖ –ï–ª–∏–º–∏–Ω–∏—à–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ Key Vault-–∞ –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É –∏–∑–º–µ—í—É —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ –°–º–∞—ö—É—ò–µ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ (–±–µ–∑ –ø—Ä–æ—Ü—É—Ä–µ–ª–∏—Ö –∫—Ä–µ–¥–µ–Ω—Ü–∏—ò–∞–ª–∞)
- ‚úÖ –°–º–∞—ö—É—ò–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ —Ç—Ä–æ—à–∫–æ–≤–µ (–±–µ–∑ —Ä—É—á–Ω–µ —Ä–æ—Ç–∞—Ü–∏—ò–µ)

**–ü—Ä–∏–º–µ—Ä –ø–æ—Ä–µ—í–µ—ö–∞ —Ç—Ä–æ—à–∫–æ–≤–∞ (–º–µ—Å–µ—á–Ω–æ):**

| –°—Ü–µ–Ω–∞—Ä–∏–æ | Connection Strings | –£–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç | –£—à—Ç–µ–¥–∞ |
|----------|--------------------|---------------------|--------|
| –ú–∞–ª–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ (1M –∑–∞—Ö—Ç–µ–≤–∞) | ~$50 (Key Vault + –æ–ø–µ—Ä–∞—Ü–∏—ò–µ) | ~$0 | $50/–º–µ—Å–µ—á–Ω–æ |
| –°—Ä–µ–¥—ö–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ (10M –∑–∞—Ö—Ç–µ–≤–∞) | ~$200 | ~$0 | $200/–º–µ—Å–µ—á–Ω–æ |
| –í–µ–ª–∏–∫–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ (100M –∑–∞—Ö—Ç–µ–≤–∞) | ~$1,500 | ~$0 | $1,500/–º–µ—Å–µ—á–Ω–æ |

---

## –°–∞–∑–Ω–∞—ò—Ç–µ –≤–∏—à–µ

### –ó–≤–∞–Ω–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò–∞
- [Azure Managed Identity](https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/overview)
- [Azure RBAC](https://learn.microsoft.com/azure/role-based-access-control/overview)
- [Azure Key Vault](https://learn.microsoft.com/azure/key-vault/general/overview)
- [DefaultAzureCredential](https://learn.microsoft.com/dotnet/api/azure.identity.defaultazurecredential)

### SDK –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò–∞
- [@azure/identity (Node.js)](https://www.npmjs.com/package/@azure/identity)
- [Azure.Identity (C#)](https://www.nuget.org/packages/Azure.Identity/)
- [azure-identity (Python)](https://pypi.org/project/azure-identity/)

### –°–ª–µ–¥–µ—õ–∏ –∫–æ—Ä–∞—Ü–∏ —É –æ–≤–æ–º –∫—É—Ä—Å—É
- ‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: [–£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–æ–º](configuration.md)
- ‚Üí –°–ª–µ–¥–µ—õ–µ: [–ü—Ä–≤–∏ –ø—Ä–æ—ò–µ–∫–∞—Ç](first-project.md)
- üè† [–ü–æ—á–µ—Ç–Ω–∞ —Å—Ç—Ä–∞–Ω–∞ –∫—É—Ä—Å–∞](../../README.md)

### –ü–æ–≤–µ–∑–∞–Ω–∏ –ø—Ä–∏–º–µ—Ä–∏
- [–ü—Ä–∏–º–µ—Ä Azure OpenAI Chat](../../../../examples/azure-openai-chat) - –ö–æ—Ä–∏—Å—Ç–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç –∑–∞ Azure OpenAI
- [–ü—Ä–∏–º–µ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞](../../../../examples/microservices) - –®–∞–±–ª–æ–Ω–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∑–∞ –≤–∏—à–µ —Å–µ—Ä–≤–∏—Å–∞

---

## –†–µ–∑–∏–º–µ

**–ù–∞—É—á–∏–ª–∏ —Å—Ç–µ:**
- ‚úÖ –¢—Ä–∏ —à–∞–±–ª–æ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ (connection strings, Key Vault, —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç)
- ‚úÖ –ö–∞–∫–æ –æ–º–æ–≥—É—õ–∏—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Å–∞—Ç–∏ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —É AZD
- ‚úÖ RBAC –¥–æ–¥–µ–ª–µ —É–ª–æ–≥–∞ –∑–∞ Azure —Å–µ—Ä–≤–∏—Å–µ
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò—É Key Vault-–∞ –∑–∞ —Ç–∞—ò–Ω–µ —Ç—Ä–µ—õ–∏—Ö —Å—Ç—Ä–∞–Ω–∞
- ‚úÖ –ö–æ—Ä–∏—à—õ–µ—ö–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–∞ –¥–æ–¥–µ—ô–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å–Ω–∏–∫—É –∏ —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –ù–∞—ò–±–æ—ô–µ –ø—Ä–∞–∫—Å–µ –∑–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç –∏ —Ä–µ—à–∞–≤–∞—ö–µ –ø—Ä–æ–±–ª–µ–º–∞

**–ö—ô—É—á–Ω–∏ –∑–∞–∫—ô—É—á—Ü–∏:**
1. **–£–≤–µ–∫ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç —É –ø—Ä–æ–¥—É–∫—Ü–∏—ò–∏** - –ë–µ–∑ —Ç–∞—ò–Ω–∏, –∞—É—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–æ—Ç–∞—Ü–∏—ò–∞
2. **–ö–æ—Ä–∏—Å—Ç–∏—Ç–µ RBAC —É–ª–æ–≥–µ —Å–∞ –Ω–∞—ò–º–∞—ö–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞** - –î–æ–¥–µ–ª–∏—Ç–µ —Å–∞–º–æ –Ω–µ–æ–ø—Ö–æ–¥–Ω–µ –¥–æ–∑–≤–æ–ª–µ
3. **–ß—É–≤–∞—ò—Ç–µ –∫—ô—É—á–µ–≤–µ —Ç—Ä–µ—õ–∏—Ö —Å—Ç—Ä–∞–Ω–∞ —É Key Vault-—É** - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–∞–≤—ô–∞—ö–µ —Ç–∞—ò–Ω–∞–º–∞
4. **–û–¥–≤–æ—ò–∏—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç–µ –ø–æ –æ–∫—Ä—É–∂–µ—ö–∏–º–∞** - –ò–∑–æ–ª–∞—Ü–∏—ò–∞ –∑–∞ —Ä–∞–∑–≤–æ—ò, —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ –∏ –ø—Ä–æ–¥—É–∫—Ü–∏—ò—É
5. **–û–º–æ–≥—É—õ–∏—Ç–µ –µ–≤–∏–¥–µ–Ω—Ü–∏—ò—É –ø—Ä–∏—Å—Ç—É–ø–∞** - –ü—Ä–∞—Ç–∏—Ç–µ –∫–æ —ò–µ –ø—Ä–∏—Å—Ç—É–ø–∏–æ —á–µ–º—É

**–°–ª–µ–¥–µ—õ–∏ –∫–æ—Ä–∞—Ü–∏:**
1. –ó–∞–≤—Ä—à–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–µ–∂–±–µ –∏–∑–Ω–∞–¥
2. –ú–∏–≥—Ä–∏—Ä–∞—ò—Ç–µ –ø–æ—Å—Ç–æ—ò–µ—õ—É –∞–ø–ª–∏–∫–∞—Ü–∏—ò—É —Å–∞ connection strings –Ω–∞ —É–ø—Ä–∞–≤—ô–∞–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ç–µ—Ç
3. –ù–∞–ø—Ä–∞–≤–∏—Ç–µ —Å–≤–æ—ò –ø—Ä–≤–∏ AZD –ø—Ä–æ—ò–µ–∫–∞—Ç —Å–∞ –±–µ–∑–±–µ–¥–Ω–æ—à—õ—É –æ–¥ –ø—Ä–≤–æ–≥ –¥–∞–Ω–∞: [–ü—Ä–≤–∏ –ø—Ä–æ—ò–µ–∫–∞—Ç](first-project.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –ø–æ–º–æ—õ—É —É—Å–ª—É–≥–µ –∑–∞ –ø—Ä–µ–≤–æ—í–µ—ö–µ –≤–µ—à—Ç–∞—á–∫–µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ –Ω–∞—Å—Ç–æ—ò–∏–º–æ –¥–∞ –æ–±–µ–∑–±–µ–¥–∏–º–æ —Ç–∞—á–Ω–æ—Å—Ç, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –º–µ—Ä–æ–¥–∞–≤–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–≤–æ–¥ –æ–¥ —Å—Ç—Ä–∞–Ω–µ —ô—É–¥–∏. –ù–µ –ø—Ä–µ—É–∑–∏–º–∞–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∏–ª–∏ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–µ –∫–æ—ò–∏ –º–æ–≥—É –ø—Ä–æ–∏–∑–∞—õ–∏ –∏–∑ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->