<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "7816c6ec50c694c331e7c6092371be4d",
  "translation_date": "2025-09-25T02:12:54+00:00",
  "source_file": "workshop/docs/instructions/2-Validate-AI-Template.md",
  "language_code": "sr"
}
-->
# 2. Валидација шаблона

!!! tip "НА КРАЈУ ОВОГ МОДУЛА БИЋЕТЕ У МОГУЋНОСТИ"

    - [ ] Анализирати архитектуру AI решења
    - [ ] Разумети AZD процес распоређивања
    - [ ] Користити GitHub Copilot за помоћ у коришћењу AZD-а
    - [ ] **Лабораторија 2:** Распоредити и валидирати шаблон AI агената

---

## 1. Увод

[Azure Developer CLI](https://learn.microsoft.com/en-us/azure/developer/azure-developer-cli/) или `azd` је алатка отвореног кода за командну линију која поједностављује радни ток програмера приликом изградње и распоређивања апликација на Azure.

[AZD шаблони](https://learn.microsoft.com/azure/developer/azure-developer-cli/azd-templates) су стандардизовани репозиторијуми који укључују пример кода апликације, _инфраструктуру као код_ и `azd` конфигурационе датотеке за кохерентну архитектуру решења. Провизионисање инфраструктуре постаје једноставно као команда `azd provision`, док `azd up` омогућава провизионисање инфраструктуре **и** распоређивање апликације у једном кораку!

Као резултат, покретање процеса развоја апликације може бити једноставно као проналажење одговарајућег _AZD почетног шаблона_ који највише одговара вашим потребама за апликацијом и инфраструктуром - а затим прилагођавање репозиторијума вашим захтевима.

Пре него што почнемо, уверите се да имате инсталиран Azure Developer CLI.

1. Отворите терминал у VS Code-у и укуцајте ову команду:

      ```bash title="" linenums="0"
      azd version
      ```

1. Требало би да видите нешто овако!

      ```bash title="" linenums="0"
      azd version 1.19.0 (commit b3d68cea969b2bfbaa7b7fa289424428edb93e97)
      ```

**Сада сте спремни да изаберете и распоредите шаблон помоћу azd**

---

## 2. Избор шаблона

Azure AI Foundry платформа долази са [сет препоручених AZD шаблона](https://learn.microsoft.com/en-us/azure/ai-foundry/how-to/develop/ai-template-get-started) који покривају популарне сценарије решења као што су _аутоматизација радног тока са више агената_ и _обрада мултимодалног садржаја_. Ове шаблоне можете открити и посетом Azure AI Foundry портала.

1. Посетите [https://ai.azure.com/templates](https://ai.azure.com/templates)
1. Пријавите се на Azure AI Foundry портал када се то од вас затражи - видећете нешто овако.

![Pick](../../../../../translated_images/01-pick-template.60d2d5fff5ebc374d04f05f556f505a3800b2b5fb08e03153b1b878939b49da6.sr.png)

**Основне** опције су ваши почетни шаблони:

1. [ ] [Get Started with AI Chat](https://github.com/Azure-Samples/get-started-with-ai-chat) који распоређује основну апликацију за ћаскање _са вашим подацима_ на Azure Container Apps. Користите ово за истраживање основног сценарија AI чатбота.
1. [X] [Get Started with AI Agents](https://github.com/Azure-Samples/get-started-with-ai-agents) који такође распоређује стандардног AI агента (са Azure AI Agent Service). Користите ово да се упознате са решењима агентског AI-а која укључују алатке и моделе.

Посетите други линк у новом прозору претраживача (или кликните `Open in GitHub` за повезану картицу). Требало би да видите репозиторијум за овај AZD шаблон. Одвојите минут да истражите README. Архитектура апликације изгледа овако:

![Arch](../../../../../translated_images/architecture.8cec470ec15c65c743dcc1aa383d2500be4d6a9270693b8bfeb3d8deca4a22e1.sr.png)

---

## 3. Активирање шаблона

Хајде да покушамо да распоредимо овај шаблон и уверимо се да је валидан. Пратићемо смернице у одељку [Getting Started](https://github.com/Azure-Samples/get-started-with-ai-agents?tab=readme-ov-file#getting-started).

1. Кликните [овде](https://github.com/codespaces/new/Azure-Samples/get-started-with-ai-agents) - потврдите подразумевану акцију `Create codespace`
1. Ово отвара нови прозор претраживача - сачекајте да се сесија GitHub Codespaces учита
1. Отворите терминал у VS Code-у у Codespaces - укуцајте следећу команду:

   ```bash title="" linenums="0"
   azd up
   ```

Завршите кораке радног тока који ће се покренути:

1. Бићете упитани да се пријавите на Azure - пратите упутства за аутентификацију
1. Унесите јединствено име окружења за вас - нпр., ја сам користио `nitya-mshack-azd`
1. Ово ће креирати `.azure/` фасциклу - видећете подфасциклу са именом окружења
1. Бићете упитани да изаберете име претплате - изаберите подразумевану
1. Бићете упитани за локацију - користите `East US 2`

Сада сачекајте да се провизионисање заврши. **Ово траје 10-15 минута**

1. Када буде готово, ваш конзола ће приказати SUCCESS поруку као ову:
      ```bash title="" linenums="0"
      SUCCESS: Your up workflow to provision and deploy to Azure completed in 10 minutes 17 seconds.
      ```
1. Ваш Azure портал ће сада имати провизионисану групу ресурса са тим именом окружења:

      ![Infra](../../../../../translated_images/02-provisioned-infra.46c706b14f56e0bf36cb90ba441d16690ce10a00d42990bb9441126ceff08990.sr.png)

1. **Сада сте спремни да валидирате распоређену инфраструктуру и апликацију**.

---

## 4. Валидација шаблона

1. Посетите страницу [Resource Groups](https://portal.azure.com/#browse/resourcegroups) на Azure порталу - пријавите се када се то од вас затражи
1. Кликните на RG за име вашег окружења - видећете горњу страницу

      - кликните на ресурс Azure Container Apps
      - кликните на URL апликације у одељку _Essentials_ (горе десно)

1. Требало би да видите хостовани UI апликације као овај:

   ![App](../../../../../translated_images/03-test-application.471910da12c3038e4a3c20e98ebf080abb227e122699ef7b7a262b87af6f98c3.sr.png)

1. Покушајте да поставите неколико [пример питања](https://github.com/Azure-Samples/get-started-with-ai-agents/blob/main/docs/sample_questions.md)

      1. Питајте: ```What is the capital of France?``` 
      1. Питајте: ```What's the best tent under $200 for two people, and what features does it include?```

1. Требало би да добијете одговоре сличне ономе што је приказано испод. _Али како ово функционише?_ 

      ![App](../../../../../translated_images/03-test-question.521c1e863cbaddb604172e95d704407b4b6304c0e04d9130e51b7994f951b026.sr.png)

---

## 5. Валидација агента

Azure Container App распоређује крајњу тачку која се повезује са AI агентом провизионисаним у Azure AI Foundry пројекту за овај шаблон. Хајде да погледамо шта то значи.

1. Вратите се на страницу _Overview_ за вашу групу ресурса на Azure порталу

1. Кликните на ресурс `Azure AI Foundry` у том списку

1. Требало би да видите ово. Кликните на дугме `Go to Azure AI Foundry Portal`. 
   ![Foundry](../../../../../translated_images/04-view-foundry-project.fb94ca41803f28f3a7baa67099e11360380dc7f17bfb0583689cf34419b80498.sr.png)

1. Требало би да видите страницу Foundry пројекта за вашу AI апликацију
   ![Project](../../../../../translated_images/05-visit-foundry-portal.d734e98135892d7e96324cebee01acfa6c339706b2d5e50ede4682beb5d431d9.sr.png)

1. Кликните на `Agents` - видећете подразумеваног агента провизионисаног у вашем пројекту
   ![Agents](../../../../../translated_images/06-visit-agents.bccb263f77b00a0917878ae22b420c3b0df0ade50c0df8e20e6e45d49a220514.sr.png)

1. Изаберите га - и видећете детаље агента. Обратите пажњу на следеће:

      - Агенат користи File Search по подразумеваној вредности (увек)
      - `Knowledge` агента указује да има 32 датотеке отпремљене (за претрагу датотека)
      ![Agents](../../../../../translated_images/07-view-agent-details.0e049f37f61eae6292faf47da2651994dab9ac9cf06c20e7c996c54dbca02245.sr.png)

1. Потражите опцију `Data+indexes` у левом менију и кликните за детаље. 

      - Требало би да видите 32 датотеке података отпремљене за знање.
      - Оне ће одговарати 12 датотека купаца и 20 датотека производа у `src/files` 
      ![Data](../../../../../translated_images/08-visit-data-indexes.5a4cc1686fa0d19a49625f0d4956f3b22681ae275a62c35516dabf1eb9d49a89.sr.png)

**Валидирали сте рад агента!** 

1. Одговори агента су засновани на знању из тих датотека. 
1. Сада можете постављати питања везана за те податке и добијати засноване одговоре.
1. Пример: `customer_info_10.json` описује 3 куповине које је направила "Amanda Perez"

Вратите се на прозор претраживача са крајњом тачком Container App-а и питајте: `What products does Amanda Perez own?`. Требало би да видите нешто овако:

![Data](../../../../../translated_images/09-ask-in-aca.4102297fc465a4d5617af2a71501c3b7607d198df9e598f84abacc32423c17b9.sr.png)

---

## 6. Игралиште за агента

Хајде да изградимо мало више интуиције за могућности Azure AI Foundry-а, тако што ћемо агента испробати у Игралишту за агенте.

1. Вратите се на страницу `Agents` у Azure AI Foundry-у - изаберите подразумеваног агента
1. Кликните на опцију `Try in Playground` - требало би да добијете UI Игралишта као овај
1. Поставите исто питање: `What products does Amanda Perez own?`

    ![Data](../../../../../translated_images/09-ask-in-playground.a1b93794f78fa676c13e7b81dd60bc8589c742cf1069dc4589acf36ac050298d.sr.png)

Добијате исти (или сличан) одговор - али добијате и додатне информације које можете користити за разумевање квалитета, трошкова и перформанси ваше апликације са агентима. На пример:

1. Приметите да одговор наводи датотеке података које су коришћене за "заснивање" одговора
1. Пређите мишем преко било које од ових ознака датотека - да ли подаци одговарају вашем упиту и приказаном одговору?

Такође видите _статистички_ ред испод одговора. 

1. Пређите мишем преко било које метрике - нпр., Safety. Видите нешто овако
1. Да ли процењена оцена одговара вашој интуицији за ниво безбедности одговора?

      ![Data](../../../../../translated_images/10-view-run-info-meter.6cdb89a0eea5531fced8249c58037ab5fb939478145db95b840a6aab8b21d85e.sr.png)

---x

## 7. Уграђена опсервабилност

Опсервабилност се односи на инструментовање ваше апликације како би генерисала податке који се могу користити за разумевање, отклањање грешака и оптимизацију њеног рада. Да бисте стекли осећај за ово:

1. Кликните на дугме `View Run Info` - требало би да видите овај приказ. Ово је пример [праћења агента](https://learn.microsoft.com/en-us/azure/ai-foundry/how-to/develop/trace-agents-sdk#view-trace-results-in-the-azure-ai-foundry-agents-playground) у акцији. _Овај приказ можете добити и кликом на Thread Logs у главном менију_.

   - Стекните осећај за кораке рада и алатке које агент користи
   - Разумите укупни број токена (у односу на употребу токена за излаз) за одговор
   - Разумите кашњење и где се време троши у извршењу

      ![Agent](../../../../../translated_images/10-view-run-info.b20ebd75fef6a1cc01382282300bc7d4afe4aa289de08bc97d1e097d7dc4b77d.sr.png)

1. Кликните на картицу `Metadata` да видите додатне атрибуте за рад, који могу пружити корисни контекст за отклањање проблема касније.   

      ![Agent](../../../../../translated_images/11-view-run-info-metadata.7966986122c7c2dfef2df06e56db549f922c09658b51496fac040106de75e2b9.sr.png)


1. Кликните на картицу `Evaluations` да видите аутоматске процене направљене на одговор агента. Оне укључују процене безбедности (нпр., Self-harm) и процене специфичне за агента (нпр., Intent resolution, Task adherence).

      ![Agent](../../../../../translated_images/12-view-run-info-evaluations.ef25e4577d70efeb777dfadf51fed1694661fa370dd5a4e5fea4aec8de234568.sr.png)

1. На крају, кликните на картицу `Monitoring` у менију са стране.

      - Изаберите картицу `Resource usage` на приказаној страници - и погледајте метрике.
      - Пратите употребу апликације у смислу трошкова (токени) и оптерећења (захтеви).
      - Пратите кашњење апликације до првог бајта (обрада улазних података) и последњег бајта (излаз).

      ![Agent](../../../../../translated_images/13-monitoring-resources.5148015f7311807f774aaa6a45b7156969ce1b1861d1c34d191c98b61d6d8b84.sr.png)

---

## 8. Променљиве окружења

До сада смо прошли кроз распоређивање у претраживачу - и валидирали да је наша инфраструктура провизионисана и да апликација функционише. Али да бисмо радили са апликацијом _из кода_, потребно је да конфигуришемо наше локално развојно окружење са релевантним променљивама потребним за рад са овим ресурсима. Коришћење `azd` чини ово једноставним.

1. Azure Developer CLI [користи променљиве окружења](https://learn.microsoft.com/en-us/azure/developer/azure-developer-cli/manage-environment-variables?tabs=bash) за чување и управљање конфигурационим подешавањима за распоређивање апликација.

1. Променљиве окружења се чувају у `.azure/<env-name>/.env` - ово их ограничава на окружење `env-name` коришћено током распоређивања и помаже вам да изолујете окружења између различитих циљева распоређивања у истом репозиторијуму.

1. Променљиве окружења се аутоматски учитавају од стране `azd` команде кад год она извршава одређену команду (нпр., `azd up`). Имајте на уму да `azd` не чита аутоматски _променљиве окружења на нивоу ОС-а_ (нпр., постављене у љусци) - уместо тога користите `azd set env` и `azd get env` за пренос информација унутар скрипти.

Хајде да испробамо неколико команди:

1. Преузмите све променљиве окружења постављене за `azd` у овом окружењу:

      ```bash title="" linenums="0"
      azd env get-values
      ```
      
      Видећете нешто овако:

      ```bash title="" linenums="0"
      AZURE_AI_AGENT_DEPLOYMENT_NAME="gpt-4o-mini"
      AZURE_AI_AGENT_NAME="agent-template-assistant"
      AZURE_AI_EMBED_DEPLOYMENT_NAME="text-embedding-3-small"
      AZURE_AI_EMBED_DIMENSIONS=100
      ...
      ```

1. Преузмите одређену вредност - нпр., желим да знам да ли смо поставили вредност `AZURE_AI_AGENT_MODEL_NAME`

      ```bash title="" linenums="0"
      azd env get-value AZURE_AI_AGENT_MODEL_NAME 
      ```
      
      Видећете нешто овако - није постављено по подразумеваној вредности!

      ```bash title="" linenums="0"
      ERROR: key 'AZURE_AI_AGENT_MODEL_NAME' not found in the environment values
      ```

1. Поставите нову променљиву окружења за `azd`. Овде ажурирамо име модела агента. _Напомена: све промене направљене ће бити одмах одражене у `.azure/<env-name>/.env` датотеци._

      ```bash title="" linenums="0"
      azd env set AZURE_AI_AGENT_MODEL_NAME gpt-4.1
      azd env set AZURE_AI_AGENT_MODEL_VERSION 2025-04-14
      azd env set AZURE_AI_AGENT_DEPLOYMENT_CAPACITY 150
      ```

      Сада би требало да пронађемо постављену вредност:

      ```bash title="" linenums="0"
      azd env get-value AZURE_AI_AGENT_MODEL_NAME 
      ```

1. Имајте на уму да су неки ресурси трајни (нпр., распоређивање модела) и захтеваће више од само `azd up` да би се приморало поновно распоређивање. Хајде да покушамо да уклонимо оригинално распоређивање и поново распоредимо са промењеним променљивама окружења.

1. **Освежи** Ако сте претходно распоредили инфраструктуру користећи azd шаблон - можете _освежити_ стање ваших локалних променљивих окружења на основу тренутног стања вашег Azure распоређивања користећи ову команду:
      ```bash title="" linenums="0"
      azd env refresh
      ```

      Ово је моћан начин да се _синхронизују_ променљиве окружења између два или више локалних развојних окружења (нпр. тим са више програмера) - омогућавајући да распоређена инфраструктура служи као основа за стање променљивих окружења. Чланови тима једноставно _освежавају_ променљиве како би се поново синхронизовали.

---

## 9. Честитамо 🏆

Управо сте завршили комплетан радни ток у којем сте:

- [X] Изабрали AZD шаблон који желите да користите
- [X] Покренули шаблон помоћу GitHub Codespaces
- [X] Распоредили шаблон и проверили да ради

---

