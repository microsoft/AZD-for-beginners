# ุจููุฉ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ - ูุซุงู ุชุทุจูู ุงูุญุงููุงุช

โฑ๏ธ **ุงูููุช ุงูููุฏุฑ**: 25-35 ุฏูููุฉ | ๐ฐ **ุงูุชูููุฉ ุงูููุฏุฑุฉ**: ~$50-100/ุดูุฑ | โญ **ุงูุชุนููุฏ**: ูุชูุฏู

**๐ ูุณุงุฑ ุงูุชุนูู:**
- โ ุงูุณุงุจู: [ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Flask ุจุณูุทุฉ](../../../../examples/container-app/simple-flask-api) - ุฃุณุงุณูุงุช ุงูุญุงููุฉ ุงููุงุญุฏุฉ
- ๐ฏ **ุฃูุช ููุง**: ุจููุฉ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ (ุฃุณุงุณ ูู ุฎุฏูุชูู)
- โ ุงูุชุงูู: [ุชูุงูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู](../../../../docs/ai-foundry) - ุฃุถู ุฐูุงุกู ุฅูู ุฎุฏูุงุชู
- ๐ [ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ููุฏูุฑุฉ](../../README.md)

---

ุจููุฉ ุฎุฏูุงุช ูุตุบุฑุฉ **ูุจุณุทุฉ ููููุง ุนูููุฉ** ูููุดูุฑุฉ ุนูู Azure Container Apps ุจุงุณุชุฎุฏุงู AZD CLI. ููุถุญ ูุฐุง ุงููุซุงู ุงูุชูุงุตู ุจูู ุงูุฎุฏูุงุชุ ุชูุธูู ุงูุญุงููุงุชุ ูุงููุฑุงูุจุฉ ูู ุฎูุงู ุฅุนุฏุงุฏ ุนููู ูุคูููู ูู ุฎุฏูุชูู.

> **๐ ููุฌ ุงูุชุนูู**: ูุจุฏุฃ ูุฐุง ุงููุซุงู ุจุจููุฉ ุจุณูุทุฉ ูู ุฎุฏูุชูู (ุจูุงุจุฉ API + ุฎุฏูุฉ ุงููุงุฌูุฉ ุงูุฎูููุฉ) ููููู ูุดุฑูุง ูุงูุชุนูู ูููุง ูุนูููุง. ุจุนุฏ ุฅุชูุงู ูุฐุง ุงูุฃุณุงุณุ ููุฏู ุฅุฑุดุงุฏุงุช ูุชูุณูุนูุง ุฅูู ูุธุงู ุฎุฏูุงุช ูุตุบุฑุฉ ูุงูู.

## ูุง ุณุชุชุนูู

ุจุฅููุงู ูุฐุง ุงููุซุงูุ ุณุชุชููู ูู:
- ูุดุฑ ุญุงููุงุช ูุชุนุฏุฏุฉ ุนูู Azure Container Apps
- ุชูููุฐ ุชูุงุตู ุจูู ุงูุฎุฏูุงุช ุนุจุฑ ุงูุดุจูุงุช ุงูุฏุงุฎููุฉ
- ุชููุฆุฉ ุงูุชุญุฌูู ุจูุงุกู ุนูู ุงูุจูุฆุฉ ููุญูุตุงุช ุงูุตุญุฉ
- ูุฑุงูุจุฉ ุงูุชุทุจููุงุช ุงูููุฒุนุฉ ุจุงุณุชุฎุฏุงู Application Insights
- ููู ุฃููุงุท ูุดุฑ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ูุฃูุถู ุงูููุงุฑุณุงุช
- ุชุนูู ุงูุชูุณุน ุงูุชุฏุฑูุฌู ูู ุงูุจุณูุท ุฅูู ุงูุจููุงุช ุงููุนูุฏุฉ

## ุงูุจููุฉ

### ุงููุฑุญูุฉ 1: ูุง ุงูุฐู ูุจููู (ูุถููู ูู ูุฐุง ุงููุซุงู)

```mermaid
graph TB
    Internet[ุงูุฅูุชุฑูุช/ุงููุณุชุฎุฏู]
    Gateway[ุจูุงุจุฉ API<br/>ุญุงููุฉ Node.js<br/>ุงููููุฐ 8080]
    Product[ุฎุฏูุฉ ุงูููุชุฌ<br/>ุญุงููุฉ Python<br/>ุงููููุฐ 8000]
    AppInsights[ุฑุคู ุงูุชุทุจูู<br/>ุงููุฑุงูุจุฉ ูุงูุณุฌูุงุช]
    
    Internet -->|HTTPS| Gateway
    Gateway -->|HTTP ุฏุงุฎูู| Product
    Gateway -.->|ููุงุณุงุช| AppInsights
    Product -.->|ููุงุณุงุช| AppInsights
    
    style Gateway fill:#2196F3,stroke:#1976D2,stroke-width:3px,color:#fff
    style Product fill:#4CAF50,stroke:#388E3C,stroke-width:3px,color:#fff
    style Internet fill:#FF9800,stroke:#F57C00,stroke-width:2px,color:#fff
    style AppInsights fill:#9C27B0,stroke:#7B1FA2,stroke-width:2px,color:#fff
```
**ุชูุงุตูู ุงูููููุงุช:**

| ุงููููู | ุงูุบุฑุถ | ุงููุตูู | ุงูููุงุฑุฏ |
|-----------|---------|--------|-----------|
| **ุจูุงุจุฉ API** | ููุฌูู ุงูุทูุจุงุช ุงูุฎุงุฑุฌูุฉ ุฅูู ุฎุฏูุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ | ุนุงู (HTTPS) | 1 vCPUุ 2GB ุฐุงูุฑุฉุ 2-20 ููุณุฎ |
| **ุฎุฏูุฉ ุงูููุชุฌุงุช** | ูุฏูุฑ ููุฑุณ ุงูููุชุฌุงุช ุจุจูุงูุงุช ูุฎุฒูุฉ ูู ุงูุฐุงูุฑุฉ | ุฏุงุฎูู ููุท | 0.5 vCPUุ 1GB ุฐุงูุฑุฉุ 1-10 ููุณุฎ |
| **Application Insights** | ุชุณุฌูู ูุฑูุฒู ูุชุชุจุน ููุฒูุน | ุจูุงุจุฉ Azure | 1-2 GB/ุดูุฑ ุงุณุชูุนุงุจ ุจูุงูุงุช |

**ููุงุฐุง ูุจุฏุฃ ุจุจุณุงุทุฉุ**
- โ ุงูุดุฑ ูุงููู ุจุณุฑุนุฉ (25-35 ุฏูููุฉ)
- โ ุชุนูู ุฃููุงุท ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ุงูุฃุณุงุณูุฉ ุจุฏูู ุชุนููุฏ
- โ ุดููุฑุฉ ุนูููุฉ ููููู ุชุนุฏูููุง ูุงูุชุฌุฑุจุฉ ุนูููุง
- โ ุชูููุฉ ุฃูู ููุชุนููู (~$50-100/ุดูุฑ ููุงุจู $300-1400/ุดูุฑ)
- โ ุงุจูู ุงูุซูุฉ ูุจู ุฅุถุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช ูุทูุงุจูุฑ ุงูุฑุณุงุฆู

**ุชุดุจูู**: ููุฑ ูู ูุฐุง ูุซู ุชุนูู ุงูููุงุฏุฉ. ุชุจุฏุฃ ุจูููู ุณูุงุฑุงุช ูุงุฑุบ (ุฎุฏูุชุงู)ุ ุชุชูู ุงูุฃุณุงุณูุงุชุ ุซู ุชุชูุฏู ุฅูู ุญุฑูุฉ ุงููุฑูุฑ ูู ุงููุฏููุฉ (5+ ุฎุฏูุงุช ูุน ููุงุนุฏ ุจูุงูุงุช).

### ุงููุฑุญูุฉ 2: ุงูุชูุณุน ุงููุณุชูุจูู (ุจููุฉ ูุฑุฌุนูุฉ)

ุจูุฌุฑุฏ ุฃู ุชุชูู ุจููุฉ ุงูุฎุฏูุชููุ ููููู ุงูุชูุณุน ุฅูู:

```mermaid
graph TB
    User[ูุณุชุฎุฏู]
    Gateway[ุจูุงุจุฉ API<br/>โ ูุถููู]
    Product[ุฎุฏูุฉ ุงูููุชุฌ<br/>โ ูุถููู]
    Order[ุฎุฏูุฉ ุงูุทูุจ<br/>๐ ุฃุถู ุงูุชุงูู]
    UserSvc[ุฎุฏูุฉ ุงููุณุชุฎุฏู<br/>๐ ุฃุถู ุงูุชุงูู]
    Notify[ุฎุฏูุฉ ุงูุฅุดุนุงุฑุงุช<br/>๐ ุฃุถู ุฃุฎูุฑุงู]
    
    CosmosDB[(Cosmos DB<br/>๐ ุจูุงูุงุช ุงูููุชุฌ)]
    AzureSQL[(Azure SQL<br/>๐ ุจูุงูุงุช ุงูุทูุจ)]
    ServiceBus[Azure Service Bus<br/>๐ ุฃุญุฏุงุซ ุบูุฑ ูุชุฒุงููุฉ]
    AppInsights[Application Insights<br/>โ ูุถููู]
    
    User --> Gateway
    Gateway --> Product
    Gateway --> Order
    Gateway --> UserSvc
    
    Product --> CosmosDB
    Order --> AzureSQL
    UserSvc --> AzureSQL
    
    Product -.->|ุญุฏุซ ุฅูุดุงุก ุงูููุชุฌ| ServiceBus
    ServiceBus -.->|ุงูุงุดุชุฑุงู| Notify
    ServiceBus -.->|ุงูุงุดุชุฑุงู| Order
    
    Gateway -.-> AppInsights
    Product -.-> AppInsights
    Order -.-> AppInsights
    UserSvc -.-> AppInsights
    Notify -.-> AppInsights
    
    style Product fill:#4CAF50,stroke:#388E3C,stroke-width:3px,color:#fff
    style Gateway fill:#2196F3,stroke:#1976D2,stroke-width:3px,color:#fff
    style Order fill:#9E9E9E,stroke:#616161,stroke-width:2px,color:#fff
    style UserSvc fill:#9E9E9E,stroke:#616161,stroke-width:2px,color:#fff
    style Notify fill:#9E9E9E,stroke:#616161,stroke-width:2px,color:#fff
```
ุงูุธุฑ ูุณู "ุฏููู ุงูุชูุณุน" ูู ุงูููุงูุฉ ููุญุตูู ุนูู ุชุนูููุงุช ุฎุทูุฉ ุจุฎุทูุฉ.

## ุงูููุฒุงุช ุงููุถููุฉ

โ **ุงูุชุดุงู ุงูุฎุฏูุงุช**: ุงูุชุดุงู ุชููุงุฆู ูุงุฆู ุนูู DNS ุจูู ุงูุญุงููุงุช  
โ **ููุงุฒูุฉ ุงูุชุญููู**: ููุงุฒูุฉ ุชุญููู ูุฏูุฌุฉ ุนุจุฑ ุงููุณุฎ  
โ **ุงูุชุญุฌูู ุงูุชููุงุฆู**: ุชุญุฌูู ูุณุชูู ููู ุฎุฏูุฉ ุจูุงุกู ุนูู ุทูุจุงุช HTTP  
โ **ูุฑุงูุจุฉ ุงูุตุญุฉ**: ูุญูุตุงุช liveness ูreadiness ูููุชุง ุงูุฎุฏูุชูู  
โ **ุงูุชุณุฌูู ุงูููุฒุน**: ุชุณุฌูู ูุฑูุฒู ุจุงุณุชุฎุฏุงู Application Insights  
โ **ุงูุดุจูุงุช ุงูุฏุงุฎููุฉ**: ุชูุงุตู ุขูู ุจูู ุงูุฎุฏูุงุช  
โ **ุชูุณูู ุงูุญุงููุงุช**: ูุดุฑ ูุชุญุฌูู ุชููุงุฆู  
โ **ุชุญุฏูุซุงุช ุจุฏูู ุชููู**: ุชุญุฏูุซุงุช ุชุฏุฑูุฌูุฉ ูุน ุฅุฏุงุฑุฉ ุงูุฅุตุฏุงุฑุงุช  

## ุงููุชุทูุจุงุช ุงููุณุจูุฉ

### ุงูุฃุฏูุงุช ุงููุทููุจุฉ

ูุจู ุงูุจุฏุกุ ุชุญูู ูู ุชุซุจูุช ูุฐู ุงูุฃุฏูุงุช:

1. **[Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd)** (ุงูุฅุตุฏุงุฑ 1.0.0 ุฃู ุฃุญุฏุซ)
   ```bash
   azd version
   # ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ: azd ุจุงูุฅุตุฏุงุฑ 1.0.0 ุฃู ุฃุนูู
   ```

2. **[Azure CLI](https://learn.microsoft.com/cli/azure/install-azure-cli)** (ุงูุฅุตุฏุงุฑ 2.50.0 ุฃู ุฃุญุฏุซ)
   ```bash
   az --version
   # ุงูุฅุฎุฑุงุฌ ุงููุชููุน: azure-cli 2.50.0 ุฃู ุฃุนูู
   ```

3. **[Docker](https://www.docker.com/get-started)** (ููุชุทููุฑ/ุงูุงุฎุชุจุงุฑ ุงููุญูู - ุงุฎุชูุงุฑู)
   ```bash
   docker --version
   # ุงูุฅุฎุฑุงุฌ ุงููุชููุน: ุฅุตุฏุงุฑ Docker 20.10 ุฃู ุฃุนูู
   ```

### ุชุญูู ูู ุฅุนุฏุงุฏู

ุดุบูู ูุฐู ุงูุฃูุงูุฑ ูุชุฃููุฏ ุฃู ุงููุธุงู ุฌุงูุฒ:

```bash
# ุชุญูู ูู Azure Developer CLI
azd version
# โ ูุชููุน: ุฅุตุฏุงุฑ azd 1.0.0 ุฃู ุฃุนูู

# ุชุญูู ูู Azure CLI
az --version
# โ ูุชููุน: ุฅุตุฏุงุฑ azure-cli 2.50.0 ุฃู ุฃุนูู

# ุชุญูู ูู Docker (ุงุฎุชูุงุฑู)
docker --version
# โ ูุชููุน: ุฅุตุฏุงุฑ Docker 20.10 ุฃู ุฃุนูู
```

**ูุนุงููุฑ ุงููุฌุงุญ**: ุชูุฑุฌุน ุฌููุน ุงูุฃูุงูุฑ ุฃุฑูุงู ุฅุตุฏุงุฑ ุชุณุงูู ุฃู ุชุชุฌุงูุฒ ุงูุญุฏ ุงูุฃุฏูู.

### ูุชุทูุจุงุช Azure

- ุงุดุชุฑุงู **Azure** ูุดุท ([ุฅูุดุงุก ุญุณุงุจ ูุฌุงูู](https://azure.microsoft.com/free/))
- ุฃุฐููุงุช ูุฅูุดุงุก ููุงุฑุฏ ูู ุงุดุชุฑุงูู
- ุฏูุฑ **Contributor** ุนูู ุงูุงุดุชุฑุงู ุฃู ูุฌููุนุฉ ุงูููุงุฑุฏ

### ุงููุชุทูุจุงุช ุงููุนุฑููุฉ

ูุฐุง ูุซุงู ุนูู ูุณุชูู **ูุชูุฏู**. ูุฌุจ ุฃู ุชููู ูุฏูู:
- ุฃู ุชููู ูุฏ ุฃูููุช ูุซุงู [ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Flask ุจุณูุทุฉ](../../../../examples/container-app/simple-flask-api) 
- ููู ุฃุณุงุณู ูุจููุฉ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ
- ุฏุฑุงูุฉ ุจู REST APIs ู HTTP
- ููู ูููุงููู ุงูุญุงููุงุช

**ุฌุฏูุฏ ุนูู Container Appsุ** ุงุจุฏุฃ ุฃูููุง ุจูุซุงู [ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Flask ุจุณูุทุฉ](../../../../examples/container-app/simple-flask-api) ูุชุนููู ุงูุฃุณุงุณูุงุช.

## ุจุฏุก ุณุฑูุน (ุฎุทูุฉ ุจุฎุทูุฉ)

### ุงูุฎุทูุฉ 1: ุงูุงุณุชูุณุงุฎ ูุงูุชููู

```bash
git clone https://github.com/microsoft/AZD-for-beginners.git
cd AZD-for-beginners/examples/microservices
```

**โ ูุญุต ุงููุฌุงุญ**: ุชุฃูุฏ ูู ุฑุคูุฉ `azure.yaml`:
```bash
ls
# ุงููุชููุน: README.md, azure.yaml, infra/, src/
```

### ุงูุฎุทูุฉ 2: ุงููุตุงุฏูุฉ ูุน Azure

```bash
azd auth login
```

ููุชุญ ูุฐุง ุงููุชุตูุญ ูููุตุงุฏูุฉ ูุน Azure. ุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงุนุชูุงุฏ Azure ุงูุฎุงุตุฉ ุจู.

**โ ูุญุต ุงููุฌุงุญ**: ูุฌุจ ุฃู ุชุฑู:
```
Logged in to Azure.
```

### ุงูุฎุทูุฉ 3: ุชููุฆุฉ ุงูุจูุฆุฉ

```bash
azd init
```

**ุงููุทุงูุจุงุช ุงูุชู ุณุชุฑููุง**:
- **ุงุณู ุงูุจูุฆุฉ**: ุฃุฏุฎู ุงุณููุง ูุฎุชุตุฑูุง (ูุซุงู: `microservices-dev`)
- **ุงุดุชุฑุงู Azure**: ุงุฎุชุฑ ุงุดุชุฑุงูู
- **ููุทูุฉ Azure**: ุงุฎุชุฑ ููุทูุฉ (ูุซุงู: `eastus`, `westeurope`)

**โ ูุญุต ุงููุฌุงุญ**: ูุฌุจ ุฃู ุชุฑู:
```
SUCCESS: New project initialized!
```

### ุงูุฎุทูุฉ 4: ูุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ูุงูุฎุฏูุงุช

```bash
azd up
```

**ูุง ุงูุฐู ูุญุฏุซ** (ูุณุชุบุฑู 8-12 ุฏูููุฉ):

```mermaid
graph LR
    A[ุชุดุบูู azd up] --> B[ุฅูุดุงุก ูุฌููุนุฉ ุงูููุงุฑุฏ]
    B --> C[ูุดุฑ ุณุฌู ุงูุญุงููุงุช]
    C --> D[ูุดุฑ ุชุญูููุงุช ุงูุณุฌูุงุช]
    D --> E[ูุดุฑ ุชุญูููุงุช ุงูุชุทุจูู]
    E --> F[ุฅูุดุงุก ุจูุฆุฉ ุงูุญุงููุงุช]
    F --> G[ุจูุงุก ุตูุฑุฉ ุจูุงุจุฉ API]
    F --> H[ุจูุงุก ุตูุฑุฉ ุฎุฏูุฉ ุงูููุชุฌ]
    G --> I[ุฏูุน ุฅูู ุงูุณุฌู]
    H --> I
    I --> J[ูุดุฑ ุจูุงุจุฉ API]
    I --> K[ูุดุฑ ุฎุฏูุฉ ุงูููุชุฌ]
    J --> L[ุชูููู Ingress ููุญูุตุงุช ุงูุตุญุฉ]
    K --> L
    L --> M[ุงูุชูู ุงููุดุฑ โ]
    
    style A fill:#2196F3,stroke:#1976D2,stroke-width:3px,color:#fff
    style M fill:#4CAF50,stroke:#388E3C,stroke-width:3px,color:#fff
```
**โ ูุญุต ุงููุฌุงุญ**: ูุฌุจ ุฃู ุชุฑู:
```
SUCCESS: Your application was deployed to Azure in X minutes Y seconds.
Endpoint: https://api-gateway-<unique-id>.azurecontainerapps.io
```

**โฑ๏ธ ุงูููุช**: 8-12 ุฏูููุฉ

### ุงูุฎุทูุฉ 5: ุงุฎุชุจุงุฑ ุงููุดุฑ

```bash
# ุงูุญุตูู ุนูู ููุทุฉ ููุงูุฉ ุงูุจูุงุจุฉ
GATEWAY_URL=$(azd env get-values | grep API_GATEWAY_URL | cut -d '=' -f2 | tr -d '"')

# ุงุฎุชุจุงุฑ ุตุญุฉ ุจูุงุจุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช
curl $GATEWAY_URL/health
```

**โ ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ:**
```json
{
  "status": "healthy",
  "service": "api-gateway",
  "timestamp": "2025-11-19T10:30:00Z"
}
```

**ุงุฎุชุจุฑ ุฎุฏูุฉ ุงูููุชุฌุงุช ุนุจุฑ ุงูุจูุงุจุฉ**:
```bash
# ูุงุฆูุฉ ุงูููุชุฌุงุช
curl $GATEWAY_URL/api/products
```

**โ ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ:**
```json
[
  {"id":1,"name":"Laptop","price":999.99,"stock":50},
  {"id":2,"name":"Mouse","price":29.99,"stock":200},
  {"id":3,"name":"Keyboard","price":79.99,"stock":150}
]
```

**โ ูุญุต ุงููุฌุงุญ**: ููุง ููุทุชู ุงูููุงูุฉ ุชูุฑุฌุนุงู ุจูุงูุงุช JSON ุจุฏูู ุฃุฎุทุงุก.

---

**๐ ุชูุงูููุง!** ููุฏ ูุดุฑุช ุจููุฉ ุฎุฏูุงุช ูุตุบุฑุฉ ุนูู Azure!

## ูููู ุงููุดุฑูุน

ุฌููุน ูููุงุช ุงูุชูููุฐ ููุถููููุฉโูุฐุง ูุซุงู ูุงูู ููุงุจู ููุนูู:

```
microservices/
โ
โโโ README.md                         # This file
โโโ azure.yaml                        # AZD configuration
โโโ .gitignore                        # Git ignore patterns
โ
โโโ infra/                           # Infrastructure as Code (Bicep)
โ   โโโ main.bicep                   # Main orchestration
โ   โโโ abbreviations.json           # Naming conventions
โ   โโโ core/                        # Shared infrastructure
โ   โ   โโโ container-apps-environment.bicep  # Container environment + registry
โ   โ   โโโ monitor.bicep            # Application Insights + Log Analytics
โ   โโโ app/                         # Service definitions
โ       โโโ api-gateway.bicep        # API Gateway container app
โ       โโโ product-service.bicep    # Product Service container app
โ
โโโ src/                             # Application source code
    โโโ api-gateway/                 # Node.js API Gateway
    โ   โโโ app.js                   # Express server with routing
    โ   โโโ package.json             # Node dependencies
    โ   โโโ Dockerfile               # Container definition
    โโโ product-service/             # Python Product Service
        โโโ main.py                  # Flask API with product data
        โโโ requirements.txt         # Python dependencies
        โโโ Dockerfile               # Container definition
```

**ูุงุฐุง ููุนู ูู ูููู:**

**ุงูุจููุฉ ุงูุชุญุชูุฉ (infra/)**:
- `main.bicep`: ูููุณูู ุฌููุน ููุงุฑุฏ Azure ูุงุนุชูุงุฏูุงุชูุง
- `core/container-apps-environment.bicep`: ููุดุฆ ุจูุฆุฉ Container Apps ูุณุฌู ุงูุญุงููุงุช ุงูุฎุงุต ุจู Azure
- `core/monitor.bicep`: ููุนุฏูู Application Insights ููุชุณุฌูู ุงูููุฒุน
- `app/*.bicep`: ุชุนุฑููุงุช ุชุทุจููุงุช ุงูุญุงููุงุช ุงููุฑุฏูุฉ ูุน ุฅุนุฏุงุฏุงุช ุงูุชุญุฌูู ููุญูุตุงุช ุงูุตุญุฉ

**ุจูุงุจุฉ API (src/api-gateway/)**:
- ุฎุฏูุฉ ูููุงุฌููุฉ ููุนุงูุฉ ุชูุฌูู ุงูุทูุจุงุช ุฅูู ุฎุฏูุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ
- ุชูููุฐ ุงูุชุณุฌููุ ููุนุงูุฌุฉ ุงูุฃุฎุทุงุกุ ูุฅุนุงุฏุฉ ุชูุฌูู ุงูุทูุจุงุช
- ุชูุถุญ ุชูุงุตู HTTP ุจูู ุงูุฎุฏูุงุช

**ุฎุฏูุฉ ุงูููุชุฌุงุช (src/product-service/)**:
- ุฎุฏูุฉ ุฏุงุฎููุฉ ุชุญุชูู ุนูู ููุฑุณ ููุชุฌุงุช (ูุฎุฒูู ูู ุงูุฐุงูุฑุฉ ููุจุณุงุทุฉ)
- ูุงุฌูุฉ REST ูุน ูุญูุตุงุช ุงูุตุญุฉ
- ูุซุงู ุนูู ููุท ุฎุฏูุฉ ุฎูููุฉ ูุตุบุฑุฉ

## ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุฎุฏูุงุช

### ุจูุงุจุฉ API (Node.js/Express)

**ุงููููุฐ**: 8080  
**ุงููุตูู**: ุนุงู (ุฏุฎูู ุฎุงุฑุฌู)  
**ุงูุบุฑุถ**: ุชูุฌูู ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ุฅูู ุฎุฏูุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ุงูููุงุณุจุฉ  

**ููุงุท ุงูููุงูุฉ**:
- `GET /` - ูุนูููุงุช ุนู ุงูุฎุฏูุฉ
- `GET /health` - ููุทุฉ ูุญุต ุงูุญุงูุฉ
- `GET /api/products` - ุฅุนุงุฏุฉ ุชูุฌูู ุฅูู ุฎุฏูุฉ ุงูููุชุฌุงุช (ูุงุฆูุฉ ุงููู)
- `GET /api/products/:id` - ุฅุนุงุฏุฉ ุชูุฌูู ุฅูู ุฎุฏูุฉ ุงูููุชุฌุงุช (ุฌูุจ ุญุณุจ ุงููุนุฑู)

**ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ**:
- ุชูุฌูู ุงูุทูุจุงุช ุจุงุณุชุฎุฏุงู axios
- ุชุณุฌูู ูุฑูุฒู
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุฅุฏุงุฑุฉ ุงููููุงุช
- ุงูุชุดุงู ุงูุฎุฏูุงุช ุนุจุฑ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- ุชูุงูู ูุน Application Insights

**ุชุณููุท ุงูุถูุก ุนูู ุงูุดููุฑุฉ** (`src/api-gateway/app.js`):
```javascript
// ุงูุชูุงุตู ุงูุฏุงุฎูู ุจูู ุงูุฎุฏูุงุช
app.get('/api/products', async (req, res) => {
  const response = await axios.get(`${PRODUCT_SERVICE_URL}/products`, {
    timeout: 5000
  });
  res.json(response.data);
});
```

### ุฎุฏูุฉ ุงูููุชุฌุงุช (Python/Flask)

**ุงููููุฐ**: 8000  
**ุงููุตูู**: ุฏุงุฎูู ููุท (ูุง ุฏุฎูู ุฎุงุฑุฌู)  
**ุงูุบุฑุถ**: ูุฏูุฑ ููุฑุณ ุงูููุชุฌุงุช ุจุจูุงูุงุช ูุฎุฒูุฉ ูู ุงูุฐุงูุฑุฉ  

**ููุงุท ุงูููุงูุฉ**:
- `GET /` - ูุนูููุงุช ุนู ุงูุฎุฏูุฉ
- `GET /health` - ููุทุฉ ูุญุต ุงูุญุงูุฉ
- `GET /products` - ุนุฑุถ ุฌููุน ุงูููุชุฌุงุช
- `GET /products/<id>` - ุฌูุจ ุงูููุชุฌ ุญุณุจ ุงููุนุฑู

**ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ**:
- ูุงุฌูุฉ RESTful ุจุงุณุชุฎุฏุงู Flask
- ูุฎุฒู ููุชุฌุงุช ูู ุงูุฐุงูุฑุฉ (ุจุณูุทุ ูุง ุญุงุฌุฉ ููุงุนุฏุฉ ุจูุงูุงุช)
- ูุฑุงูุจุฉ ุงูุตุญุฉ ุจุงุณุชุฎุฏุงู ุงููุญูุตุงุช
- ุชุณุฌูู ููุธู
- ุชูุงูู ูุน Application Insights

**ูููุฐุฌ ุงูุจูุงูุงุช**:
```python
{
  "id": 1,
  "name": "Laptop",
  "description": "High-performance laptop",
  "price": 999.99,
  "stock": 50
}
```

**ููุงุฐุง ุฏุงุฎูู ููุทุ**
ุฎุฏูุฉ ุงูููุชุฌุงุช ุบูุฑ ููุดููุฉ ููุนุงูุฉ. ูุฌุจ ุฃู ุชูุฑ ูู ุงูุทูุจุงุช ุนุจุฑ ุจูุงุจุฉ APIุ ูุงูุชู ุชููุฑ:
- ุงูุฃูุงู: ููุทุฉ ูุตูู ููุชุญูู ุจูุง
- ุงููุฑููุฉ: ูููู ุชุบููุฑ ุงููุงุฌูุฉ ุงูุฎูููุฉ ุฏูู ุงูุชุฃุซูุฑ ุนูู ุงูุนููุงุก
- ุงููุฑุงูุจุฉ: ุชุณุฌูู ูุฑูุฒู ููุทูุจุงุช

## ููู ุชูุงุตู ุงูุฎุฏูุงุช

### ููู ุชุชูุงุตู ุงูุฎุฏูุงุช ูุน ุจุนุถูุง

```mermaid
sequenceDiagram
    participant User
    participant Gateway as ุจูุงุจุฉ API<br/>(ุงููููุฐ 8080)
    participant Product as ุฎุฏูุฉ ุงูููุชุฌ<br/>(ุงููููุฐ 8000)
    participant AI as ุฑุคู ุงูุชุทุจูู
    
    User->>Gateway: GET /api/products
    Gateway->>AI: ุชุณุฌูู ุงูุทูุจ
    Gateway->>Product: GET /products (HTTP ุฏุงุฎูู)
    Product->>AI: ุชุณุฌูู ุงูุงุณุชุนูุงู
    Product-->>Gateway: ุงุณุชุฌุงุจุฉ JSON [ูฅ ููุชุฌุงุช]
    Gateway->>AI: ุชุณุฌูู ุงูุงุณุชุฌุงุจุฉ
    Gateway-->>User: ุงุณุชุฌุงุจุฉ JSON [ูฅ ููุชุฌุงุช]
    
    Note over Gateway,Product: DNS ุงูุฏุงุฎูู: http://product-service
    Note over User,AI: ุฌููุน ุงูุงุชุตุงูุงุช ูุณุฌูุฉ ููุชุนูุจุฉ
```
ูู ูุฐุง ุงููุซุงูุ ุชุชูุงุตู ุจูุงุจุฉ API ูุน ุฎุฏูุฉ ุงูููุชุฌุงุช ุจุงุณุชุฎุฏุงู **ูุฏุงุกุงุช HTTP ุฏุงุฎููุฉ**:

```javascript
// ุจูุงุจุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (src/api-gateway/app.js)
const PRODUCT_SERVICE_URL = process.env.PRODUCT_SERVICE_URL;

// ุฅุฌุฑุงุก ุทูุจ HTTP ุฏุงุฎูู
const response = await axios.get(`${PRODUCT_SERVICE_URL}/products`);
```

**ุงูููุงุท ุงูุฑุฆูุณูุฉ**:

1. **ุงูุงูุชุดุงู ุงููุงุฆู ุนูู DNS**: ุชููุฑ Container Apps ุชููุงุฆููุง DNS ููุฎุฏูุงุช ุงูุฏุงุฎููุฉ
   - ุงุณู ุงููุฌุงู ุงููุคูู ูุฎุฏูุฉ ุงูููุชุฌุงุช: `product-service.internal.<environment>.azurecontainerapps.io`
   - ูุจุณูุทูุง ุฅูู: `http://product-service` (ุชุญูู Container Apps)

2. **ูุง ุชุนุฑุถ ุนูููุง**: ุชุญุชูู ุฎุฏูุฉ ุงูููุชุฌุงุช ุนูู `external: false` ูู Bicep
   - ูุชุงุญุฉ ููุท ุฏุงุฎู ุจูุฆุฉ Container Apps
   - ูุง ูููู ุงููุตูู ุฅูููุง ูู ุงูุฅูุชุฑูุช

3. **ูุชุบูุฑุงุช ุงูุจูุฆุฉ**: ูุชู ุญูู ุนูุงููู URL ููุฎุฏูุงุช ููุช ุงููุดุฑ
   - ููุฑุฑ Bicep ุงุณู ุงููุฌุงู ุงููุคูู ุงูุฏุงุฎูู ุฅูู ุงูุจูุงุจุฉ
   - ูุง ุนูุงููู URL ูุถููุฉ ุซุงุจุชุฉ ูู ุดููุฑุฉ ุงูุชุทุจูู

**ุชุดุจูู**: ููุฑ ูู ูุฐุง ูุบุฑู ุงูููุงุชุจ. ุจูุงุจุฉ API ูู ููุชุจ ุงูุงุณุชูุจุงู (ููุงุฌู ููุนุงูุฉ)ุ ูุฎุฏูุฉ ุงูููุชุฌุงุช ูู ุบุฑูุฉ ููุชุจ (ุฏุงุฎููุฉ ููุท). ูุฌุจ ุนูู ุงูุฒูุงุฑ ุงููุฑูุฑ ุนุจุฑ ุงูุงุณุชูุจุงู ูููุตูู ูุฃู ููุชุจ.

## ุฎูุงุฑุงุช ุงููุดุฑ

### ูุดุฑ ูุงูู (ููุตู ุจู)

```bash
# ูุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ูุงูุฎุฏูุชูู
azd up
```

ูููุดูุฆ ูุฐุง ุงููุดุฑ:
1. ุจูุฆุฉ Container Apps
2. Application Insights
3. ุณุฌู ุงูุญุงููุงุช
4. ุญุงููุฉ ุจูุงุจุฉ API
5. ุญุงููุฉ ุฎุฏูุฉ ุงูููุชุฌุงุช

**ุงูููุช**: 8-12 ุฏูููุฉ

### ูุดุฑ ุฎุฏูุฉ ูุฑุฏูุฉ

```bash
# ุงูุดุฑ ุฎุฏูุฉ ูุงุญุฏุฉ ููุท (ุจุนุฏ ุงูุชุดุบูู ุงูุฃููู ูู azd up)
azd deploy api-gateway

# ุฃู ุงูุดุฑ ุฎุฏูุฉ ุงูููุชุฌ
azd deploy product-service
```

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู**: ุนูุฏูุง ุชููู ุจุชุญุฏูุซ ุงูุดููุฑุฉ ูู ุฎุฏูุฉ ูุงุญุฏุฉ ูุชุฑุบุจ ูู ุฅุนุงุฏุฉ ูุดุฑ ุชูู ุงูุฎุฏูุฉ ููุท.

### ุชุญุฏูุซ ุงูุชูููู

```bash
# ุชุบููุฑ ูุนููุงุช ุงูุชุญุฌูู
azd env set GATEWAY_MAX_REPLICAS 30

# ุฅุนุงุฏุฉ ุงููุดุฑ ุจุงูุชูููู ุงูุฌุฏูุฏ
azd up
```

## ุงูุชููุฆุฉ

### ุฅุนุฏุงุฏุงุช ุงูุชุญุฌูู

ุชู ุชูููู ููุชุง ุงูุฎุฏูุชูู ูุน ุชุญุฌูู ุชููุงุฆู ูุงุฆู ุนูู HTTP ูู ูููุงุช Bicep ุงูุฎุงุตุฉ ุจููุง:

**ุจูุงุจุฉ API**:
- ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุณุฎ: 2 (ุฏุงุฆููุง ุนูู ุงูุฃูู 2 ูู ุฃุฌู ุงูุชูุงูุฑ)
- ุงูุญุฏ ุงูุฃูุตู ูู ุงููุณุฎ: 20
- ููุญุฑููู ุงูุชุญุฌูู: 50 ุทูุจูุง ูุชุฒุงูููุง ููู ูุณุฎุฉ

**ุฎุฏูุฉ ุงูููุชุฌุงุช**:
- ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุณุฎ: 1 (ูููู ุฃู ุชูุฎูุถ ุฅูู ุงูุตูุฑ ุฅุฐุง ูุฒู ุงูุฃูุฑ)
- ุงูุญุฏ ุงูุฃูุตู ูู ุงููุณุฎ: 10
- ููุญุฑููู ุงูุชุญุฌูู: 100 ุทูุจ ูุชุฒุงูู ููู ูุณุฎุฉ

**ุชุฎุตูุต ุงูุชุญุฌูู** (ูู `infra/app/*.bicep`):
```bicep
scale: {
  minReplicas: 1
  maxReplicas: 10
  rules: [
    {
      name: 'http-scale-rule'
      http: {
        metadata: {
          concurrentRequests: '100'  // Adjust this
        }
      }
    }
  ]
}
```

### ุชุฎุตูุต ุงูููุงุฑุฏ

**ุจูุงุจุฉ API**:
- CPU: 1.0 vCPU
- ุงูุฐุงูุฑุฉ: 2 GiB
- ุงูุณุจุจ: ุชุชุนุงูู ูุน ูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุฎุงุฑุฌูุฉ

**ุฎุฏูุฉ ุงูููุชุฌุงุช**:
- CPU: 0.5 vCPU
- ุงูุฐุงูุฑุฉ: 1 GiB
- ุงูุณุจุจ: ุนูููุงุช ุฎูููุฉ ูู ุงูุฐุงูุฑุฉ

### ูุญูุตุงุช ุงูุตุญุฉ

ุชุชุถูู ููุชุง ุงูุฎุฏูุชูู ูุญูุตุงุช liveness ู readiness:

```bicep
probes: [
  {
    type: 'Liveness'
    httpGet: {
      path: '/health'
      port: 8080
    }
    initialDelaySeconds: 10
    periodSeconds: 30
  }
  {
    type: 'Readiness'
    httpGet: {
      path: '/health'
      port: 8080
    }
    initialDelaySeconds: 5
    periodSeconds: 10
  }
]
```

**ูุง ูุนููู ูุฐุง**:
- **Liveness**: ุฅุฐุง ูุดู ูุญุต ุงูุตุญุฉุ ุชุนูุฏ Container Apps ุชุดุบูู ุงูุญุงููุฉ
- **Readiness**: ุฅุฐุง ูู ุชูู ุฌุงูุฒุฉุ ุชููู Container Apps ุชูุฌูู ุงูุญุฑูุฉ ูุชูู ุงููุณุฎุฉ

## ุงูุฑุตุฏ ููุงุจููุฉ ุงูููุงุญุธุฉ

### ุนุฑุถ ุณุฌูุงุช ุงูุฎุฏูุฉ

```bash
# ุนุฑุถ ุงูุณุฌูุงุช ุจุงุณุชุฎุฏุงู azd monitor
azd monitor --logs

# ุฃู ุงุณุชุฎุฏู Azure CLI ูุชุทุจููุงุช ุงูุญุงููุงุช ุงููุญุฏุฏุฉ:
# ุจุซ ุงูุณุฌูุงุช ูู ุจูุงุจุฉ API
az containerapp logs show --name api-gateway --resource-group $RG_NAME --follow

# ุนุฑุถ ุงูุณุฌูุงุช ุงูุฃุฎูุฑุฉ ูุฎุฏูุฉ ุงูููุชุฌ
az containerapp logs show --name product-service --resource-group $RG_NAME --tail 100
```

**ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ**:
```
[api-gateway] API Gateway listening on port 8080
[api-gateway] Product Service URL: http://product-service
[api-gateway] GET /api/products 200 - 45ms
[product-service] Retrieved 5 products
```

### ุงุณุชุนูุงูุงุช Application Insights

ุงุฏุฎู ุฅูู Application Insights ูู ุจูุงุจุฉ Azureุ ุซู ุดุบูู ูุฐู ุงูุงุณุชุนูุงูุงุช:

**ุงูุนุซูุฑ ุนูู ุงูุทูุจุงุช ุงูุจุทูุฆุฉ**:
```kusto
requests
| where timestamp > ago(1h)
| where duration > 1000  // Requests taking >1 second
| summarize count() by name, cloud_RoleName
| order by count_ desc
```

**ุชุชุจุน ูุฏุงุกุงุช ุงูุฎุฏูุฉ ุฅูู ุงูุฎุฏูุฉ**:
```kusto
dependencies
| where timestamp > ago(1h)
| where type == "Http"
| project timestamp, name, target, duration, success
| order by timestamp desc
```

**ูุนุฏู ุงูุฃุฎุทุงุก ุญุณุจ ุงูุฎุฏูุฉ**:
```kusto
exceptions
| where timestamp > ago(24h)
| summarize errorCount = count() by cloud_RoleName, type
| order by errorCount desc
```

**ุญุฌู ุงูุทูุจุงุช ุนุจุฑ ุงูุฒูู**:
```kusto
requests
| where timestamp > ago(1h)
| summarize requestCount = count() by bin(timestamp, 5m), cloud_RoleName
| render timechart
```

### ุงููุตูู ุฅูู ููุญุฉ ูุฑุงูุจุฉ

```bash
# ุงูุญุตูู ุนูู ุชูุงุตูู Application Insights
azd env get-values | grep APPLICATIONINSIGHTS

# ุงูุชุญ ูุฑุงูุจุฉ ุจูุงุจุฉ Azure
az monitor app-insights component show \
  --app $(azd env get-values | grep APPLICATIONINSIGHTS_CONNECTION_STRING | cut -d '=' -f2) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2) \
  --query "appId" -o tsv
```

### ุงูููุงููุณ ุงูุญูุฉ

1. ุงุฐูุจ ุฅูู Application Insights ูู ุจูุงุจุฉ Azure
2. ุงููุฑ ุนูู "Live Metrics"
3. ุดุงูุฏ ุงูุทูุจุงุชุ ุงูุฅุฎูุงูุงุชุ ูุงูุฃุฏุงุก ูู ุงูููุช ุงูุญูููู
4. ุงุฎุชุจุฑ ุจุชุดุบูู: `curl $(azd env get-values | grep API_GATEWAY_URL | cut -d '=' -f2 | tr -d '"')/api/products`

## ุชูุงุฑูู ุนูููุฉ

### ุงูุชูุฑูู 1: ุฅุถุงูุฉ ููุทุฉ ููุงูุฉ ููุชุฌ ุฌุฏูุฏุฉ โญ (ุณูู)

**ุงููุฏู**: ุฅุถุงูุฉ ููุทุฉ ููุงูุฉ POST ูุฅูุดุงุก ููุชุฌุงุช ุฌุฏูุฏุฉ

**ููุทุฉ ุงูุจุฏุก**: `src/product-service/main.py`

**ุงูุฎุทูุงุช**:

1. ุฃุถู ูุฐู ุงูููุทุฉ ุงูููุงุฆูุฉ ุจุนุฏ ุฏุงูุฉ `get_product` ูู `main.py`:

```python
@app.route('/products', methods=['POST'])
def create_product():
    """Create a new product"""
    data = request.get_json()
    
    # ุงูุชุญูู ูู ุงูุญููู ุงููุทููุจุฉ
    if not data or 'name' not in data or 'price' not in data:
        return jsonify({'error': 'Missing required fields: name, price'}), 400
    
    new_id = max(p['id'] for p in products) + 1
    new_product = {
        'id': new_id,
        'name': data['name'],
        'description': data.get('description', ''),
        'price': float(data['price']),
        'stock': int(data.get('stock', 0))
    }
    products.append(new_product)
    logger.info(f"Created product {new_id}")
    return jsonify(new_product), 201
```

2. ุฃุถู ูุณุงุฑ POST ุฅูู ุจูุงุจุฉ API (`src/api-gateway/app.js`):

```javascript
// ุฃุถู ูุฐุง ุจุนุฏ ูุณุงุฑ GET /api/products
app.post('/api/products', async (req, res) => {
  try {
    console.log(`Forwarding POST request to ${PRODUCT_SERVICE_URL}/products`);
    const response = await axios.post(`${PRODUCT_SERVICE_URL}/products`, req.body, {
      timeout: 5000
    });
    res.status(201).json(response.data);
  } catch (error) {
    console.error('Error calling product service:', error.message);
    res.status(503).json({
      error: 'Product service unavailable',
      message: error.message
    });
  }
});
```

3. ุฅุนุงุฏุฉ ูุดุฑ ุงูุฎุฏูุชูู:

```bash
azd deploy product-service
azd deploy api-gateway
```

4. ุงุฎุชุจุฑ ููุทุฉ ุงูููุงูุฉ ุงูุฌุฏูุฏุฉ:

```bash
GATEWAY_URL=$(azd env get-values | grep API_GATEWAY_URL | cut -d '=' -f2 | tr -d '"')

# ุฅูุดุงุก ููุชุฌ ุฌุฏูุฏ
curl -X POST $GATEWAY_URL/api/products \
  -H "Content-Type: application/json" \
  -d '{"name":"USB Cable","price":9.99,"stock":500}'
```

**โ ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ:**
```json
{"id":6,"name":"USB Cable","description":"","price":9.99,"stock":500}
```

5. ุชุญูู ูู ุธููุฑู ูู ุงููุงุฆูุฉ:

```bash
curl $GATEWAY_URL/api/products
# ูุฌุจ ุงูุขู ุนุฑุถ 6 ููุชุฌุงุชุ ุจูุง ูู ุฐูู ูุงุจู USB ุงูุฌุฏูุฏ
```

**ูุนุงููุฑ ุงููุฌุงุญ**:
- โ ูุนูุฏ ุทูุจ POST ุฑูุฒ ุงูุญุงูุฉ HTTP 201
- โ ูุธูุฑ ููุชุฌ ุฌุฏูุฏ ูู ูุงุฆูุฉ GET /api/products
- โ ุงูููุชุฌ ูู ูุนุฑู ูุชุฒุงูุฏ ุชููุงุฆููุง

**ุงูููุช**: 10-15 ุฏูููุฉ

---

### ุงูุชูุฑูู 2: ุชุนุฏูู ููุงุนุฏ ุงูุชุญุฌูู ุงูุชููุงุฆู โญโญ (ูุชูุณุท)

**ุงููุฏู**: ุชุบููุฑ ุฎุฏูุฉ ุงูููุชุฌุงุช ูุชุชูุณุน ุจุดูู ุฃูุซุฑ ุนุฏูุงููุฉ

**ููุทุฉ ุงูุจุฏุงูุฉ**: `infra/app/product-service.bicep`

**ุงูุฎุทูุงุช**:

1. ุงูุชุญ `infra/app/product-service.bicep` ูุงุจุญุซ ุนู ูุชูุฉ `scale` (ุญูุงูู ุงูุณุทุฑ 95)

2. ุบููุฑ ูู:
```bicep
scale: {
  minReplicas: 1
  maxReplicas: 10
  rules: [
    {
      name: 'http-scale-rule'
      http: {
        metadata: {
          concurrentRequests: '100'  // OLD
        }
      }
    }
  ]
}
```

ุฅูู:
```bicep
scale: {
  minReplicas: 2  // Always have 2 running
  maxReplicas: 20  // Allow more scaling
  rules: [
    {
      name: 'http-scale-rule'
      http: {
        metadata: {
          concurrentRequests: '20'  // Scale at lower threshold
        }
      }
    }
  ]
}
```

3. ุฃุนุฏ ูุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ:

```bash
azd up
```

4. ุชุญูู ูู ุชูููู ุงูุชุญุฌูู ุงูุฌุฏูุฏ:

```bash
az containerapp show \
  --name $(azd env get-values | grep PRODUCT_SERVICE | head -1 | cut -d '/' -f5) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --query "properties.template.scale" -o json
```

**โ ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ:**
```json
{
  "minReplicas": 2,
  "maxReplicas": 20,
  "rules": [...]
}
```

5. ุงุฎุชุจุฑ ุงูุชุญุฌูู ุงูุชููุงุฆู ูุน ุญูู:

```bash
# ุชูููุฏ ุทูุจุงุช ูุชุฒุงููุฉ
for i in {1..500}; do curl $GATEWAY_URL/api/products & done

# ุฑุงูุจ ุญุฏูุซ ุงูุชุญุฌูู ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุณุทุฑ ุฃูุงูุฑ Azure
az containerapp logs show --name product-service --resource-group $RG_NAME --follow
# ุงุจุญุซ ุนู: ุฃุญุฏุงุซ ุชุญุฌูู ุชุทุจููุงุช ุงูุญุงููุงุช
```

**ูุนุงููุฑ ุงููุฌุงุญ**:
- โ ุชุนูู ุฎุฏูุฉ ุงูููุชุฌุงุช ุฏุงุฆููุง ุนูู ุงูุฃูู ุจูุณุฎุชูู
- โ ุชุญุช ุงูุญููุ ุชุชูุณุน ุฅูู ุฃูุซุฑ ูู ูุณุฎุชูู
- โ ูุนุฑุถ Azure Portal ููุงุนุฏ ุงูุชุญุฌูู ุงูุฌุฏูุฏุฉ

**ุงูููุช**: 15-20 ุฏูููุฉ

---

### ุงูุชูุฑูู 3: ุฅุถุงูุฉ ุงุณุชุนูุงู ูุฑุงูุจุฉ ูุฎุตุต โญโญ (ูุชูุณุท)

**ุงููุฏู**: ุฅูุดุงุก ุงุณุชุนูุงู ูุฎุตุต ูู Application Insights ูุชุชุจุน ุฃุฏุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูููุชุฌ

**ุงูุฎุทูุงุช**:

1. ุงูุชูู ุฅูู Application Insights ูู Azure Portal:
   - ุงุฐูุจ ุฅูู Azure Portal
   - ุงุจุญุซ ุนู ูุฌููุนุฉ ุงูููุงุฑุฏ ุงูุฎุงุตุฉ ุจู (rg-microservices-*)
   - ุงููุฑ ุนูู ููุฑุฏ Application Insights

2. ุงููุฑ ุนูู "Logs" ูู ุงููุงุฆูุฉ ุงููุณุฑู

3. ุฃูุดุฆ ูุฐุง ุงูุงุณุชุนูุงู:

```kusto
requests
| where timestamp > ago(1h)
| where name contains "products"
| summarize 
    RequestCount = count(),
    AvgDuration = avg(duration),
    P95Duration = percentile(duration, 95),
    SuccessRate = 100.0 * countif(success == true) / count()
  by bin(timestamp, 5m)
| render timechart
```

4. ุงููุฑ ุนูู "Run" ูุชุดุบูู ุงูุงุณุชุนูุงู

5. ุงุญูุธ ุงูุงุณุชุนูุงู:
   - ุงููุฑ ุนูู "Save"
   - ุงูุงุณู: "ุฃุฏุงุก ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูููุชุฌ"
   - ุงููุฆุฉ: "ุงูุฃุฏุงุก"

6. ูู ุจุชูููุฏ ุญุฑูุฉ ุงุฎุชุจุงุฑ:

```bash
for i in {1..100}; do curl $GATEWAY_URL/api/products; sleep 1; done
```

7. ูู ุจุชุญุฏูุซ ุงูุงุณุชุนูุงู ูุฑุคูุฉ ุงูุจูุงูุงุช

**โ ุงููุฎุฑุฌุงุช ุงููุชููุนุฉ:**
- ูุฎุทุท ููุถุญ ุนุฏุฏ ุงูุทูุจุงุช ูุน ูุฑูุฑ ุงูููุช
- ูุชูุณุท ุงููุฏุฉ < 500ms
- ูุนุฏู ุงููุฌุงุญ = 100%
- ููุงุตู ุฒูููุฉ ููุฏุฉ 5 ุฏูุงุฆู

**ูุนุงููุฑ ุงููุฌุงุญ**:
- โ ูุธูุฑ ุงูุงุณุชุนูุงู ุฃูุซุฑ ูู 100 ุทูุจ
- โ ูุนุฏู ุงููุฌุงุญ 100%
- โ ูุชูุณุท ุงููุฏุฉ < 500ms
- โ ูุนุฑุถ ุงููุฎุทุท ููุงุตู ุฒูููุฉ ูุฏุชูุง 5 ุฏูุงุฆู

**ูุชูุฌุฉ ุงูุชุนูู**: ููู ููููุฉ ูุฑุงูุจุฉ ุฃุฏุงุก ุงูุฎุฏูุฉ ุจุงุณุชุฎุฏุงู ุงุณุชุนูุงูุงุช ูุฎุตุตุฉ

**ุงูููุช**: 10-15 ุฏูููุฉ

---

### ุงูุชูุฑูู 4: ุชูููุฐ ููุทู ุฅุนุงุฏุฉ ุงููุญุงููุฉ โญโญโญ (ูุชูุฏู)

**ุงููุฏู**: ุฅุถุงูุฉ ููุทู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุฅูู API Gateway ุนูุฏูุง ุชููู ุฎุฏูุฉ ุงูููุชุฌุงุช ุบูุฑ ูุชุงุญุฉ ูุคูุชูุง

**ููุทุฉ ุงูุจุฏุงูุฉ**: `src/api-gateway/app.js`

**ุงูุฎุทูุงุช**:

1. ุซุจูุช ููุชุจุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ:

```bash
cd src/api-gateway
npm install axios-retry --save
cd ../..
```

2. ุญุฏูุซ `src/api-gateway/app.js` (ุฃุถู ุจุนุฏ ุงุณุชูุฑุงุฏ axios):

```javascript
const axiosRetry = require('axios-retry');

// ุชูููู ููุทู ุฅุนุงุฏุฉ ุงููุญุงููุฉ
axiosRetry(axios, {
  retries: 3,
  retryDelay: (retryCount) => {
    return retryCount * 1000; // 1 ุซุ 2 ุซุ 3 ุซ
  },
  retryCondition: (error) => {
    // ุฃุนุฏ ุงููุญุงููุฉ ุนูุฏ ุฃุฎุทุงุก ุงูุดุจูุฉ ุฃู ุงุณุชุฌุงุจุงุช 5xx
    return axiosRetry.isNetworkOrIdempotentRequestError(error) ||
           (error.response && error.response.status >= 500);
  }
});

console.log('Retry logic configured: 3 retries with exponential backoff');
```

3. ุฃุนุฏ ูุดุฑ API Gateway:

```bash
azd deploy api-gateway
```

4. ุงุฎุชุจุฑ ุณููู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุจูุญุงูุงุฉ ูุดู ุงูุฎุฏูุฉ:

```bash
# ุถุจุท ูููุงุณ ุฎุฏูุฉ ุงูููุชุฌ ุฅูู 0 (ูุญุงูุงุฉ ูุดู)
az containerapp update \
  --name $(azd env get-values | grep PRODUCT_SERVICE | head -1 | cut -d '/' -f5) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --min-replicas 0 \
  --max-replicas 0

# ูุญุงููุฉ ุงููุตูู ุฅูู ุงูููุชุฌุงุช (ุณููุนุงุฏ ุงููุญุงููุฉ 3 ูุฑุงุช)
time curl -v $GATEWAY_URL/api/products
# ููุงุญุธุฉ: ุชุณุชุบุฑู ุงูุงุณุชุฌุงุจุฉ ุญูุงูู 6 ุซูุงูู (1 ุซ + 2 ุซ + 3 ุซ ูู ุงููุญุงููุงุช)

# ุงุณุชุนุงุฏุฉ ุฎุฏูุฉ ุงูููุชุฌ
az containerapp update \
  --name $(azd env get-values | grep PRODUCT_SERVICE | head -1 | cut -d '/' -f5) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --min-replicas 1 \
  --max-replicas 10
```

5. ุนุฑุถ ุณุฌูุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ:

```bash
az containerapp logs show --name api-gateway --resource-group $RG_NAME --tail 50
# ุงุจุญุซ ุนู: ุฑุณุงุฆู ูุญุงููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
```

**โ ุงูุณููู ุงููุชููุน:**
- ุชุญุงูู ุงูุทูุจุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ 3 ูุฑุงุช ูุจู ุงููุดู
- ุชูุชุธุฑ ูู ูุญุงููุฉ ุฅุนุงุฏุฉ ููุชุฑุฉ ุฃุทูู (1sุ 2sุ 3s)
- ุงูุทูุจุงุช ุชูุฌุญ ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ
- ุชูุธูุฑ ุงูุณุฌูุงุช ูุญุงููุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ

**ูุนุงููุฑ ุงููุฌุงุญ**:
- โ ุชุญุงูู ุงูุทูุจุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ 3 ูุฑุงุช ูุจู ุงููุดู
- โ ุชูุชุธุฑ ูู ูุญุงููุฉ ุฅุนุงุฏุฉ ุฃุทูู (ุชุฑุงุฌุน ุฃูุณูู)
- โ ุงูุทูุจุงุช ุชูุฌุญ ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ
- โ ุชูุธูุฑ ุงูุณุฌูุงุช ูุญุงููุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ

**ูุชูุฌุฉ ุงูุชุนูู**: ููู ุฃููุงุท ุงููุฑููุฉ ูู ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ (ููุงุทุน ุงูุฏุงุฆุฑุฉุ ุฅุนุงุฏุฉ ุงููุญุงููุฉุ ุงููููุงุช)

**ุงูููุช**: 20-25 ุฏูููุฉ

---

## ููุทุฉ ุงูุชุญูู ูู ุงููุนุฑูุฉ

ุจุนุฏ ุฅููุงู ูุฐุง ุงููุซุงูุ ุชุญูู ูู ูููู:

### 1. ุงูุงุชุตุงู ุจุงูุฎุฏูุงุช โ

ุงุฎุชุจุฑ ูุนุฑูุชู:
- [ ] ูู ููููู ุดุฑุญ ููู ููุชุดู API Gateway ุฎุฏูุฉ ุงูููุชุฌุงุชุ (ุงูุชุดุงู ุงูุฎุฏูุฉ ูุงุฆู ุนูู DNS)
- [ ] ูุงุฐุง ูุญุฏุซ ุฅุฐุง ูุงูุช ุฎุฏูุฉ ุงูููุชุฌุงุช ูุชูููุฉุ (ุชุนูุฏ ุงูุจูุงุจุฉ ุฎุทุฃ 503)
- [ ] ููู ุณุชุถูู ุฎุฏูุฉ ุซุงูุซุฉุ (ุฅูุดุงุก ููู Bicep ุฌุฏูุฏุ ุฅุถุงูุชู ุฅูู main.bicepุ ุฅูุดุงุก ูุฌูุฏ src)

**ุงูุชุญูู ุงูุนููู:**
```bash
# ูุญุงูุงุฉ ูุดู ุงูุฎุฏูุฉ
az containerapp update --name <product-service-name> --min-replicas 0 --max-replicas 0
curl $GATEWAY_URL/api/products
# โ ูุชููุน: 503 ุงูุฎุฏูุฉ ุบูุฑ ูุชุงุญุฉ

# ุงุณุชุนุงุฏุฉ ุงูุฎุฏูุฉ
az containerapp update --name <product-service-name> --min-replicas 1 --max-replicas 10
```

### 2. ุงููุฑุงูุจุฉ ูุงูููุงุญุธุฉ โ

ุงุฎุชุจุฑ ูุนุฑูุชู:
- [ ] ุฃูู ุชุฑู ุงูุณุฌูุงุช ุงูููุฒุนุฉุ (Application Insights ูู Azure Portal)
- [ ] ููู ุชุชุชุจุน ุงูุทูุจุงุช ุงูุจุทูุฆุฉุ (ุงุณุชุนูุงู Kusto: `requests | where duration > 1000`)
- [ ] ูู ููููู ุชุญุฏูุฏ ุฃู ุฎุฏูุฉ ุณุจุจุช ุงูุฎุทุฃุ (ุงูุญุต ุงูุญูู `cloud_RoleName` ูู ุงูุณุฌูุงุช)

**ุงูุชุญูู ุงูุนููู:**
```bash
# ุชูููุฏ ูุญุงูุงุฉ ูุทูุจ ุจุทูุก
curl "$GATEWAY_URL/api/products?delay=2000"

# ุฅุฌุฑุงุก ุงุณุชุนูุงู ูู Application Insights ุนู ุงูุทูุจุงุช ุงูุจุทูุฆุฉ
# ุงูุชูู ุฅูู ุจูุงุจุฉ Azure โ Application Insights โ ุงูุณุฌูุงุช
# ุดุบูู: requests | where duration > 1000 | project timestamp, name, duration, cloud_RoleName
```

### 3. ุงูุชุญุฌูู ูุงูุฃุฏุงุก โ

ุงุฎุชุจุฑ ูุนุฑูุชู:
- [ ] ูุง ุงูุฐู ูุทูู ุงูุชุญุฌูู ุงูุชููุงุฆูุ (ููุงุนุฏ ุงูุทูุจุงุช ุงููุชุฒุงููุฉ ุนุจุฑ HTTP: 50 ููุจูุงุจุฉุ 100 ููููุชุฌ)
- [ ] ูู ุนุฏุฏ ุงููุณุฎ ุงูุนุงููุฉ ุงูุขูุ (ุชุญูู ุจุงุณุชุฎุฏุงู `az containerapp revision list`)
- [ ] ููู ุณุชุฒูุฏ ุฎุฏูุฉ ุงูููุชุฌุงุช ุฅูู 5 ูุณุฎุ (ุญุฏูุซ minReplicas ูู Bicep)

**ุงูุชุญูู ุงูุนููู:**
```bash
# ุชูููุฏ ุญูู ูุงุฎุชุจุงุฑ ุงูุชุญุฌูู ุงูุชููุงุฆู
for i in {1..1000}; do curl $GATEWAY_URL/api/products & done

# ูุฑุงูุจุฉ ุฒูุงุฏุฉ ุงููุณุฎ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุณุทุฑ ุฃูุงูุฑ Azure
az containerapp logs show --name api-gateway --resource-group $RG_NAME --follow
# โ ุงููุชููุน: ุฑุคูุฉ ุฃุญุฏุงุซ ุงูุชุญุฌูู ูู ุงูุณุฌูุงุช
```

**ูุนุงููุฑ ุงููุฌุงุญ**: ููููู ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุงูุฃุณุฆูุฉ ูุงูุชุญูู ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ ุนูููุฉ.

---

## ุชุญููู ุงูุชูููุฉ

### ุงูุชูุงููู ุงูุดูุฑูุฉ ุงูููุฏุฑุฉ (ููุฐุง ุงููุซุงู ุงูููููู ูู ุฎุฏูุชูู)

| ุงูููุฑุฏ | ุงูุชูููู | ุงูุชูููุฉ ุงูููุฏุฑุฉ |
|----------|--------------|----------------|
| API Gateway | 2-20 replicas, 1 vCPU, 2GB RAM | $30-150 |
| ุฎุฏูุฉ ุงูููุชุฌุงุช | 1-10 replicas, 0.5 vCPU, 1GB RAM | $15-75 |
| Container Registry | Basic tier | $5 |
| Application Insights | 1-2 GB/month | $5-10 |
| Log Analytics | 1 GB/month | $3 |
| **ุงูุฅุฌูุงูู** | | **$58-243/month** |

### ุชูุตูู ุงูุชูููุฉ ุญุณุจ ุงูุงุณุชุฎุฏุงู

**ุญุฑูุฉ ูุฑูุฑ ุฎูููุฉ** (ุงุฎุชุจุงุฑ/ุชุนูู): ~$60/month
- API Gateway: 2 replicas ร 24/7 = $30
- ุฎุฏูุฉ ุงูููุชุฌุงุช: 1 replica ร 24/7 = $15
- ุงููุฑุงูุจุฉ + ุงูุณุฌู = $13

**ุญุฑูุฉ ูุฑูุฑ ูุนุชุฏูุฉ** (ุฅูุชุงุฌ ุตุบูุฑ): ~$120/month
- API Gateway: 5 avg replicas = $75
- ุฎุฏูุฉ ุงูููุชุฌุงุช: 3 avg replicas = $45
- ุงููุฑุงูุจุฉ + ุงูุณุฌู = $13

**ุญุฑูุฉ ูุฑูุฑ ุนุงููุฉ** (ูุชุฑุงุช ูุฒุฏุญูุฉ): ~$240/month
- API Gateway: 15 avg replicas = $225
- ุฎุฏูุฉ ุงูููุชุฌุงุช: 8 avg replicas = $120
- ุงููุฑุงูุจุฉ + ุงูุณุฌู = $13

### ูุตุงุฆุญ ุชุญุณูู ุงูุชูููุฉ

1. **ุงูุชุญุฌูู ุฅูู ุตูุฑ ุฃุซูุงุก ุงูุชุทููุฑ**:
   ```bicep
   scale: {
     minReplicas: 0  // Save $30-40/month when not in use
     maxReplicas: 10
   }
   ```

2. **ุงุณุชุฎุฏู ุฎุทุฉ ุงูุงุณุชููุงู ูู Cosmos DB** (ุนูุฏ ุฅุถุงูุชูุง):
   - ุงุฏูุน ููุท ููุงุจู ูุง ุชุณุชุฎุฏูู
   - ูุง ููุฌุฏ ุญุฏ ุฃุฏูู ููุฑุณูู

3. **ุงุถุจุท ุนูููุฉ Application Insights**:
   ```javascript
   appInsights.defaultClient.config.samplingPercentage = 50; // ุงุฎุชุฑ ุนููุฉ ูู 50ูช ูู ุงูุทูุจุงุช
   ```

4. **ูุธูู ุงูููุงุฑุฏ ุนูุฏ ุนุฏู ุงูุญุงุฌุฉ**:
   ```bash
   azd down --force --purge
   ```

### ุฎูุงุฑุงุช ุงูุทุจูุฉ ุงููุฌุงููุฉ

ููุชุนูู/ุงูุงุฎุชุจุงุฑุ ุถุน ูู ุงูุงุนุชุจุงุฑ:
- โ ุงุณุชุฎุฏู ุฃุฑุตุฏุฉ Azure ุงููุฌุงููุฉ ($200 ูุฃูู 30 ููููุง ููุญุณุงุจุงุช ุงูุฌุฏูุฏุฉ)
- โ ุงุญุชูุธ ุจุงูุญุฏ ุงูุฃุฏูู ูู ุงููุณุฎ (ูููุฑ ~50% ูู ุงูุชูููุฉ)
- โ ุงุญุฐู ุจุนุฏ ุงูุงุฎุชุจุงุฑ (ูุง ุชูุฌุฏ ุฑุณูู ูุณุชูุฑุฉ)
- โ ูู ุจุงูุชุญุฌูู ุฅูู ุตูุฑ ุจูู ุฌูุณุงุช ุงูุชุนูู

**ูุซุงู**: ุชุดุบูู ูุฐุง ุงููุซุงู 2 ุณุงุนุฉ/ุงูููู ร 30 ููู = ~$5/month ุจุฏูุงู ูู $60/month

---

## ูุฑุฌุน ุณุฑูุน ูุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง

### ุงููุดููุฉ: ูุดู `azd up` ูุน "Subscription not found"

**ุงูุญู**:
```bash
# ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู ุจุงุณุชุฎุฏุงู ุงุดุชุฑุงู ุตุฑูุญ
az account set --subscription <your-subscription-id>
azd env set AZURE_SUBSCRIPTION_ID <your-subscription-id>
azd up
```

### ุงููุดููุฉ: API Gateway ุชุนูุฏ 503 "Product service unavailable"

**ุงูุชุดุฎูุต**:
```bash
# ุงูุชุญูู ูู ุณุฌูุงุช ุฎุฏูุฉ ุงูููุชุฌ ุจุงุณุชุฎุฏุงู Azure CLI
az containerapp logs show --name product-service --resource-group $RG_NAME --tail 50

# ุงูุชุญูู ูู ุญุงูุฉ ุฎุฏูุฉ ุงูููุชุฌ
az containerapp show \
  --name $(azd env get-values | grep PRODUCT_SERVICE | head -1 | cut -d '/' -f5) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --query "properties.runningStatus"
```

**ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ**:
1. ุฎุฏูุฉ ุงูููุชุฌุงุช ูู ุชุจุฏุฃ (ุชุญูู ูู ุงูุณุฌูุงุช ูุฃุฎุทุงุก Python)
2. ูุดู ูุญุต ุงูุตุญุฉ (ุชุญูู ูู ุฃู ููุทุฉ ุงูููุงูุฉ `/health` ุชุนูู)
3. ูุดู ุจูุงุก ุตูุฑุฉ ุงูุญุงููุฉ (ุชุญูู ูู ุงูุณุฌู ุนู ุงูุตูุฑุฉ)

### ุงููุดููุฉ: ุงูุชุญุฌูู ุงูุชููุงุฆู ูุง ูุนูู

**ุงูุชุดุฎูุต**:
```bash
# ุชุญูู ูู ุนุฏุฏ ุงููุณุฎ ุงูุญุงููุฉ
az containerapp revision list \
  --name $(azd env get-values | grep API_GATEWAY | head -1 | cut -d '/' -f5) \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --query "[].properties.replicas"

# ุชูููุฏ ุญูู ููุงุฎุชุจุงุฑ
for i in {1..1000}; do curl $GATEWAY_URL/api/products & done

# ูุฑุงูุจุฉ ุฃุญุฏุงุซ ุงูุชูุณุน ุจุงุณุชุฎุฏุงู Azure CLI
az containerapp logs show --name api-gateway --resource-group $RG_NAME --follow | grep -i scale
```

**ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ**:
1. ุงูุญูู ุบูุฑ ูุงูู ูุชูุนูู ูุงุนุฏุฉ ุงูุชุญุฌูู (ุชุญุชุงุฌ >50 ุทูุจูุง ูุชุฒุงูููุง)
2. ุชู ุงููุตูู ุฅูู ุงูุญุฏ ุงูุฃูุตู ูููุณุฎ ุจุงููุนู (ุชุญูู ูู ุชูููู Bicep)
3. ูุงุนุฏุฉ ุงูุชุญุฌูู ูููููุฉ ุจุดูู ุฎุงุทุฆ ูู Bicep (ุชุญูู ูู ูููุฉ concurrentRequests)

### ุงููุดููุฉ: Application Insights ูุง ูุนุฑุถ ุงูุณุฌูุงุช

**ุงูุชุดุฎูุต**:
```bash
# ุชุญูู ูู ุชุนููู ุณูุณูุฉ ุงูุงุชุตุงู
azd env get-values | grep APPLICATIONINSIGHTS

# ุชุญูู ููุง ุฅุฐุง ูุงูุช ุงูุฎุฏูุงุช ุชุฑุณู ุจูุงูุงุช ุงูููุงุณ ุนู ุจูุนุฏ
az monitor app-insights component show \
  --app $(azd env get-values | grep APPLICATIONINSIGHTS_NAME | cut -d '=' -f2 | tr -d '"') \
  --resource-group $(azd env get-values | grep AZURE_RESOURCE_GROUP | cut -d '=' -f2 | tr -d '"') \
  --query "properties.InstrumentationKey"
```

**ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ**:
1. ูู ูุชู ุชูุฑูุฑ ุณูุณูุฉ ุงูุงุชุตุงู ุฅูู ุงูุญุงููุฉ (ุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ)
2. ูู ูุชู ุชูููู SDK ุงูุฎุงุต ุจู Application Insights (ุชุญูู ูู ุงูุงุณุชูุฑุงุฏุงุช ูู ุงูุดููุฑุฉ)
3. ุงูุฌุฏุงุฑ ุงููุงุฑู ูููุน ุจูุงูุงุช ุงูููุงุณ ุนู ุจูุนุฏ (ูุงุฏุฑุ ุชุญูู ูู ููุงุนุฏ ุงูุดุจูุฉ)

### ุงููุดููุฉ: ูุดู ุจูุงุก Docker ูุญูููุง

**ุงูุชุดุฎูุต**:
```bash
# ุงุฎุชุจุงุฑ ุจูุงุก ุจูุงุจุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช
cd src/api-gateway
docker build -t test-gateway .

# ุงุฎุชุจุงุฑ ุจูุงุก ุฎุฏูุฉ ุงูููุชุฌ
cd ../product-service
docker build -t test-product .
```

**ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ**:
1. ุชุจุนูุงุช ููููุฏุฉ ูู package.json/requirements.txt
2. ุฃุฎุทุงุก ูู ุตูุงุบุฉ Dockerfile
3. ูุดููุงุช ูู ุงูุดุจูุฉ ุนูุฏ ุชูุฒูู ุงูุชุจุนูุงุช

**ูุง ุฒูุช ุนุงูููุงุ** ุฑุงุฌุน [ุฏููู ุงููุดููุงุช ุงูุดุงุฆุนุฉ](../../docs/chapter-07-troubleshooting/common-issues.md) ุฃู [ุงุณุชูุดุงู ุฃุฎุทุงุก Azure Container Apps ูุฅุตูุงุญูุง](https://learn.microsoft.com/azure/container-apps/troubleshooting)

---

## ุงูุชูุธูู

ูุชุฌูุจ ุงูุฑุณูู ุงููุณุชูุฑุฉุ ุงุญุฐู ุฌููุน ุงูููุงุฑุฏ:

```bash
azd down --force --purge
```

**ููุฌู ุงูุชุฃููุฏ**:
```
? Total resources to delete: 6, are you sure you want to continue? (y/N)
```

ุงูุชุจ `y` ููุชุฃููุฏ.

**ูุง ุงูุฐู ุณูุชู ุญุฐูู**:
- ุจูุฆุฉ Container Apps
- ููุง ุชุทุจููู ุงูุญุงููุฉ (ุงูุจูุงุจุฉ ูุฎุฏูุฉ ุงูููุชุฌุงุช)
- ุณุฌู ุงูุญุงููุงุช
- Application Insights
- ูุณุงุญุฉ ุนูู Log Analytics
- ูุฌููุนุฉ ุงูููุงุฑุฏ

**โ ุงูุชุญูู ูู ุงูุชูุธูู**:
```bash
az group list --query "[?starts_with(name,'rg-microservices')]" --output table
```

ูุฌุจ ุฃู ููุฑุฌุน ูุงุฑุบูุง.

---

## ุฏููู ุงูุชูุณุน: ูู ุฎุฏูุชูู ุฅูู 5+ ุฎุฏูุงุช

ุจูุฌุฑุฏ ุฅุชูุงูู ูุจููุฉ ุงูุฎุฏูุชูู ูุฐูุ ุฅููู ููููุฉ ุงูุชูุณุน:

### ุงููุฑุญูุฉ 1: ุฅุถุงูุฉ ุงูุชุฎุฒูู ุงูุฏุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช (ุงูุฎุทูุฉ ุงูุชุงููุฉ)

**ุฅุถุงูุฉ Cosmos DB ูุฎุฏูุฉ ุงูููุชุฌุงุช**:

1. ุฃูุดุฆ `infra/core/cosmos.bicep`:
   ```bicep
   resource cosmosAccount 'Microsoft.DocumentDB/databaseAccounts@2023-04-15' = {
     name: name
     location: location
     kind: 'GlobalDocumentDB'
     properties: {
       databaseAccountOfferType: 'Standard'
       consistencyPolicy: { defaultConsistencyLevel: 'Session' }
       locations: [{ locationName: location, failoverPriority: 0 }]
     }
   }
   ```

2. ุญุฏูุซ ุฎุฏูุฉ ุงูููุชุฌุงุช ูุงุณุชุฎุฏุงู Azure Cosmos DB Python SDK ุจุฏูุงู ูู ุงูุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ

3. ุงูุชูููุฉ ุงูุฅุถุงููุฉ ุงูููุฏุฑุฉ: ~$25/month (ุจุฏูู ุฎุงุฏู)

### ุงููุฑุญูุฉ 2: ุฅุถุงูุฉ ุฎุฏูุฉ ุซุงูุซุฉ (ุฅุฏุงุฑุฉ ุงูุทูุจุงุช)

**ุฅูุดุงุก ุฎุฏูุฉ ุงูุทูุจุงุช**:

1. ูุฌูุฏ ุฌุฏูุฏ: `src/order-service/` (Python/Node.js/C#)
2. Bicep ุฌุฏูุฏ: `infra/app/order-service.bicep`
3. ุญุฏูุซ API Gateway ูุชูุฌูู `/api/orders`
4. ุฃุถู Azure SQL Database ูุชุฎุฒูู ุงูุทูุจุงุช ุจุดูู ุฏุงุฆู

**ุชุตุจุญ ุงูุจููุฉ**:
```
API Gateway โ Product Service (Cosmos DB)
           โ Order Service (Azure SQL)
```

### ุงููุฑุญูุฉ 3: ุฅุถุงูุฉ ุงูุงุชุตุงู ุงููุง ุชุฒุงููู (Service Bus)

**ุชูููุฐ ุจููุฉ ูุฏููุนุฉ ุจุงูุฃุญุฏุงุซ**:

1. ุฃุถู Azure Service Bus: `infra/core/servicebus.bicep`
2. ุชูุดุฑ ุฎุฏูุฉ ุงูููุชุฌุงุช ุฃุญุฏุงุซ "ProductCreated"
3. ุชุดุชุฑู ุฎุฏูุฉ ุงูุทูุจุงุช ูู ุฃุญุฏุงุซ ุงูููุชุฌ
4. ุฃุถู ุฎุฏูุฉ ุงูุฅุดุนุงุฑุงุช ููุนุงูุฌุฉ ุงูุฃุญุฏุงุซ

**ุงูููุท**: ุทูุจ/ุงุณุชุฌุงุจุฉ (HTTP) + ูุฏููุน ุจุงูุฃุญุฏุงุซ (Service Bus)

### ุงููุฑุญูุฉ 4: ุฅุถุงูุฉ ูุตุงุฏูุฉ ุงููุณุชุฎุฏู

**ุชูููุฐ ุฎุฏูุฉ ุงููุณุชุฎุฏู**:

1. ุฃูุดุฆ `src/user-service/` (Go/Node.js)
2. ุฃุถู Azure AD B2C ุฃู ูุตุงุฏูุฉ JWT ูุฎุตุตุฉ
3. ูููู API Gateway ุจุงูุชุญูู ูู ุงูุฑููุฒ ูุจู ุงูุชูุฌูู
4. ุชุชุญูู ุงูุฎุฏูุงุช ูู ุฃุฐููุงุช ุงููุณุชุฎุฏู

### ุงููุฑุญูุฉ 5: ุงูุงุณุชุนุฏุงุฏ ููุฅูุชุงุฌ

**ุฃุถู ูุฐู ุงูููููุงุช**:
- โ Azure Front Door (ููุงุฒูุฉ ุชุญููู ุนุงูููุฉ)
- โ Azure Key Vault (ุฅุฏุงุฑุฉ ุงูุฃุณุฑุงุฑ)
- โ Azure Monitor Workbooks (ููุญุงุช ุชุญูู ูุฎุตุตุฉ)
- โ ุฎุท ุฃูุงุจูุจ CI/CD (GitHub Actions)
- โ ูุดุฑ ุฃุฒุฑู-ุฃุฎุถุฑ
- โ Managed Identity ูุฌููุน ุงูุฎุฏูุงุช

**ุชูููุฉ ุงูุจููุฉ ุงููุงููุฉ ููุฅูุชุงุฌ**: ~$300-1,400/month

---

## ุงุนุฑู ุงููุฒูุฏ

### ุงููุซุงุฆู ุฐุงุช ุงูุตูุฉ
- [ุชูุซูู Azure Container Apps](https://learn.microsoft.com/azure/container-apps/)
- [ุฏููู ุจููุฉ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ](https://learn.microsoft.com/azure/architecture/guide/architecture-styles/microservices)
- [Application Insights ููุชุชุจุน ุงูููุฒุน](https://learn.microsoft.com/azure/azure-monitor/app/distributed-tracing)
- [ุชูุซูู Azure Developer CLI](https://learn.microsoft.com/azure/developer/azure-developer-cli/)

### ุงูุฎุทูุงุช ุงูุชุงููุฉ ูู ูุฐู ุงูุฏูุฑุฉ
- โ ุงูุณุงุจู: [ูุงุฌูุฉ Flask ุจุณูุทุฉ](../../../../examples/container-app/simple-flask-api) - ูุซุงู ูุจุชุฏุฆ ุจุงูุญุงููุฉ ุงููุงุญุฏุฉ
- โ ุงูุชุงูู: [ุฏููู ุฏูุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู](../../../../docs/ai-foundry) - ุฃุถู ูุฏุฑุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู
- ๐ [ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ููุฏูุฑุฉ](../../README.md)

### ุงูููุงุฑูุฉ: ูุชู ุชุณุชุฎุฏู ุฃู ุฎูุงุฑ

| ุงูููุฒุฉ | ุญุงููุฉ ูุงุญุฏุฉ | ุฎุฏูุงุช ูุตุบุฑุฉ (ูุฐู) | Kubernetes (AKS) |
|---------|-----------------|---------------------|------------------|
| ุญุงูุฉ ุงูุงุณุชุฎุฏุงู | ุชุทุจููุงุช ุจุณูุทุฉ | ุชุทุจููุงุช ูุนูุฏุฉ | ุชุทุจููุงุช ุนูู ูุณุชูู ุงููุคุณุณุงุช |
| ูุงุจููุฉ ุงูุชูุณุน | ุฎุฏูุฉ ูุงุญุฏุฉ | ุชุญุฌูู ููู ุฎุฏูุฉ | ุฃูุตู ุฏุฑุฌุงุช ุงููุฑููุฉ |
| ุงูุชุนููุฏ | ููุฎูุถ | ูุชูุณุท | ูุฑุชูุน |
| ุญุฌู ุงููุฑูู | 1-3 ูุทูุฑูู | 3-10 ูุทูุฑูู | 10+ ูุทูุฑูู |
| ุงูุชูููุฉ | ~$15-50/month | ~$60-250/month | ~$150-500/month |
| ุฒูู ุงููุดุฑ | 5-10 minutes | 8-12 minutes | 15-30 minutes
| **ููุงุณุจ ูู** | MVPsุ ุงูููุงุฐุฌ ุงูุฃูููุฉ | ุชุทุจููุงุช ุงูุฅูุชุงุฌ | ูุชุนุฏุฏ ุงูุณุญุงุจุงุชุ ุงูุดุจูุงุช ุงููุชูุฏูุฉ |

**ุงูุชูุตูุฉ**: ุงุจุฏุฃ ุจู Container Apps (ูุฐุง ุงููุซุงู)ุ ุงูุชูู ุฅูู AKS ููุท ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ููุฒุงุช ุฎุงุตุฉ ุจู Kubernetes.

---

## ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

**ุณ: ููุงุฐุง ุฎุฏูุชุงู ููุท ุจุฏููุง ูู 5+ุ**  
ุฌ: ุชูุฏู ุชุนูููู. ุงุชูู ุงูุฃุณุงุณูุงุช (ุงูุงุชุตุงู ุจูู ุงูุฎุฏูุงุชุ ุงููุฑุงูุจุฉุ ุงูุชุญุฌูู) ุจูุซุงู ุจุณูุท ูุจู ุฅุถุงูุฉ ุงูุชุนููุฏ. ุงูุฃููุงุท ุงูุชู ุชุชุนูููุง ููุง ุชูุทุจู ุนูู ูุนูุงุฑูุงุช ุชุชููู ูู 100 ุฎุฏูุฉ.

**ุณ: ูู ูููููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุฎุฏูุงุช ุจููุณูุ**  
ุฌ: ุจุงูุชุฃููุฏ! ุงุชุจุน ุฏููู ุงูุชูุณูุน ุฃุนูุงู. ูู ุฎุฏูุฉ ุฌุฏูุฏุฉ ุชุชุจุน ููุณ ุงูููุท: ุฃูุดุฆ ูุฌูุฏ srcุ ุฃูุดุฆ ููู Bicepุ ุญุฏูุซ azure.yamlุ ุซู ุงูุดุฑ.

**ุณ: ูู ูุฐุง ุฌุงูุฒ ููุฅูุชุงุฌุ**  
ุฌ: ุฅูู ุฃุณุงุณ ููู. ููุฅูุชุงุฌุ ุฃุถู: managed identityุ Key Vaultุ ููุงุนุฏ ุจูุงูุงุช ุฏุงุฆูุฉุ ุฎุท ุฃูุงุจูุจ CI/CDุ ุชูุจููุงุช ุงููุฑุงูุจุฉุ ูุงุณุชุฑุงุชูุฌูุฉ ูุณุฎ ุงุญุชูุงุทู.

**ุณ: ููุงุฐุง ูุง ูุณุชุฎุฏู Dapr ุฃู ุดุจูุฉ ุฎุฏูุงุช ุฃุฎุฑูุ**  
ุฌ: ุงุฌุนู ุงูุฃูุฑ ุจุณูุทูุง ููุชุนููู. ุจูุฌุฑุฏ ุฃู ุชููู ุงูุดุจูุงุช ุงูุฃุตููุฉ ูู Container Appsุ ููููู ุฅุถุงูุฉ Dapr ูุญุงูุงุช ูุชูุฏูุฉ (ุฅุฏุงุฑุฉ ุงูุญุงูุฉุ ุงููุดุฑ/ุงูุงุดุชุฑุงูุ ุงูุฑุจุท).

**ุณ: ููู ุฃููู ุจุชุตุญูุญ ุงูุฃุฎุทุงุก ูุญูููุงุ**  
ุฌ: ูู ุจุชุดุบูู ุงูุฎุฏูุงุช ูุญูููุง ุจุงุณุชุฎุฏุงู Docker:  
```bash
cd src/api-gateway
docker build -t local-gateway .
docker run -p 8080:8080 -e PRODUCT_SERVICE_URL=http://localhost:8000 local-gateway
```

**ุณ: ูู ูููููู ุงุณุชุฎุฏุงู ูุบุงุช ุจุฑูุฌุฉ ูุฎุชููุฉุ**  
ุฌ: ูุนู! ููุธูุฑ ูุฐุง ุงููุซุงู Node.js (ุงูุจูุงุจุฉ) + Python (ุฎุฏูุฉ ุงูููุชุฌ). ููููู ุฎูุท ุฃู ูุบุงุช ุชุนูู ุฏุงุฎู ุญุงููุงุช: C#ุ Goุ Javaุ Rubyุ PHPุ ุฅูุฎ.

**ุณ: ูุงุฐุง ูู ูู ุชูู ูุฏู ุฃุฑุตุฏุฉ Azureุ**  
ุฌ: ุงุณุชุฎุฏู ุงููุณุชูู ุงููุฌุงูู ูู Azure (ุงูุฃูุงู ุงูุซูุงุซูู ุงูุฃููู ููุญุณุงุจุงุช ุงูุฌุฏูุฏุฉ ุชุญุตู ุนูู $200 ุฃุฑุตุฏุฉ) ุฃู ุงูุดุฑ ููุงุฎุชุจุงุฑ ููุชุฑุงุช ูุตูุฑุฉ ุซู ุงุญุฐู ููุฑุง. ุชูููุชู ูู ูุฐุง ุงููุซุงู ุชูุฑูุจูุง ~$2/ููู.

**ุณ: ูุง ุงููุฑู ุจูู ูุฐุง ู Azure Kubernetes Service (AKS)ุ**  
ุฌ: Container Apps ุฃุจุณุท (ูุง ุญุงุฌุฉ ููุนุฑูุฉ Kubernetes) ูููู ุฃูู ูุฑููุฉ. ูููุญู AKS ุชุญูููุง ูุงููุงู ูู Kubernetes ูููู ูุชุทูุจ ุฎุจุฑุฉ ุฃูุจุฑ. ุงุจุฏุฃ ุจู Container Appsุ ุซู ุงูุชูู ุฅูู AKS ุฅุฐุง ูุฒู ุงูุฃูุฑ.

**ุณ: ูู ูููููู ุงุณุชุฎุฏุงู ูุฐุง ูุน ุฎุฏูุงุช Azure ุงูููุฌูุฏุฉุ**  
ุฌ: ูุนู! ููููู ุงูุงุชุตุงู ุจููุงุนุฏ ุจูุงูุงุช ููุฌูุฏุฉุ ุญุณุงุจุงุช ุงูุชุฎุฒููุ Service Busุ ุฅูุฎ. ุญุฏูุซ ูููุงุช Bicep ููุฅุดุงุฑุฉ ุฅูู ุงูููุงุฑุฏ ุงูููุฌูุฏุฉ ุจุฏูุงู ูู ุฅูุดุงุก ููุงุฑุฏ ุฌุฏูุฏุฉ.

---

> **๐ ููุฎุต ูุณุงุฑ ุงูุชุนูู**: ููุฏ ุชุนูููุช ูุดุฑ ุจููุฉ ูุชุนุฏุฏุฉ ุงูุฎุฏูุงุช ูุน ุงูุชุญุฌูู ุงูุชููุงุฆูุ ุงูุดุจูุงุช ุงูุฏุงุฎููุฉุ ุงููุฑุงูุจุฉ ุงููุฑูุฒูุฉุ ูุฃููุงุท ุฌุงูุฒุฉ ููุฅูุชุงุฌ. ูุฐุง ุงูุฃุณุงุณ ูุฌููุฒู ูุฃูุธูุฉ ููุฒุนุฉ ูุนูุฏุฉ ููุนูุงุฑูุงุช ูุงููุฑูุฎุฏูุงุช ูููุคุณุณุงุช.

**๐ ุชููู ุงูููุฑุฑ:**
- โ ุงูุณุงุจู: [Simple Flask API](../../../../examples/container-app/simple-flask-api)
- โ ุงูุชุงูู: [Database Integration Example](../../../../database-app)
- ๐ [ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ููุฏูุฑุฉ](../../README.md)
- ๐ [ุฃูุถู ููุงุฑุณุงุช Container Apps](../../docs/chapter-04-infrastructure/deployment-guide.md)

---

**โจ ุชูุงูููุง!** ููุฏ ุฃูููุช ูุซุงู ุงููุงููุฑูุณูุฑููุณ. ุฃูุช ุงูุขู ุชููู ููููุฉ ุจูุงุก ููุดุฑ ููุฑุงูุจุฉ ุงูุชุทุจููุงุช ุงูููุฒุนุฉ ุนูู Azure Container Apps. ูู ุฃูุช ูุณุชุนุฏ ูุฅุถุงูุฉ ูุฏุฑุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนูุ ุงุทูุน ุนูู [ุฏููู ุฏูุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู](../../../../docs/ai-foundry)!

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
ุฅุฎูุงุก ุงููุณุคูููุฉ:
ุชูุช ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุงูุขููุฉ Co-op Translator (https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ุฅูู ุงูุฏูุฉุ ููุฑุฌู ููุงุญุธุฉ ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ุนุฏู ุฏูุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงููุนุชูุฏ. ูููุนูููุงุช ุงูุญุฑุฌุฉุ ูููุตุญ ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ูุญุชุฑูุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑ ููุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->