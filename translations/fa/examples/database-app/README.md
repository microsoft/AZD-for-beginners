# ุงุณุชูุฑุงุฑ ฺฉ ูพุงฺฏุงู ุฏุงุฏู Microsoft SQL ู ุจุฑูุงูู ูุจ ุจุง AZD

โฑ๏ธ **ุฒูุงู ุชุฎูู**: ฒฐ-ณฐ ุฏููู | ๐ฐ **ูุฒูู ุชุฎูู**: ุญุฏูุฏ ฑต-ฒต ุฏูุงุฑ ุฏุฑ ูุงู | โญ **ูพฺุฏฺฏ**: ูุชูุณุท

ุงู **ูุซุงู ฺฉุงูู ู ุนูู** ูุดุงู ูโุฏูุฏ ฺฉู ฺฺฏููู ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ [Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/) ฺฉ ุจุฑูุงูู ูุจ Python Flask ุฑุง ููุฑุงู ุจุง ูพุงฺฏุงู ุฏุงุฏู Microsoft SQL ุฏุฑ Azure ูุณุชูุฑ ฺฉูุฏ. ุชูุงู ฺฉุฏูุง ุดุงูู ุดุฏู ู ุชุณุช ุดุฏูโุงูุฏโุจุฏูู ูุงุฒ ุจู ูุงุจุณุชฺฏโูุง ุฎุงุฑุฌ.

## ุขูฺู ุงุฏ ุฎูุงูุฏ ฺฏุฑูุช

ุจุง ุชฺฉูู ุงู ูุซุงูุ ุดูุง:
- ฺฉ ุจุฑูุงูู ฺูุฏ ูุงู (ุจุฑูุงูู ูุจ + ูพุงฺฏุงู ุฏุงุฏู) ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฒุฑุณุงุฎุช ุจู ุนููุงู ฺฉุฏ ูุณุชูุฑ ุฎูุงูุฏ ฺฉุฑุฏ
- ุงุชุตุงูุงุช ุงูู ูพุงฺฏุงู ุฏุงุฏู ุฑุง ุจุฏูู ุณุฎุชโฺฉุฏููุณ ุงุณุฑุงุฑ ูพฺฉุฑุจูุฏ ุฎูุงูุฏ ฺฉุฑุฏ
- ุณูุงูุช ุจุฑูุงูู ุฑุง ุจุง Application Insights ูุธุงุฑุช ุฎูุงูุฏ ฺฉุฑุฏ
- ููุงุจุน Azure ุฑุง ุจู ุทูุฑ ูุคุซุฑ ุจุง AZD CLI ูุฏุฑุช ุฎูุงูุฏ ฺฉุฑุฏ
- ุจูุชุฑู ุดููโูุง Azure ุฑุง ุจุฑุง ุงููุชุ ุจูููโุณุงุฒ ูุฒูู ู ูุดุงูุฏูโูพุฐุฑ ุฏูุจุงู ุฎูุงูุฏ ฺฉุฑุฏ

## ููุง ฺฉู ุณูุงุฑู
- **ุจุฑูุงูู ูุจ**: API REST Python Flask ุจุง ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู
- **ูพุงฺฏุงู ุฏุงุฏู**: ูพุงฺฏุงู ุฏุงุฏู Azure SQL ุจุง ุฏุงุฏูโูุง ููููู
- **ุฒุฑุณุงุฎุช**: ุจุง ุงุณุชูุงุฏู ุงุฒ Bicep (ูุงูุจโูุง ูุงฺููุงุฑ ู ูุงุจู ุงุณุชูุงุฏู ูุฌุฏุฏ) ูุฑุงูู ุดุฏู ุงุณุช
- **ุงุณุชูุฑุงุฑ**: ฺฉุงููุงู ุฎูุฏฺฉุงุฑ ุจุง ุฏุณุชูุฑุงุช `azd`
- **ูุธุงุฑุช**: Application Insights ุจุฑุง ฺฏุฒุงุฑุดโูุง ู ุชููโูุชุฑ

## ูพุดโูุงุฒูุง

### ุงุจุฒุงุฑูุง ููุฑุฏ ูุงุฒ

ูุจู ุงุฒ ุดุฑูุนุ ูุทูุฆู ุดูุฏ ฺฉู ุงู ุงุจุฒุงุฑูุง ูุตุจ ุดุฏูโุงูุฏ:

1. **[Azure CLI](https://learn.microsoft.com/cli/azure/install-azure-cli)** (ูุณุฎู ฒ.ตฐ.ฐ ุง ุจุงูุงุชุฑ)
   ```sh
   az --version
   # ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ: azure-cli ูุณุฎู 2.50.0 ุง ุจุงูุงุชุฑ
   ```

2. **[Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd)** (ูุณุฎู ฑ.ฐ.ฐ ุง ุจุงูุงุชุฑ)
   ```sh
   azd version
   # ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ: ูุณุฎู azd 1.0.0 ุง ุจุงูุงุชุฑ
   ```

3. **[Python 3.8+](https://www.python.org/downloads/)** (ุจุฑุง ุชูุณุนู ูุญู)
   ```sh
   python --version
   # ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ: ูพุงุชูู ณ.ธ ุง ุจุงูุงุชุฑ
   ```

4. **[Docker](https://www.docker.com/get-started)** (ุงุฎุชุงุฑุ ุจุฑุง ุชูุณุนู ูุญู ฺฉุงูุชูุฑ)
   ```sh
   docker --version
   # ุฎุฑูุฌ ููุฑุฏ ุงูุชุธุงุฑ: ูุณุฎู ุฏุงฺฉุฑ 20.10 ุง ุจุงูุงุชุฑ
   ```

### ุงูุฒุงูุงุช Azure

- ฺฉ **ุงุดุชุฑุงฺฉ ูุนุงู Azure** ([ุงุฌุงุฏ ุญุณุงุจ ุฑุงฺฏุงู](https://azure.microsoft.com/free/))
- ูุฌูุฒ ุจุฑุง ุงุฌุงุฏ ููุงุจุน ุฏุฑ ุงุดุชุฑุงฺฉ ุดูุง
- ููุด **Owner** ุง **Contributor** ุฏุฑ ุงุดุชุฑุงฺฉ ุง ฺฏุฑูู ููุงุจุน

### ูพุดโูุงุฒูุง ุฏุงูุด

ุงู ฺฉ ูุซุงู **ุณุทุญ ูุชูุณุท** ุงุณุช. ุดูุง ุจุงุฏ ุจุง ููุงุฑุฏ ุฒุฑ ุขุดูุง ุจุงุดุฏ:
- ุนููุงุช ูพุงู ุฎุท ูุฑูุงู
- ููุงูู ูพุงู ุงุจุฑ (ููุงุจุนุ ฺฏุฑููโูุง ููุงุจุน)
- ุฏุฑฺฉ ูพุงูโุง ุงุฒ ุจุฑูุงููโูุง ูุจ ู ูพุงฺฏุงู ุฏุงุฏูโูุง

**ุชุงุฒูโูุงุฑุฏ ุจู AZDุ** ุงุจุชุฏุง ุจุง [ุฑุงูููุง ุดุฑูุน](../../docs/getting-started/azd-basics.md) ุดุฑูุน ฺฉูุฏ.

## ูุนูุงุฑ

ุงู ูุซุงู ฺฉ ูุนูุงุฑ ุฏู ูุงู ุจุง ฺฉ ุจุฑูุงูู ูุจ ู ูพุงฺฏุงู ุฏุงุฏู SQL ุฑุง ูุณุชูุฑ ูโฺฉูุฏ:

```
โโโโโโโโโโโโโโโโโโโ        โโโโโโโโโโโโโโโโโโโโโโโโ
โ  User Browser   โโโโโโโโโบโ   Azure Web App      โ
โโโโโโโโโโโโโโโโโโโ        โ   (Flask API)        โ
                           โ   - /health          โ
                           โ   - /products        โ
                           โโโโโโโโโโโโฌโโโโโโโโโโโโ
                                      โ
                                      โ Secure Connection
                                      โ (Encrypted)
                                      โ
                           โโโโโโโโโโโโผโโโโโโโโโโโโ
                           โ Azure SQL Database   โ
                           โ   - Products table   โ
                           โ   - Sample data      โ
                           โโโโโโโโโโโโโโโโโโโโโโโโ
```

**ุงุณุชูุฑุงุฑ ููุงุจุน:**
- **ฺฏุฑูู ููุงุจุน**: ุธุฑู ุจุฑุง ุชูุงู ููุงุจุน
- **App Service Plan**: ูุฒุจุงู ูุจุชู ุจุฑ ูููฺฉุณ (ูุงู B1 ุจุฑุง ุตุฑููโุฌู ุฏุฑ ูุฒูู)
- **ุจุฑูุงูู ูุจ**: ูุญุท ุงุฌุฑุง Python 3.11 ุจุง ุจุฑูุงูู Flask
- **SQL Server**: ุณุฑูุฑ ูพุงฺฏุงู ุฏุงุฏู ูุฏุฑุช ุดุฏู ุจุง ุญุฏุงูู TLS 1.2
- **SQL Database**: ูุงู ูพุงู (ฒ ฺฏฺฏุงุจุงุชุ ููุงุณุจ ุจุฑุง ุชูุณุนู/ุขุฒูุงุด)
- **Application Insights**: ูุธุงุฑุช ู ฺฏุฒุงุฑุดโุฏู
- **Log Analytics Workspace**: ุฐุฎุฑูโุณุงุฒ ูุชูุฑฺฉุฒ ฺฏุฒุงุฑุดโูุง

**ุชุดุจู**: ุงู ุฑุง ูุงููุฏ ฺฉ ุฑุณุชูุฑุงู (ุจุฑูุงูู ูุจ) ุจุง ฺฉ ูุฑุฒุฑ ุจุฒุฑฺฏ (ูพุงฺฏุงู ุฏุงุฏู) ุชุตูุฑ ฺฉูุฏ. ูุดุชุฑุงู ุงุฒ ููู (ููุงุท ูพุงุงู API) ุณูุงุฑุด ูโุฏููุฏ ู ุขุดูพุฒุฎุงูู (ุจุฑูุงูู Flask) ููุงุฏ ุงููู (ุฏุงุฏูโูุง) ุฑุง ุงุฒ ูุฑุฒุฑ ุฏุฑุงูุช ูโฺฉูุฏ. ูุฏุฑ ุฑุณุชูุฑุงู (Application Insights) ููู ฺุฒ ุฑุง ฺฉู ุงุชูุงู ูโุงูุชุฏ ุฑุฏุงุจ ูโฺฉูุฏ.

## ุณุงุฎุชุงุฑ ูพูุดู

ุชูุงู ูุงูโูุง ุฏุฑ ุงู ูุซุงู ฺฏูุฌุงูุฏู ุดุฏูโุงูุฏโุจุฏูู ูุงุฒ ุจู ูุงุจุณุชฺฏโูุง ุฎุงุฑุฌ:

```
examples/database-app/
โ
โโโ README.md                    # This file
โโโ azure.yaml                   # AZD configuration file
โโโ .env.sample                  # Sample environment variables
โโโ .gitignore                   # Git ignore patterns
โ
โโโ infra/                       # Infrastructure as Code (Bicep)
โ   โโโ main.bicep              # Main orchestration template
โ   โโโ abbreviations.json      # Azure naming conventions
โ   โโโ resources/              # Modular resource templates
โ       โโโ sql-server.bicep    # SQL Server configuration
โ       โโโ sql-database.bicep  # Database configuration
โ       โโโ app-service-plan.bicep  # Hosting plan
โ       โโโ app-insights.bicep  # Monitoring setup
โ       โโโ web-app.bicep       # Web application
โ
โโโ src/
    โโโ web/                    # Application source code
        โโโ app.py              # Flask REST API
        โโโ requirements.txt    # Python dependencies
        โโโ Dockerfile          # Container definition
```

**ูุธูู ูุฑ ูุงู:**
- **azure.yaml**: ุจู AZD ูโฺฏูุฏ ฺู ฺุฒ ุฑุง ูุณุชูุฑ ฺฉูุฏ ู ฺฉุฌุง
- **infra/main.bicep**: ุชูุงู ููุงุจุน Azure ุฑุง ููุงููฺฏ ูโฺฉูุฏ
- **infra/resources/*.bicep**: ุชุนุฑูโูุง ููุงุจุน ุฌุฏุงฺฏุงูู (ูุงฺููุงุฑ ุจุฑุง ุงุณุชูุงุฏู ูุฌุฏุฏ)
- **src/web/app.py**: ุจุฑูุงูู Flask ุจุง ููุทู ูพุงฺฏุงู ุฏุงุฏู
- **requirements.txt**: ูุงุจุณุชฺฏโูุง ุจุณุชู Python
- **Dockerfile**: ุฏุณุชูุฑุงูุนููโูุง ฺฉุงูุชูุฑ ุจุฑุง ุงุณุชูุฑุงุฑ

## ุดุฑูุน ุณุฑุน (ฺฏุงู ุจู ฺฏุงู)

### ฺฏุงู ฑ: ฺฉููู ู ูพูุงุด

```sh
git clone https://github.com/microsoft/AZD-for-beginners.git
cd AZD-for-beginners/examples/database-app
```

**โ ุจุฑุฑุณ ููููุช**: ูุทูุฆู ุดูุฏ ฺฉู `azure.yaml` ู ูพูุดู `infra/` ุฑุง ูโุจูุฏ:
```sh
ls
# ุงูุชุธุงุฑ ูโุฑูุฏ: README.mdุ azure.yamlุ infra/ุ src/
```

### ฺฏุงู ฒ: ุงุญุฑุงุฒ ููุช ุจุง Azure

```sh
azd auth login
```

ุงู ูุฑูุฑฺฏุฑ ุดูุง ุฑุง ุจุฑุง ุงุญุฑุงุฒ ููุช Azure ุจุงุฒ ูโฺฉูุฏ. ุจุง ุงุนุชุจุงุฑูุงููโูุง Azure ุฎูุฏ ูุงุฑุฏ ุดูุฏ.

**โ ุจุฑุฑุณ ููููุช**: ุจุงุฏ ุจุจูุฏ:
```
Logged in to Azure.
```

### ฺฏุงู ณ: ููุฏุงุฑุฏู ุงููู ูุญุท

```sh
azd init
```

**ฺู ุงุชูุงู ูโุงูุชุฏ**: AZD ฺฉ ูพฺฉุฑุจูุฏ ูุญู ุจุฑุง ุงุณุชูุฑุงุฑ ุดูุง ุงุฌุงุฏ ูโฺฉูุฏ.

**ููุงุฑุฏ ฺฉู ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏ**:
- **ูุงู ูุญุท**: ฺฉ ูุงู ฺฉูุชุงู ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู `dev`ุ `myapp`)
- **ุงุดุชุฑุงฺฉ Azure**: ุงุดุชุฑุงฺฉ ุฎูุฏ ุฑุง ุงุฒ ูุณุช ุงูุชุฎุงุจ ฺฉูุฏ
- **ูููุนุช Azure**: ฺฉ ููุทูู ุงูุชุฎุงุจ ฺฉูุฏ (ูุซูุงู `eastus`ุ `westeurope`)

**โ ุจุฑุฑุณ ููููุช**: ุจุงุฏ ุจุจูุฏ:
```
SUCCESS: New project initialized!
```

### ฺฏุงู ด: ูุฑุงูู ฺฉุฑุฏู ููุงุจุน Azure

```sh
azd provision
```

**ฺู ุงุชูุงู ูโุงูุชุฏ**: AZD ุชูุงู ุฒุฑุณุงุฎุชโูุง ุฑุง ูุณุชูุฑ ูโฺฉูุฏ (ต-ธ ุฏููู ุทูู ูโฺฉุดุฏ):
1. ุงุฌุงุฏ ฺฏุฑูู ููุงุจุน
2. ุงุฌุงุฏ SQL Server ู ูพุงฺฏุงู ุฏุงุฏู
3. ุงุฌุงุฏ App Service Plan
4. ุงุฌุงุฏ ุจุฑูุงูู ูุจ
5. ุงุฌุงุฏ Application Insights
6. ูพฺฉุฑุจูุฏ ุดุจฺฉู ู ุงููุช

**ุงุฒ ุดูุง ุฎูุงุณุชู ูโุดูุฏ**:
- **ูุงู ฺฉุงุฑุจุฑ ูุฏุฑ SQL**: ฺฉ ูุงู ฺฉุงุฑุจุฑ ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู `sqladmin`)
- **ุฑูุฒ ุนุจูุฑ ูุฏุฑ SQL**: ฺฉ ุฑูุฒ ุนุจูุฑ ูู ูุงุฑุฏ ฺฉูุฏ (ุงู ุฑุง ุฐุฎุฑู ฺฉูุฏ!)

**โ ุจุฑุฑุณ ููููุช**: ุจุงุฏ ุจุจูุฏ:
```
SUCCESS: Your application was provisioned in Azure in X minutes Y seconds.
You can view the resources created under the resource group rg-<env-name> in Azure Portal:
https://portal.azure.com/#@/resource/subscriptions/.../resourceGroups/rg-<env-name>
```

**โฑ๏ธ ุฒูุงู**: ต-ธ ุฏููู

### ฺฏุงู ต: ุงุณุชูุฑุงุฑ ุจุฑูุงูู

```sh
azd deploy
```

**ฺู ุงุชูุงู ูโุงูุชุฏ**: AZD ุจุฑูุงูู Flask ุดูุง ุฑุง ูโุณุงุฒุฏ ู ูุณุชูุฑ ูโฺฉูุฏ:
1. ุจุณุชูโุจูุฏ ุจุฑูุงูู Python
2. ุณุงุฎุช ฺฉุงูุชูุฑ Docker
3. ุงุฑุณุงู ุจู ุจุฑูุงูู ูุจ Azure
4. ููุฏุงุฑุฏู ุงููู ูพุงฺฏุงู ุฏุงุฏู ุจุง ุฏุงุฏูโูุง ููููู
5. ุฑุงูโุงูุฏุงุฒ ุจุฑูุงูู

**โ ุจุฑุฑุณ ููููุช**: ุจุงุฏ ุจุจูุฏ:
```
SUCCESS: Your application was deployed to Azure in X minutes Y seconds.
You can view the resources created under the resource group rg-<env-name> in Azure Portal:
https://portal.azure.com/#@/resource/subscriptions/.../resourceGroups/rg-<env-name>
```

**โฑ๏ธ ุฒูุงู**: ณ-ต ุฏููู

### ฺฏุงู ถ: ูุฑูุฑ ุจุฑูุงูู

```sh
azd browse
```

ุงู ุจุฑูุงูู ูุจ ูุณุชูุฑ ุดุฏู ุดูุง ุฑุง ุฏุฑ ูุฑูุฑฺฏุฑ ุจุงุฒ ูโฺฉูุฏ ุฏุฑ `https://app-<unique-id>.azurewebsites.net`

**โ ุจุฑุฑุณ ููููุช**: ุจุงุฏ ุฎุฑูุฌ JSON ุฑุง ุจุจูุฏ:
```json
{
  "message": "Welcome to the Database App API",
  "endpoints": {
    "/": "This help message",
    "/health": "Health check endpoint",
    "/products": "List all products",
    "/products/<id>": "Get product by ID"
  }
}
```

### ฺฏุงู ท: ุชุณุช ููุงุท ูพุงุงู API

**ุจุฑุฑุณ ุณูุงูุช** (ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู ุฑุง ุชุฃุฏ ฺฉูุฏ):
```sh
curl https://app-<your-id>.azurewebsites.net/health
```

**ูพุงุณุฎ ููุฑุฏ ุงูุชุธุงุฑ**:
```json
{
  "status": "healthy",
  "database": "connected"
}
```

**ูุณุช ูุญุตููุงุช** (ุฏุงุฏูโูุง ููููู):
```sh
curl https://app-<your-id>.azurewebsites.net/products
```

**ูพุงุณุฎ ููุฑุฏ ุงูุชุธุงุฑ**:
```json
[
  {
    "id": 1,
    "name": "Laptop",
    "description": "High-performance laptop",
    "price": 1299.99,
    "created_at": "2025-11-19T10:30:00"
  },
  ...
]
```

**ุฏุฑุงูุช ฺฉ ูุญุตูู ุฎุงุต**:
```sh
curl https://app-<your-id>.azurewebsites.net/products/1
```

**โ ุจุฑุฑุณ ููููุช**: ุชูุงู ููุงุท ูพุงุงู ุฏุงุฏูโูุง JSON ุฑุง ุจุฏูู ุฎุทุง ุจุงุฒูโฺฏุฑุฏุงููุฏ.

---

**๐ ุชุจุฑฺฉ!** ุดูุง ุจุง ููููุช ฺฉ ุจุฑูุงูู ูุจ ููุฑุงู ุจุง ูพุงฺฏุงู ุฏุงุฏู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ AZD ุฏุฑ Azure ูุณุชูุฑ ฺฉุฑุฏุฏ.

## ุจุฑุฑุณ ุนูู ูพฺฉุฑุจูุฏ

### ูุชุบุฑูุง ูุญุท

ุงุณุฑุงุฑ ุจู ุตูุฑุช ุงูู ุงุฒ ุทุฑู ูพฺฉุฑุจูุฏ Azure App Service ูุฏุฑุช ูโุดููุฏโ**ูุฑฺฏุฒ ุฏุฑ ฺฉุฏ ููุจุน ุณุฎุชโฺฉุฏููุณ ููโุดููุฏ**.

**ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุชูุณุท AZD ูพฺฉุฑุจูุฏ ุดุฏู ุงุณุช**:
- `SQL_CONNECTION_STRING`: ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู ุจุง ุงุนุชุจุงุฑูุงููโูุง ุฑูุฒฺฏุฐุงุฑ ุดุฏู
- `APPLICATIONINSIGHTS_CONNECTION_STRING`: ููุทู ูพุงุงู ุชููโูุชุฑ ูุธุงุฑุช
- `SCM_DO_BUILD_DURING_DEPLOYMENT`: ูุนุงูโุณุงุฒ ูุตุจ ุฎูุฏฺฉุงุฑ ูุงุจุณุชฺฏโูุง

**ูุญู ุฐุฎุฑู ุงุณุฑุงุฑ**:
1. ุฏุฑ ุทูู `azd provision`ุ ุดูุง ุงุนุชุจุงุฑูุงููโูุง SQL ุฑุง ุงุฒ ุทุฑู ุฏุฑุฎูุงุณุชโูุง ุงูู ูุงุฑุฏ ูโฺฉูุฏ
2. AZD ุงูโูุง ุฑุง ุฏุฑ ูุงู ูุญู `.azure/<env-name>/.env` ุฐุฎุฑู ูโฺฉูุฏ (ุฏุฑ ฺฏุช ูุงุฏุฏู ฺฏุฑูุชู ุดุฏู)
3. AZD ุขูโูุง ุฑุง ุจู ูพฺฉุฑุจูุฏ Azure App Service ุชุฒุฑู ูโฺฉูุฏ (ุฑูุฒฺฏุฐุงุฑ ุดุฏู ุฏุฑ ุญุงูุช ุงุณุชุฑุงุญุช)
4. ุจุฑูุงูู ุขูโูุง ุฑุง ุฏุฑ ุฒูุงู ุงุฌุฑุง ุงุฒ ุทุฑู `os.getenv()` ูโุฎูุงูุฏ

### ุชูุณุนู ูุญู

ุจุฑุง ุขุฒูุงุด ูุญูุ ฺฉ ูุงู `.env` ุงุฒ ููููู ุงุฌุงุฏ ฺฉูุฏ:

```sh
cp .env.sample .env
# ูุงู .env ุฑุง ุจุง ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู ูุญู ุฎูุฏ ูุฑุงุด ฺฉูุฏ
```

**ฺฏุฑุฏุด ฺฉุงุฑ ุชูุณุนู ูุญู**:
```sh
# ูุตุจ ูุงุจุณุชฺฏโูุง
cd src/web
pip install -r requirements.txt

# ุชูุธู ูุชุบุฑูุง ูุญุท
export SQL_CONNECTION_STRING="your-local-connection-string"

# ุงุฌุฑุง ุจุฑูุงูู
python app.py
```

**ุขุฒูุงุด ูุญู**:
```sh
curl http://localhost:8000/health
# ููุฑุฏ ุงูุชุธุงุฑ: {"status": "healthy", "database": "connected"}
```

### ุฒุฑุณุงุฎุช ุจู ุนููุงู ฺฉุฏ

ุชูุงู ููุงุจุน Azure ุฏุฑ **ูุงูุจโูุง Bicep** (`infra/` ูพูุดู) ุชุนุฑู ุดุฏูโุงูุฏ:

- **ุทุฑุงุญ ูุงฺููุงุฑ**: ูุฑ ููุน ููุจุน ูุงู ุฎูุฏ ุฑุง ุจุฑุง ุงุณุชูุงุฏู ูุฌุฏุฏ ุฏุงุฑุฏ
- **ูพุงุฑุงูุชุฑ ุดุฏู**: ุณูุงุฑุดโุณุงุฒ SKUูุงุ ููุงุทูุ ูุฑุงุฑุฏุงุฏูุง ูุงูโฺฏุฐุงุฑ
- **ุจูุชุฑู ุดููโูุง**: ูพุฑู ุงุฒ ุงุณุชุงูุฏุงุฑุฏูุง ูุงูโฺฏุฐุงุฑ Azure ู ูพุดโูุฑุถโูุง ุงููุช
- **ฺฉูุชุฑู ูุณุฎู**: ุชุบุฑุงุช ุฒุฑุณุงุฎุช ุฏุฑ ฺฏุช ุฑุฏุงุจ ูโุดููุฏ

**ูุซุงู ุณูุงุฑุดโุณุงุฒ**:
ุจุฑุง ุชุบุฑ ูุงู ูพุงฺฏุงู ุฏุงุฏูุ ูุงู `infra/resources/sql-database.bicep` ุฑุง ูุฑุงุด ฺฉูุฏ:
```bicep
sku: {
  name: 'Standard'  // Changed from 'Basic'
  tier: 'Standard'
  capacity: 10
}
```

## ุจูุชุฑู ุดููโูุง ุงููุช

ุงู ูุซุงู ุงุฒ ุจูุชุฑู ุดููโูุง ุงููุช Azure ูพุฑู ูโฺฉูุฏ:

### ฑ. **ุจุฏูู ุงุณุฑุงุฑ ุฏุฑ ฺฉุฏ ููุจุน**
- โ ุงุนุชุจุงุฑูุงููโูุง ุฏุฑ ูพฺฉุฑุจูุฏ Azure App Service ุฐุฎุฑู ุดุฏูโุงูุฏ (ุฑูุฒฺฏุฐุงุฑ ุดุฏู)
- โ ูุงูโูุง `.env` ุงุฒ ฺฏุช ุงุฒ ุทุฑู `.gitignore` ุญุฐู ุดุฏูโุงูุฏ
- โ ุงุณุฑุงุฑ ุงุฒ ุทุฑู ูพุงุฑุงูุชุฑูุง ุงูู ุฏุฑ ุทูู ูุฑุงููโุณุงุฒ ููุชูู ูโุดููุฏ

### ฒ. **ุงุชุตุงูุงุช ุฑูุฒฺฏุฐุงุฑ ุดุฏู**
- โ ุญุฏุงูู TLS 1.2 ุจุฑุง SQL Server
- โ ููุท HTTPS ุจุฑุง ุจุฑูุงูู ูุจ ุงุนูุงู ุดุฏู ุงุณุช
- โ ุงุชุตุงูุงุช ูพุงฺฏุงู ุฏุงุฏู ุงุฒ ฺฉุงูุงูโูุง ุฑูุฒฺฏุฐุงุฑ ุดุฏู ุงุณุชูุงุฏู ูโฺฉููุฏ

### ณ. **ุงููุช ุดุจฺฉู**
- โ ูุงุฑูุงู SQL Server ุจุฑุง ุงุฌุงุฒู ุฏุงุฏู ููุท ุจู ุฎุฏูุงุช Azure ูพฺฉุฑุจูุฏ ุดุฏู ุงุณุช
- โ ุฏุณุชุฑุณ ุดุจฺฉู ุนููู ูุญุฏูุฏ ุดุฏู ุงุณุช (ูโุชูุงู ุจุง Private Endpoints ุจุดุชุฑ ููู ฺฉุฑุฏ)
- โ FTPS ุฏุฑ ุจุฑูุงูู ูุจ ุบุฑูุนุงู ุดุฏู ุงุณุช

### ด. **ุงุญุฑุงุฒ ููุช ู ูุฌูุฒ**
- โ๏ธ **ูุนู**: ุงุญุฑุงุฒ ููุช SQL (ูุงู ฺฉุงุฑุจุฑ/ุฑูุฒ ุนุจูุฑ)
- โ **ุชูุตู ุจุฑุง ุชููุฏ**: ุงุณุชูุงุฏู ุงุฒ Azure Managed Identity ุจุฑุง ุงุญุฑุงุฒ ููุช ุจุฏูู ุฑูุฒ ุนุจูุฑ

**ุจุฑุง ุงุฑุชูุง ุจู Managed Identity** (ุจุฑุง ุชููุฏ):
1. Managed Identity ุฑุง ุฏุฑ ุจุฑูุงูู ูุจ ูุนุงู ฺฉูุฏ
2. ุจู ููุช SQL ูุฌูุฒ ุจุฏูุฏ
3. ุฑุดุชู ุงุชุตุงู ุฑุง ุจุฑุง ุงุณุชูุงุฏู ุงุฒ Managed Identity ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ
4. ุงุญุฑุงุฒ ููุช ูุจุชู ุจุฑ ุฑูุฒ ุนุจูุฑ ุฑุง ุญุฐู ฺฉูุฏ

### ต. **ููุฒ ู ุงูุทุจุงู**
- โ Application Insights ุชูุงู ุฏุฑุฎูุงุณุชโูุง ู ุฎุทุงูุง ุฑุง ุซุจุช ูโฺฉูุฏ
- โ ููุฒ ูพุงฺฏุงู ุฏุงุฏู SQL ูุนุงู ุดุฏู ุงุณุช (ูโุชูุงู ุจุฑุง ุงูุทุจุงู ูพฺฉุฑุจูุฏ ฺฉุฑุฏ)
- โ ุชูุงู ููุงุจุน ุจุฑุง ุญุงฺฉูุช ุจุฑฺุณุจโฺฏุฐุงุฑ ุดุฏูโุงูุฏ

**ฺฺฉโูุณุช ุงููุช ูุจู ุงุฒ ุชููุฏ**:
- [ ] Azure Defender ุจุฑุง SQL ุฑุง ูุนุงู ฺฉูุฏ
- [ ] Private Endpoints ุฑุง ุจุฑุง ูพุงฺฏุงู ุฏุงุฏู SQL ูพฺฉุฑุจูุฏ ฺฉูุฏ
- [ ] ูุงุฑูุงู ุจุฑูุงูู ูุจ (WAF) ุฑุง ูุนุงู ฺฉูุฏ
- [ ] Azure Key Vault ุฑุง ุจุฑุง ฺุฑุฎุด ุงุณุฑุงุฑ ูพุงุฏูโุณุงุฒ ฺฉูุฏ
- [ ] ุงุญุฑุงุฒ ููุช Azure AD ุฑุง ูพฺฉุฑุจูุฏ ฺฉูุฏ
- [ ] ุซุจุช ุชุดุฎุต ุฑุง ุจุฑุง ุชูุงู ููุงุจุน ูุนุงู ฺฉูุฏ

## ุจูููโุณุงุฒ ูุฒูู

**ูุฒููโูุง ูุงูุงูู ุชุฎูู** (ุชุง ููุงูุจุฑ ฒฐฒต):

| ููุจุน | SKU/ูุงู | ูุฒูู ุชุฎูู |
|----------|----------|----------------|
| App Service Plan | B1 (ูพุงู) | ุญุฏูุฏ ฑณ ุฏูุงุฑ ุฏุฑ ูุงู |
| SQL Database | ูพุงู (ฒ ฺฏฺฏุงุจุงุช) | ุญุฏูุฏ ต ุฏูุงุฑ ุฏุฑ ูุงู |
| Application Insights | ูพุฑุฏุงุฎุช ุจู ุงุฒุง ุงุณุชูุงุฏู | ุญุฏูุฏ ฒ ุฏูุงุฑ ุฏุฑ ูุงู (ุชุฑุงูฺฉ ฺฉู) |
| **ูุฌููุน** | | **ุญุฏูุฏ ฒฐ ุฏูุงุฑ ุฏุฑ ูุงู** |

**๐ก ูฺฉุงุช ุตุฑููโุฌู ุฏุฑ ูุฒูู**:

1. **ุงุณุชูุงุฏู ุงุฒ ูุงู ุฑุงฺฏุงู ุจุฑุง ุงุฏฺฏุฑ**:
   - App Service: ูุงู F1 (ุฑุงฺฏุงูุ ุณุงุนุงุช ูุญุฏูุฏ)
   - SQL Database: ุงุณุชูุงุฏู ุงุฒ Azure SQL Database ุณุฑูุฑูุณ
   - Application Insights: ต ฺฏฺฏุงุจุงุช/ูุงู ูุตุฑู ุฑุงฺฏุงู

2. **ุชููู ููุงุจุน ุฒูุงู ฺฉู ุงุณุชูุงุฏู ููโุดููุฏ**:
   ```sh
   # ุชููู ุจุฑูุงูู ูุจ (ูพุงฺฏุงู ุฏุงุฏู ููฺูุงู ูุฒูู ูโฺฏุฑุฏ)
   az webapp stop --name <app-name> --resource-group <rg-name>
   
   # ุฑุงูโุงูุฏุงุฒ ูุฌุฏุฏ ุฏุฑ ุตูุฑุช ูุงุฒ
   az webapp start --name <app-name> --resource-group <rg-name>
   ```

3. **ุญุฐู ููู ฺุฒ ูพุณ ุงุฒ ุขุฒูุงุด**:
   ```sh
   azd down
   ```
   ุงู ุชูุงู ููุงุจุน ุฑุง ุญุฐู ูโฺฉูุฏ ู ูุฒููโูุง ุฑุง ูุชููู ูโฺฉูุฏ.

4. **SKUูุง ุชูุณุนู ุฏุฑ ููุงุจู ุชููุฏ**:
   - **ุชูุณุนู**: ูุงู ูพุงู (ุฏุฑ ุงู ูุซุงู ุงุณุชูุงุฏู ุดุฏู)
   - **ุชููุฏ**: ูุงู ุงุณุชุงูุฏุงุฑุฏ/ูพุฑููู ุจุง ุงูุฒููฺฏ

**ูุธุงุฑุช ุจุฑ ูุฒููโูุง**:
- ูุฒููโูุง ุฑุง ุฏุฑ [Azure Cost Management](https://portal.azure.com/#view/Microsoft_Azure_CostManagement) ูุดุงูุฏู ฺฉูุฏ
- ูุดุฏุงุฑูุง ูุฒูู ุฑุง ุชูุธู ฺฉูุฏ ุชุง ุงุฒ ุดฺฏูุชโูุง ุฌููฺฏุฑ ุดูุฏ
- ุชูุงู ููุงุจุน ุฑุง ุจุง `azd-env-name` ุจุฑุง ุฑุฏุงุจ ุจุฑฺุณุจโฺฏุฐุงุฑ ฺฉูุฏ

**ุฌุงฺฏุฒู ูุงู ุฑุงฺฏุงู**:
ุจุฑุง ุงูุฏุงู ุงุฏฺฏุฑุ ูโุชูุงูุฏ ูุงู `infra/resources/app-service-plan.bicep` ุฑุง ุชุบุฑ ุฏูุฏ:
```bicep
sku: {
  name: 'F1'  // Free tier
  tier: 'Free'
}
```
**ุชูุฌู**: ูุงู ุฑุงฺฏุงู ูุญุฏูุฏุชโูุง ุฏุงุฑุฏ (ถฐ ุฏููู/ุฑูุฒ CPUุ ุจุฏูู ููุดู ุฑูุดู).

## ูุธุงุฑุช ู ูุดุงูุฏูโูพุฐุฑ

### ุงุฏุบุงู Application Insights

ุงู ูุซุงู ุดุงูู **Application Insights** ุจุฑุง ูุธุงุฑุช ุฌุงูุน ุงุณุช:

**ฺู ฺุฒ ูุธุงุฑุช ูโุดูุฏ**:
- โ ุฏุฑุฎูุงุณุชโูุง HTTP (ุฒูุงู ุชุฃุฎุฑุ ฺฉุฏูุง ูุถุนุชุ ููุงุท ูพุงุงู)
- โ ุฎุทุงูุง ู ุงุณุชุซูุงูุง ุจุฑูุงูู
- โ ุซุจุช ุณูุงุฑุด ุงุฒ ุจุฑูุงูู Flask
- โ ุณูุงูุช ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู
- โ ูุนุงุฑูุง ุนููฺฉุฑุฏ (CPUุ ุญุงูุธู)

**ุฏุณุชุฑุณ ุจู Application Insights**:
1. [ูพูุฑุชุงู Azure](https://portal.azure.com) ุฑุง ุจุงุฒ ฺฉูุฏ
2. ุจู ฺฏุฑูู ููุงุจุน ุฎูุฏ (`rg-<env-name>`) ุจุฑูุฏ
3. ุฑู ููุจุน Application Insights (`appi-<unique-id>`) ฺฉูฺฉ ฺฉูุฏ

**ูพุฑุณโูุฌููุง ููุฏ** (Application Insights โ Logs):

**ูุดุงูุฏู ุชูุงู ุฏุฑุฎูุงุณุชโูุง**:
```kusto
requests
| where timestamp > ago(1h)
| order by timestamp desc
| project timestamp, name, url, resultCode, duration
```

**ุงูุชู ุฎุทุงูุง**:
```kusto
exceptions
| where timestamp > ago(24h)
| order by timestamp desc
| project timestamp, type, outerMessage, operation_Name
```

**ุจุฑุฑุณ ููุทู ูพุงุงู ุณูุงูุช**:
```kusto
requests
| where name contains "health"
| summarize count() by resultCode, bin(timestamp, 1h)
```

### ููุฒ ูพุงฺฏุงู ุฏุงุฏู SQL

**ููุฒ ูพุงฺฏุงู ุฏุงุฏู SQL ูุนุงู ุดุฏู ุงุณุช** ุจุฑุง ุฑุฏุงุจ:
- ุงูฺฏููุง ุฏุณุชุฑุณ ุจู ูพุงฺฏุงู ุฏุงุฏู
- ุชูุงุดโูุง ูุฑูุฏ ูุงูููู
- ุชุบุฑุงุช ุทุฑุญ
- ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง (ุจุฑุง ุงูุทุจุงู)

**ุฏุณุชุฑุณ ุจู ฺฏุฒุงุฑุดโูุง ููุฒ**:
1. ูพูุฑุชุงู Azure โ ูพุงฺฏุงู ุฏุงุฏู SQL โ ููุฒ
2. ฺฏุฒุงุฑุดโูุง ุฑุง ุฏุฑ ูุถุง ฺฉุงุฑ Log Analytics ูุดุงูุฏู ฺฉูุฏ

### ูุธุงุฑุช ุฏุฑ ุฒูุงู ูุงูุน

**ูุดุงูุฏู ูุนุงุฑูุง ุฒูุฏู**:
1. Application Insights โ ูุนุงุฑูุง ุฒูุฏู
2. ุฏุฑุฎูุงุณุชโูุงุ ุดฺฉุณุชโูุง ู ุนููฺฉุฑุฏ ุฑุง ุฏุฑ ุฒูุงู ูุงูุน ูุดุงูุฏู ฺฉูุฏ

**ุชูุธู ูุดุฏุงุฑูุง**:
ูุดุฏุงุฑูุง ุจุฑุง ุฑูุฏุงุฏูุง ุญุงุช ุงุฌุงุฏ ฺฉูุฏ:
- ุฎุทุงูุง HTTP 500 > ต ุฏุฑ ต ุฏููู
- ุดฺฉุณุชโูุง ุงุชุตุงู ูพุงฺฏุงู ุฏุงุฏู
- ุฒูุงู ูพุงุณุฎโุฏู ุจุงูุง (>2 ุซุงูู)

**ุงุฌุงุฏ ูุดุฏุงุฑ ููููู**:
```sh
az monitor metrics alert create \
  --name "High-Response-Time" \
  --resource-group <rg-name> \
  --scopes <app-insights-resource-id> \
  --condition "avg requests/duration > 2000" \
  --description "Alert when response time exceeds 2 seconds"
```

## ุฑูุน ุงุดฺฉุงู

### ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญูโูุง

#### 1. ุฎุทุง `azd provision` ุจุง ูพุงู "ูฺฉุงู ุฏุฑ ุฏุณุชุฑุณ ูุณุช"

**ุนูุงุฆู**:
```
Error: The subscription is not registered for the resource type 'components' in the location 'centralus'.
```

**ุฑุงูโุญู**:
ฺฉ ููุทูู ุฏฺฏุฑ Azure ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ ุง ุงุฑุงุฆูโุฏููุฏู ููุงุจุน ุฑุง ุซุจุช ฺฉูุฏ:
```sh
az provider register --namespace Microsoft.Insights
```

#### 2. ุงุชุตุงู SQL ุฏุฑ ููฺฏุงู ุงุณุชูุฑุงุฑ ุดฺฉุณุช ูโุฎูุฑุฏ

**ุนูุงุฆู**:
```
pyodbc.OperationalError: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider...')
```

**ุฑุงูโุญู**:
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุงุฑูุงู SQL Server ุงุฌุงุฒู ุฏุณุชุฑุณ ุจู ุฎุฏูุงุช Azure ุฑุง ุฏุงุฏู ุจุงุดุฏ (ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ ุชูุธู ุดุฏู ุงุณุช)
- ูุทูุฆู ุดูุฏ ฺฉู ุฑูุฒ ุนุจูุฑ ูุฏุฑ SQL ุจูโุฏุฑุณุช ุฏุฑ ููฺฏุงู `azd provision` ูุงุฑุฏ ุดุฏู ุงุณุช
- ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู SQL Server ุจูโุทูุฑ ฺฉุงูู ุงุณุชูุฑุงุฑ ุงูุชู ุงุณุช (ููฺฉู ุงุณุช 2-3 ุฏููู ุทูู ุจฺฉุดุฏ)

**ุชุฃุฏ ุงุชุตุงู**:
```sh
# ุงุฒ ูพูุฑุชุงู Azure ุจู ูพุงฺฏุงู ุฏุงุฏู SQL โ ูุฑุงุดฺฏุฑ ูพุฑุณ ู ุฌู ุจุฑูุฏ
# ุณุน ฺฉูุฏ ุจุง ุงุทูุงุนุงุช ูุฑูุฏ ุฎูุฏ ูุชุตู ุดูุฏ
```

#### 3. ูุจ ุงูพูฺฉุดู ูพุงู "ุฎุทุง ุจุฑูุงูู" ุฑุง ูุดุงู ูโุฏูุฏ

**ุนูุงุฆู**:
ูุฑูุฑฺฏุฑ ุตูุญู ุฎุทุง ุนููู ุฑุง ูุดุงู ูโุฏูุฏ.

**ุฑุงูโุญู**:
ูุงฺฏโูุง ุจุฑูุงูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ:
```sh
# ูุดุงูุฏู ฺฏุฒุงุฑุดโูุง ุงุฎุฑ
az webapp log tail --name <app-name> --resource-group <rg-name>
```

**ุฏูุงู ุฑุงุฌ**:
- ูุชุบุฑูุง ูุญุท ฺฏูโุดุฏู (App Service โ Configuration ุฑุง ุจุฑุฑุณ ฺฉูุฏ)
- ูุตุจ ุจุณุชูโูุง ูพุงุชูู ุดฺฉุณุช ุฎูุฑุฏู ุงุณุช (ูุงฺฏโูุง ุงุณุชูุฑุงุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ)
- ุฎุทุง ุงูููโุณุงุฒ ูพุงฺฏุงู ุฏุงุฏู (ุงุชุตุงู SQL ุฑุง ุจุฑุฑุณ ฺฉูุฏ)

#### 4. ุฎุทุง "Build Error" ุฏุฑ ููฺฏุงู ุงุฌุฑุง `azd deploy`

**ุนูุงุฆู**:
```
Error: Failed to build project
```

**ุฑุงูโุญู**:
- ูุทูุฆู ุดูุฏ ฺฉู ูุงู `requirements.txt` ุฎุทุง ูุญู ูุฏุงุฑุฏ
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู Python 3.11 ุฏุฑ ูุงู `infra/resources/web-app.bicep` ูุดุฎุต ุดุฏู ุจุงุดุฏ
- ุงุทููุงู ุญุงุตู ฺฉูุฏ ฺฉู Dockerfile ุชุตูุฑ ูพุงู ุตุญุญ ุฏุงุฑุฏ

**ุฑูุน ุงุดฺฉุงู ูุญู**:
```sh
cd src/web
docker build -t test-app .
docker run -p 8000:8000 test-app
```

#### 5. ุฎุทุง "Unauthorized" ููฺฏุงู ุงุฌุฑุง ุฏุณุชูุฑุงุช AZD

**ุนูุงุฆู**:
```
ERROR: (Unauthorized) The client '<id>' with object id '<id>' does not have authorization
```

**ุฑุงูโุญู**:
ุฏูุจุงุฑู ุจุง Azure ุงุญุฑุงุฒ ููุช ฺฉูุฏ:
```sh
azd auth login
az login
```

ูุทูุฆู ุดูุฏ ฺฉู ูุฌูุฒูุง ุตุญุญ (ููุด Contributor) ุฏุฑ ุงุดุชุฑุงฺฉ ุฏุงุฑุฏ.

#### 6. ูุฒููโูุง ุจุงูุง ูพุงฺฏุงู ุฏุงุฏู

**ุนูุงุฆู**:
ุตูุฑุชุญุณุงุจ ุบุฑููุชุธุฑู Azure.

**ุฑุงูโุญู**:
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูพุณ ุงุฒ ุขุฒูุงุด `azd down` ุฑุง ุงุฌุฑุง ูฺฉุฑุฏู ุจุงุดุฏ
- ูุทูุฆู ุดูุฏ ฺฉู SQL Database ุงุฒ ุณุทุญ Basic ุงุณุชูุงุฏู ูโฺฉูุฏ (ูู Premium)
- ูุฒููโูุง ุฑุง ุฏุฑ Azure Cost Management ุจุฑุฑุณ ฺฉูุฏ
- ูุดุฏุงุฑูุง ูุฒูู ุชูุธู ฺฉูุฏ

### ุฏุฑุงูุช ฺฉูฺฉ

**ูุดุงูุฏู ุชูุงู ูุชุบุฑูุง ูุญุท AZD**:
```sh
azd env get-values
```

**ุจุฑุฑุณ ูุถุนุช ุงุณุชูุฑุงุฑ**:
```sh
az webapp show --name <app-name> --resource-group <rg-name> --query state
```

**ุฏุณุชุฑุณ ุจู ูุงฺฏโูุง ุจุฑูุงูู**:
```sh
az webapp log download --name <app-name> --resource-group <rg-name> --log-file app-logs.zip
```

**ูุงุฒ ุจู ฺฉูฺฉ ุจุดุชุฑุ**
- [ุฑุงูููุง ุฑูุน ุงุดฺฉุงู AZD](../../docs/troubleshooting/common-issues.md)
- [ุฑูุน ุงุดฺฉุงู Azure App Service](https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs)
- [ุฑูุน ุงุดฺฉุงู Azure SQL](https://learn.microsoft.com/azure/azure-sql/database/troubleshoot-common-errors-issues)

## ุชูุฑูโูุง ุนูู

### ุชูุฑู 1: ุชุฃุฏ ุงุณุชูุฑุงุฑ ุดูุง (ูุจุชุฏ)

**ูุฏู**: ุชุฃุฏ ฺฉูุฏ ฺฉู ุชูุงู ููุงุจุน ุงุณุชูุฑุงุฑ ุงูุชูโุงูุฏ ู ุจุฑูุงูู ฺฉุงุฑ ูโฺฉูุฏ.

**ูุฑุงุญู**:
1. ูุณุช ุชูุงู ููุงุจุน ุฏุฑ ฺฏุฑูู ููุงุจุน ุฎูุฏ:
   ```sh
   az resource list --resource-group rg-<env-name> --output table
   ```
   **ุงูุชุธุงุฑ**: 6-7 ููุจุน (ูุจ ุงูพูฺฉุดูุ SQL Serverุ SQL Databaseุ App Service Planุ Application Insightsุ Log Analytics)

2. ุชุณุช ุชูุงู ููุงุท ูพุงุงู API:
   ```sh
   curl https://app-<your-id>.azurewebsites.net/
   curl https://app-<your-id>.azurewebsites.net/health
   curl https://app-<your-id>.azurewebsites.net/products
   curl https://app-<your-id>.azurewebsites.net/products/1
   ```
   **ุงูุชุธุงุฑ**: ููู JSON ูุนุชุจุฑ ุจุฏูู ุฎุทุง ุจุงุฒฺฏุฑุฏุงููุฏ

3. ุจุฑุฑุณ Application Insights:
   - ุจู Application Insights ุฏุฑ Azure Portal ุจุฑูุฏ
   - ุจู "Live Metrics" ุจุฑูุฏ
   - ูุฑูุฑฺฏุฑ ุฎูุฏ ุฑุง ุฏุฑ ูุจ ุงูพูฺฉุดู ุชุงุฒู ฺฉูุฏ
   **ุงูุชุธุงุฑ**: ุฏุฑุฎูุงุณุชโูุง ุฑุง ุจูโุตูุฑุช ุฒูุฏู ูุดุงูุฏู ฺฉูุฏ

**ูุนุงุฑ ููููุช**: ุชูุงู 6-7 ููุจุน ูุฌูุฏ ุฏุงุฑูุฏุ ุชูุงู ููุงุท ูพุงุงู ุฏุงุฏู ุจุงุฒูโฺฏุฑุฏุงููุฏุ Live Metrics ูุนุงูุช ุฑุง ูุดุงู ูโุฏูุฏ.

---

### ุชูุฑู 2: ุงูุฒูุฏู ฺฉ ููุทู ูพุงุงู ุฌุฏุฏ API (ูุชูุณุท)

**ูุฏู**: ฺฏุณุชุฑุด ุจุฑูุงูู Flask ุจุง ฺฉ ููุทู ูพุงุงู ุฌุฏุฏ.

**ฺฉุฏ ุดุฑูุน**: ููุงุท ูพุงุงู ูุนู ุฏุฑ `src/web/app.py`

**ูุฑุงุญู**:
1. ูุงู `src/web/app.py` ุฑุง ูุฑุงุด ฺฉูุฏ ู ฺฉ ููุทู ูพุงุงู ุฌุฏุฏ ุจุนุฏ ุงุฒ ุชุงุจุน `get_product()` ุงุถุงูู ฺฉูุฏ:
   ```python
   @app.route('/products/search/<keyword>')
   def search_products(keyword):
       """Search products by name or description."""
       try:
           conn = get_db_connection()
           cursor = conn.cursor()
           cursor.execute(
               "SELECT id, name, description, price, created_at FROM products WHERE name LIKE ? OR description LIKE ?",
               (f'%{keyword}%', f'%{keyword}%')
           )
           
           products = []
           for row in cursor.fetchall():
               products.append({
                   'id': row[0],
                   'name': row[1],
                   'description': row[2],
                   'price': float(row[3]) if row[3] else None,
                   'created_at': row[4].isoformat() if row[4] else None
               })
           
           cursor.close()
           conn.close()
           
           logger.info(f"Search for '{keyword}' returned {len(products)} results")
           return jsonify(products), 200
           
       except Exception as e:
           logger.error(f"Error searching products: {str(e)}")
           return jsonify({'error': str(e)}), 500
   ```

2. ุจุฑูุงูู ุจูโุฑูุฒุฑุณุงู ุดุฏู ุฑุง ุงุณุชูุฑุงุฑ ุฏูุฏ:
   ```sh
   azd deploy
   ```

3. ููุทู ูพุงุงู ุฌุฏุฏ ุฑุง ุชุณุช ฺฉูุฏ:
   ```sh
   curl https://app-<your-id>.azurewebsites.net/products/search/laptop
   ```
   **ุงูุชุธุงุฑ**: ูุญุตููุงุช ูุทุงุจู "laptop" ุจุงุฒฺฏุฑุฏุงูุฏู ุดููุฏ

**ูุนุงุฑ ููููุช**: ููุทู ูพุงุงู ุฌุฏุฏ ฺฉุงุฑ ูโฺฉูุฏุ ูุชุงุฌ ููุชุฑ ุดุฏู ุจุงุฒูโฺฏุฑุฏุงูุฏุ ุฏุฑ ูุงฺฏโูุง Application Insights ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

### ุชูุฑู 3: ุงูุฒูุฏู ูุธุงุฑุช ู ูุดุฏุงุฑูุง (ูพุดุฑูุชู)

**ูุฏู**: ุชูุธู ูุธุงุฑุช ูพุดฺฏุฑุงูู ุจุง ูุดุฏุงุฑูุง.

**ูุฑุงุญู**:
1. ฺฉ ูุดุฏุงุฑ ุจุฑุง ุฎุทุงูุง HTTP 500 ุงุฌุงุฏ ฺฉูุฏ:
   ```sh
   # ุฏุฑุงูุช ุดูุงุณู ููุจุน Application Insights
   AI_ID=$(az monitor app-insights component show \
     --app appi-<your-id> \
     --resource-group rg-<env-name> \
     --query id -o tsv)
   
   # ุงุฌุงุฏ ูุดุฏุงุฑ
   az monitor metrics alert create \
     --name "High-Error-Rate" \
     --resource-group rg-<env-name> \
     --scopes $AI_ID \
     --condition "count requests/failed > 5" \
     --window-size 5m \
     --evaluation-frequency 1m \
     --description "Alert when >5 failed requests in 5 minutes"
   ```

2. ูุดุฏุงุฑ ุฑุง ุจุง ุงุฌุงุฏ ุฎุทุงูุง ูุนุงู ฺฉูุฏ:
   ```sh
   # ุฏุฑุฎูุงุณุช ฺฉ ูุญุตูู ุบุฑ ููุฌูุฏ
   for i in {1..10}; do curl https://app-<your-id>.azurewebsites.net/products/999; done
   ```

3. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุขุง ูุดุฏุงุฑ ูุนุงู ุดุฏู ุงุณุช:
   - Azure Portal โ Alerts โ Alert Rules
   - ุงูู ุฎูุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ (ุงฺฏุฑ ุชูุธู ุดุฏู ุจุงุดุฏ)

**ูุนุงุฑ ููููุช**: ูุงููู ูุดุฏุงุฑ ุงุฌุงุฏ ุดุฏูุ ุฑู ุฎุทุงูุง ูุนุงู ูโุดูุฏุ ุงุนูุงูโูุง ุฏุฑุงูุช ูโุดููุฏ.

---

### ุชูุฑู 4: ุชุบุฑุงุช ุฏุฑ ุทุฑุญ ูพุงฺฏุงู ุฏุงุฏู (ูพุดุฑูุชู)

**ูุฏู**: ุงูุฒูุฏู ฺฉ ุฌุฏูู ุฌุฏุฏ ู ุชุบุฑ ุจุฑูุงูู ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุขู.

**ูุฑุงุญู**:
1. ุจู SQL Database ุงุฒ ุทุฑู Azure Portal Query Editor ูุชุตู ุดูุฏ

2. ฺฉ ุฌุฏูู ุฌุฏุฏ `categories` ุงุฌุงุฏ ฺฉูุฏ:
   ```sql
   CREATE TABLE categories (
       id INT PRIMARY KEY IDENTITY(1,1),
       name NVARCHAR(50) NOT NULL,
       description NVARCHAR(200)
   );
   
   INSERT INTO categories (name, description) VALUES
   ('Electronics', 'Electronic devices and accessories'),
   ('Office Supplies', 'Office equipment and supplies');
   
   -- Add category to products table
   ALTER TABLE products ADD category_id INT;
   UPDATE products SET category_id = 1; -- Set all to Electronics
   ```

3. ูุงู `src/web/app.py` ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ ุชุง ุงุทูุงุนุงุช ุฏุณุชูโุจูุฏ ุฏุฑ ูพุงุณุฎโูุง ฺฏูุฌุงูุฏู ุดูุฏ

4. ุงุณุชูุฑุงุฑ ู ุชุณุช ฺฉูุฏ

**ูุนุงุฑ ููููุช**: ุฌุฏูู ุฌุฏุฏ ูุฌูุฏ ุฏุงุฑุฏุ ูุญุตููุงุช ุงุทูุงุนุงุช ุฏุณุชูโุจูุฏ ุฑุง ูุดุงู ูโุฏููุฏุ ุจุฑูุงูู ููฺูุงู ฺฉุงุฑ ูโฺฉูุฏ.

---

### ุชูุฑู 5: ูพุงุฏูโุณุงุฒ ฺฉุดูฺฏ (ุญุฑููโุง)

**ูุฏู**: ุงูุฒูุฏู Azure Redis Cache ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ.

**ูุฑุงุญู**:
1. Redis Cache ุฑุง ุจู `infra/main.bicep` ุงุถุงูู ฺฉูุฏ
2. ูุงู `src/web/app.py` ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ ุชุง ูพุฑุณโูุฌููุง ูุญุตูู ุฑุง ฺฉุด ฺฉูุฏ
3. ุจูุจูุฏ ุนููฺฉุฑุฏ ุฑุง ุจุง Application Insights ุงูุฏุงุฒูโฺฏุฑ ฺฉูุฏ
4. ุฒูุงูโูุง ูพุงุณุฎโุฏู ูุจู/ุจุนุฏ ุงุฒ ฺฉุดูฺฏ ุฑุง ููุงุณู ฺฉูุฏ

**ูุนุงุฑ ููููุช**: Redis ุงุณุชูุฑุงุฑ ุงูุชูุ ฺฉุดูฺฏ ฺฉุงุฑ ูโฺฉูุฏุ ุฒูุงูโูุง ูพุงุณุฎโุฏู ุจุด ุงุฒ 50ูช ุจูุจูุฏ ูโุงุจุฏ.

**ูฺฉุชู**: ุจุง [ูุณุชูุฏุงุช Azure Cache for Redis](https://learn.microsoft.com/azure/azure-cache-for-redis/) ุดุฑูุน ฺฉูุฏ.

---

## ูพุงฺฉโุณุงุฒ

ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุฒููโูุง ุฌุงุฑุ ุชูุงู ููุงุจุน ุฑุง ูพุณ ุงุฒ ุงุชูุงู ุญุฐู ฺฉูุฏ:

```sh
azd down
```

**ูพุงู ุชุฃุฏ**:
```
? Total resources to delete: 7, are you sure you want to continue? (y/N)
```

ุนุจุงุฑุช `y` ุฑุง ุชุงูพ ฺฉูุฏ ุชุง ุชุฃุฏ ฺฉูุฏ.

**โ ุจุฑุฑุณ ููููุช**: 
- ุชูุงู ููุงุจุน ุงุฒ Azure Portal ุญุฐู ุดุฏูโุงูุฏ
- ูฺ ูุฒูู ุฌุงุฑ ูุฌูุฏ ูุฏุงุฑุฏ
- ูพูุดู ูุญู `.azure/<env-name>` ูุงุจู ุญุฐู ุงุณุช

**ุฌุงฺฏุฒู** (ุฒุฑุณุงุฎุช ุฑุง ูฺฏู ุฏุงุฑุฏุ ุฏุงุฏูโูุง ุฑุง ุญุฐู ฺฉูุฏ):
```sh
# ููุท ฺฏุฑูู ููุงุจุน ุฑุง ุญุฐู ฺฉูุฏ (ูพฺฉุฑุจูุฏ AZD ุฑุง ูฺฏู ุฏุงุฑุฏ)
az group delete --name rg-<env-name> --yes
```
## ุงุทูุงุนุงุช ุจุดุชุฑ

### ูุณุชูุฏุงุช ูุฑุชุจุท
- [ูุณุชูุฏุงุช Azure Developer CLI](https://learn.microsoft.com/azure/developer/azure-developer-cli/)
- [ูุณุชูุฏุงุช Azure SQL Database](https://learn.microsoft.com/azure/azure-sql/database/)
- [ูุณุชูุฏุงุช Azure App Service](https://learn.microsoft.com/azure/app-service/)
- [ูุณุชูุฏุงุช Application Insights](https://learn.microsoft.com/azure/azure-monitor/app/app-insights-overview)
- [ูุฑุฌุน ุฒุจุงู Bicep](https://learn.microsoft.com/azure/azure-resource-manager/bicep/)

### ูุฑุงุญู ุจุนุฏ ุฏุฑ ุงู ุฏูุฑู
- **[ูุซุงู ุจุฑูุงููโูุง ฺฉุงูุชูุฑ](../../../../examples/container-app)**: ุงุณุชูุฑุงุฑ ูฺฉุฑูุณุฑูุณโูุง ุจุง Azure Container Apps
- **[ุฑุงูููุง ฺฉูพุงุฑฺูโุณุงุฒ AI](../../../../docs/ai-foundry)**: ุงูุฒูุฏู ูุงุจูุชโูุง AI ุจู ุจุฑูุงูู ุดูุง
- **[ุจูุชุฑู ุดููโูุง ุงุณุชูุฑุงุฑ](../../docs/deployment/deployment-guide.md)**: ุงูฺฏููุง ุงุณุชูุฑุงุฑ ุชููุฏ

### ููุถูุนุงุช ูพุดุฑูุชู
- **Managed Identity**: ุญุฐู ุฑูุฒูุง ุนุจูุฑ ู ุงุณุชูุงุฏู ุงุฒ ุงุญุฑุงุฒ ููุช Azure AD
- **Private Endpoints**: ุงููโุณุงุฒ ุงุชุตุงูุงุช ูพุงฺฏุงู ุฏุงุฏู ุฏุฑ ฺฉ ุดุจฺฉู ูุฌุงุฒ
- **ฺฉูพุงุฑฺูโุณุงุฒ CI/CD**: ุฎูุฏฺฉุงุฑุณุงุฒ ุงุณุชูุฑุงุฑูุง ุจุง GitHub Actions ุง Azure DevOps
- **ฺูุฏ ูุญุท**: ุชูุธู ูุญุทโูุง ุชูุณุนูุ ุขุฒูุงุด ู ุชููุฏ
- **ููุงุฌุฑุช ูพุงฺฏุงู ุฏุงุฏู**: ุงุณุชูุงุฏู ุงุฒ Alembic ุง Entity Framework ุจุฑุง ูุณุฎูโุจูุฏ ุทุฑุญ

### ููุงุณู ุจุง ุฑูุดโูุง ุฏฺฏุฑ

**AZD ุฏุฑ ููุงุจู ARM Templates**:
- โ AZD: ุงูุชุฒุงุน ุณุทุญ ุจุงูุงุ ุฏุณุชูุฑุงุช ุณุงุฏูโุชุฑ
- โ๏ธ ARM: ููุตูโุชุฑุ ฺฉูุชุฑู ุฏููโุชุฑ

**AZD ุฏุฑ ููุงุจู Terraform**:
- โ AZD: ุจูู Azureุ ฺฉูพุงุฑฺู ุจุง ุฎุฏูุงุช Azure
- โ๏ธ Terraform: ูพุดุชุจุงู ฺูุฏ ุงุจุฑุ ุงฺฉูุณุณุชู ุจุฒุฑฺฏโุชุฑ

**AZD ุฏุฑ ููุงุจู Azure Portal**:
- โ AZD: ูุงุจู ุชฺฉุฑุงุฑุ ฺฉูุชุฑู ูุณุฎูุ ูุงุจู ุฎูุฏฺฉุงุฑุณุงุฒ
- โ๏ธ Portal: ฺฉูฺฉโูุง ุฏุณุชุ ุฏุดูุงุฑ ุจุฑุง ุจุงุฒุชููุฏ

**AZD ุฑุง ุจูโุนููุงู**: Docker Compose ุจุฑุง Azure ุชุตูุฑ ฺฉูุฏโูพฺฉุฑุจูุฏ ุณุงุฏู ุจุฑุง ุงุณุชูุฑุงุฑูุง ูพฺุฏู.

---

## ุณูุงูุงุช ูุชุฏุงูู

**ุณ: ุขุง ูโุชูุงูู ุงุฒ ุฒุจุงู ุจุฑูุงููโููุณ ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉููุ**  
ุฌ: ุจูู! `src/web/` ุฑุง ุจุง Node.jsุ C#ุ Go ุง ูุฑ ุฒุจุงู ุฏฺฏุฑ ุฌุงฺฏุฒู ฺฉูุฏ. ูุงูโูุง `azure.yaml` ู Bicep ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.

**ุณ: ฺฺฏููู ูโุชูุงูู ูพุงฺฏุงู ุฏุงุฏูโูุง ุจุดุชุฑ ุงุถุงูู ฺฉููุ**  
ุฌ: ฺฉ ูุงฺูู SQL Database ุฏฺฏุฑ ุจู `infra/main.bicep` ุงุถุงูู ฺฉูุฏ ุง ุงุฒ ุฎุฏูุงุช ูพุงฺฏุงู ุฏุงุฏู Azure ูุงููุฏ PostgreSQL/MySQL ุงุณุชูุงุฏู ฺฉูุฏ.

**ุณ: ุขุง ูโุชูุงูู ุงุฒ ุงู ุจุฑุง ุชููุฏ ุงุณุชูุงุฏู ฺฉููุ**  
ุฌ: ุงู ฺฉ ููุทู ุดุฑูุน ุงุณุช. ุจุฑุง ุชููุฏุ ููุงุฑุฏ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ: ููุช ูุฏุฑุชโุดุฏูุ ููุงุท ูพุงุงู ุฎุตูุตุ ุงูุฒููฺฏุ ุงุณุชุฑุงุชฺ ูพุดุชุจุงูโฺฏุฑุ WAFุ ู ูุธุงุฑุช ูพุดุฑูุชู.

**ุณ: ุงฺฏุฑ ุจุฎูุงูู ุจูโุฌุง ุงุณุชูุฑุงุฑ ฺฉุฏ ุงุฒ ฺฉุงูุชูุฑูุง ุงุณุชูุงุฏู ฺฉูู ฺูุ**  
ุฌ: ุจู [ูุซุงู ุจุฑูุงููโูุง ฺฉุงูุชูุฑ](../../../../examples/container-app) ฺฉู ุงุฒ ฺฉุงูุชูุฑูุง Docker ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุฑุงุฌุนู ฺฉูุฏ.

**ุณ: ฺฺฏููู ูโุชูุงูู ุงุฒ ูุงุดู ูุญู ุฎูุฏ ุจู ูพุงฺฏุงู ุฏุงุฏู ูุชุตู ุดููุ**  
ุฌ: IP ุฎูุฏ ุฑุง ุจู ูุงุฑูุงู SQL Server ุงุถุงูู ฺฉูุฏ:
```sh
az sql server firewall-rule create \
  --resource-group rg-<env-name> \
  --server sql-<unique-id> \
  --name AllowMyIP \
  --start-ip-address <your-ip> \
  --end-ip-address <your-ip>
```

**ุณ: ุขุง ูโุชูุงูู ุงุฒ ูพุงฺฏุงู ุฏุงุฏู ููุฌูุฏ ุจูโุฌุง ุงุฌุงุฏ ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุฌุฏุฏ ุงุณุชูุงุฏู ฺฉููุ**  
ุฌ: ุจููุ ูุงู `infra/main.bicep` ุฑุง ุชุบุฑ ุฏูุฏ ุชุง ุจู SQL Server ููุฌูุฏ ุงุดุงุฑู ฺฉูุฏ ู ูพุงุฑุงูุชุฑูุง ุฑุดุชู ุงุชุตุงู ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ.

---

> **ุชูุฌู:** ุงู ูุซุงู ุจูุชุฑู ุดููโูุง ุจุฑุง ุงุณุชูุฑุงุฑ ฺฉ ูุจ ุงูพูฺฉุดู ุจุง ูพุงฺฏุงู ุฏุงุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ AZD ุฑุง ูุดุงู ูโุฏูุฏ. ุดุงูู ฺฉุฏ ุนููุ ูุณุชูุฏุงุช ุฌุงูุนุ ู ุชูุฑูโูุง ุนูู ุจุฑุง ุชููุช ุงุฏฺฏุฑ ุงุณุช. ุจุฑุง ุงุณุชูุฑุงุฑูุง ุชููุฏุ ุงูุฒุงูุงุช ุงููุชุ ููุงุณโูพุฐุฑุ ุงูุทุจุงูุ ู ูุฒููโูุง ุฎุงุต ุณุงุฒูุงู ุฎูุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ.

**๐ ูุงูุจุฑ ุฏูุฑู:**
- โ ูุจู: [ูุซุงู ุจุฑูุงููโูุง ฺฉุงูุชูุฑ](../../../../examples/container-app)
- โ ุจุนุฏ: [ุฑุงูููุง ฺฉูพุงุฑฺูโุณุงุฒ AI](../../../../docs/ai-foundry)
- ๐ [ุตูุญู ุงุตู ุฏูุฑู](../../README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**ุณูุจ ูุณุฆููุช**:  
ุงู ุณูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ุชุฑุฌูู ููุด ูุตููุน [Co-op Translator](https://github.com/Azure/co-op-translator) ุชุฑุฌูู ุดุฏู ุงุณุช. ุฏุฑ ุญุงู ฺฉู ูุง ุชูุงุด ูโฺฉูู ุฏูุช ุฑุง ุญูุธ ฺฉููุ ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชุฑุฌููโูุง ุฎูุฏฺฉุงุฑ ููฺฉู ุงุณุช ุดุงูู ุฎุทุงูุง ุง ูุงุฏุฑุณุชโูุง ุจุงุดูุฏ. ุณูุฏ ุงุตู ุจู ุฒุจุงู ุงุตู ุขู ุจุงุฏ ุจู ุนููุงู ููุจุน ูุนุชุจุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุญุงุชุ ุชุฑุฌูู ุญุฑููโุง ุงูุณุงู ุชูุตู ูโุดูุฏ. ูุง ูุณุฆููุช ุฏุฑ ูุจุงู ุณูุก ุชูุงููโูุง ุง ุชูุณุฑูุง ูุงุฏุฑุณุช ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุฑุฌูู ูุฏุงุฑู.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->